<!doctype html>
<html lang="zh" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.75">
<link rel="alternate" type="application/rss+xml" href="/zh/blog/rss.xml" title="KubeVela Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh/blog/atom.xml" title="KubeVela Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-5GLR1Y52M7"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-5GLR1Y52M7",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="KubeVela" href="/zh/opensearch.xml"><title data-react-helmet="true">Blog | KubeVela</title><meta data-react-helmet="true" property="og:title" content="Blog | KubeVela"><meta data-react-helmet="true" name="description" content="Blog"><meta data-react-helmet="true" property="og:description" content="Blog"><meta data-react-helmet="true" property="og:url" content="https://kubevela.io/zh/blog"><meta data-react-helmet="true" name="docsearch:language" content="zh"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><meta data-react-helmet="true" property="og:image" content="https://tva1.sinaimg.cn/large/ad5fbf65gy1glgj5q8inej208g049aa6.jpg"><meta data-react-helmet="true" name="twitter:image" content="https://tva1.sinaimg.cn/large/ad5fbf65gy1glgj5q8inej208g049aa6.jpg"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><link data-react-helmet="true" rel="shortcut icon" href="/zh/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://kubevela.io/zh/blog"><link data-react-helmet="true" rel="alternate" href="https://kubevela.io/blog" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://kubevela.io/zh/blog" hreflang="zh"><link data-react-helmet="true" rel="alternate" href="https://kubevela.io/blog" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/zh/assets/css/styles.1f84ae86.css">
<link rel="preload" href="/zh/assets/js/runtime~main.312f92b6.js" as="script">
<link rel="preload" href="/zh/assets/js/main.aa5d7873.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh/"><img src="/zh/img/logo.svg" alt="KubeVela" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/zh/img/logoDark.svg" alt="KubeVela" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">KubeVela</strong></a><a class="navbar__item navbar__link" href="/zh/docs/">æ–‡æ¡£</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zh/blog">åšå®¢</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link" href="/zh/docs/">v1.3</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh/docs/next/">Next</a></li><li><a class="dropdown__link" href="/zh/docs/">v1.3</a></li><li><a class="dropdown__link" href="/zh/docs/v1.2/">v1.2</a></li><li><a class="dropdown__link" href="/zh/docs/v1.1/">v1.1</a></li><li><a class="dropdown__link" href="/zh/docs/v1.0/">v1.0</a></li></ul></div><a href="https://kubevela.net" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">å›½å†…åŠ é€Ÿ</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__item navbar__link"><span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" style="vertical-align:text-bottom;margin-right:5px"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>ç®€ä½“ä¸­æ–‡</span></span></a><ul class="dropdown__menu"><li><a href="/blog" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">English</a></li><li><a href="/zh/blog" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">ç®€ä½“ä¸­æ–‡</a></li></ul></div><a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/zh/"><img src="/zh/img/logo.svg" alt="KubeVela" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/zh/img/logoDark.svg" alt="KubeVela" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">KubeVela</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="menu__link menu__link--sublist">Versions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/zh/docs/next/">Next</a></li><li class="menu__list-item"><a class="menu__link" href="/zh/docs/">v1.3</a></li><li class="menu__list-item"><a class="menu__link" href="/zh/docs/v1.2/">v1.2</a></li><li class="menu__list-item"><a class="menu__link" href="/zh/docs/v1.1/">v1.1</a></li><li class="menu__list-item"><a class="menu__link" href="/zh/docs/v1.0/">v1.0</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/zh/docs/">æ–‡æ¡£</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/zh/blog">åšå®¢</a></li><li class="menu__list-item"><a href="https://kubevela.net" target="_blank" rel="noopener noreferrer" class="menu__link">å›½å†…åŠ é€Ÿ</a></li><li class="menu__list-item menu__list-item--collapsed"><a href="#" role="button" class="menu__link menu__link--sublist"><span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" style="vertical-align:text-bottom;margin-right:5px"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>Languages</span></span></a><ul class="menu__list"><li class="menu__list-item"><a href="/blog" target="_self" rel="noopener noreferrer" class="menu__link" style="text-transform:capitalize">English</a></li><li class="menu__list-item"><a href="/zh/blog" target="_self" rel="noopener noreferrer" class="menu__link dropdown__link--active" style="text-transform:capitalize">ç®€ä½“ä¸­æ–‡</a></li></ul></li><li class="menu__list-item"><a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link"></a></li></ul></div></div></div></nav><div class="main-wrapper blog-wrapper blog-list-page"><div class="container margin-vert--lg"><div class="row"><div class="col col--3"><div class="sidebar_2ahu thin-scrollbar"><h3 class="sidebarItemTitle_2hhb">Recent posts</h3><ul class="sidebarItemList_2xAf"><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/zh/blog/2022/04/06/multi-cluster-management">KubeVela v1.3 å¤šé›†ç¾¤åˆä½“éªŒï¼Œè½»æ¾ç®¡ç†åº”ç”¨åˆ†å‘å’Œå·®å¼‚åŒ–é…ç½®</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/zh/blog/2022/04/01/offline-deployment-practice copy">China Merchants Bank&#x27;s Practice on Offline Installation with KubeVela</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/zh/blog/2022/03/02/kubevela-with-machine-learning">åŸºäº KubeVela çš„æœºå™¨å­¦ä¹ å®è·µ</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/zh/blog/2022/03/01/kubevela-generate-top-50-popular-resources-of-aws-using-100-lines-of-code">å¦‚ä½•ç”¨ 100 è¡Œä»£ç å¿«é€Ÿå¼•å…¥ AWS æœ€å—æ¬¢è¿çš„ 50 ç§äº‘èµ„æº</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/zh/blog/2022/01/27/blog-1.2">KubeVela v1.2 å‘å¸ƒï¼šèšç„¦å¼€å‘è€…ä½“éªŒï¼Œè½»æ¾å‘å¸ƒä½ çš„å¤šé›†ç¾¤åº”ç”¨</a></li></ul></div></div><main class="col col--7"><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/zh/blog/2022/04/06/multi-cluster-management">KubeVela v1.3 å¤šé›†ç¾¤åˆä½“éªŒï¼Œè½»æ¾ç®¡ç†åº”ç”¨åˆ†å‘å’Œå·®å¼‚åŒ–é…ç½®</a></h2><div class="margin-vert--md"><time datetime="2022-04-06T00:00:00.000Z" class="blogPostDate_fNvV">2022å¹´4æœˆ6æ—¥ Â· é˜…è¯»éœ€è¦ 1 åˆ†é’Ÿ</time></div><div class="avatar margin-vert--md"><a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://kubevela.io/img/logo.svg" alt="æ®µå¨ï¼ˆæ®µå°‘ï¼‰"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer">æ®µå¨ï¼ˆæ®µå°‘ï¼‰</a></h4><small class="avatar__subtitle">KubeVela å›¢é˜Ÿ</small></div></div></header><div class="markdown"><p>åœ¨å½“ä»Šçš„å¤šé›†ç¾¤ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°çš„éœ€æ±‚æœ‰ï¼šåˆ†å‘åˆ°å¤šä¸ªæŒ‡å®šé›†ç¾¤ã€æŒ‰ä¸šåŠ¡è§„åˆ’å®ç°åˆ†ç»„åˆ†å‘ã€ä»¥åŠå¯¹å¤šé›†ç¾¤è¿›è¡Œå·®å¼‚åŒ–é…ç½®ç­‰ç­‰ã€‚</p><p>KubeVela v1.3 åœ¨ä¹‹å‰çš„å¤šé›†ç¾¤åŠŸèƒ½ä¸Šè¿›è¡Œäº†è¿­ä»£ï¼Œæœ¬æ–‡å°†ä¸ºä½ æ­ç¤ºï¼Œå¦‚ä½•ä½¿ç”¨ KubeVela è¿›è¡Œå¤šé›†ç¾¤åº”ç”¨çš„éƒ¨ç½²ä¸ç®¡ç†ï¼Œå®ç°ä»¥ä¸Šçš„ä¸šåŠ¡éœ€æ±‚ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å¼€å§‹ä¹‹å‰"></a>å¼€å§‹ä¹‹å‰<a class="hash-link" href="#å¼€å§‹ä¹‹å‰" title="Direct link to heading">#</a></h3><ol><li>å‡†å¤‡ä¸€ä¸ª Kubernetes é›†ç¾¤ä½œä¸º KubeVela çš„æ§åˆ¶å¹³é¢ã€‚</li><li>ç¡®ä¿ <a href="https://github.com/oam-dev/kubevela/releases/tag/v1.3.0" target="_blank" rel="noopener noreferrer">KubeVela v1.3</a> å’Œ KubeVela CLI v1.3.0 å·²ç»å®‰è£…æˆåŠŸã€‚</li><li>ä½ è¦ç®¡ç†çš„å­é›†ç¾¤åˆ—è¡¨ kubeconfigã€‚æˆ‘ä»¬å°†ä»¥ beijing-1ï¼Œbeijing-2 å’Œ us-west-1 è¿™ 3 ä¸ªé›†ç¾¤ä¸ºä¾‹ã€‚</li><li>ä¸‹è½½å¹¶ç»“åˆ <a href="https://github.com/oam-dev/samples/tree/master/12.Multi_Cluster_Demo" target="_blank" rel="noopener noreferrer">multi-cluster-demo</a> æ¥æ›´å¥½çš„ç†è§£ï¼Œå¦‚ä½•ä½¿ç”¨ KubeVela å¤šé›†ç¾¤èƒ½åŠ›ã€‚</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="åˆ†å‘åˆ°å¤šä¸ªæŒ‡å®šé›†ç¾¤"></a>åˆ†å‘åˆ°å¤šä¸ªæŒ‡å®šé›†ç¾¤<a class="hash-link" href="#åˆ†å‘åˆ°å¤šä¸ªæŒ‡å®šé›†ç¾¤" title="Direct link to heading">#</a></h3><p>å¯¹å¤šä¸ªæŒ‡å®šé›†ç¾¤è¿›è¡Œåˆ†å‘æ˜¯æœ€åŸºæœ¬çš„å¤šé›†ç¾¤ç®¡ç†æ“ä½œã€‚åœ¨ KubeVela ä¸­ï¼Œä½ å°†ä½¿ç”¨ä¸€ä¸ªå«åš <code>topology</code> çš„åº”ç”¨ç­–ç•¥æ¥å®ç°å®ƒã€‚é›†ç¾¤ä»¥æ•°ç»„çš„å½¢å¼ï¼Œåˆ—åœ¨å…¶å±æ€§çš„ <code>clusters</code> å­—æ®µé‡Œã€‚</p><p>é¦–å…ˆè®©æˆ‘ä»¬ç¡®ä¿åˆ‡æ¢ KUBECONFIG åˆ°å‡†å¤‡å¥½çš„ç®¡æ§é›†ç¾¤ï¼Œä½¿ç”¨ <code>vela cluster join</code> å°†  beijing-1ï¼Œbeijing-2 å’Œ us-west-1 è¿™ 3 ä¸ªé›†ç¾¤å…¨éƒ¨çº³ç®¡è¿›æ¥ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">âœ   vela cluster join beijing-1.kubeconfig --name beijing-1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">âœ   vela cluster join beijing-2.kubeconfig --name beijing-2</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">âœ   vela cluster join us-west-1.kubeconfig --name us-west-1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">âœ   vela cluster list</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">CLUSTER         TYPE            ENDPOINT                    ACCEPTED    LABELS</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">beijing-1       X509Certificate https://47.95.22.71:6443    true</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">beijing-2       X509Certificate https://47.93.117.83:6443   true</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">us-west-1       X509Certificate https://47.88.31.118:6443   true</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æ¥ç€æ‰“å¼€ multi-cluster-demoï¼ŒæŸ¥çœ‹ <code>basic.yaml</code>ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">apiVersion: core.oam.dev/v1beta1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kind: Application</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">metadata:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  name: example-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  namespace: default</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">spec:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  components:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    - name: hello-world-server</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      type: webservice</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      properties:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        image: crccheck/hello-world</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        port: 8000</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      traits:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        - type: scaler</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          properties:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            replicas: 3</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        - type: gateway</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          properties:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            domain: testsvc-mc.example.com</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            # classInSpec : true   å¦‚æœä½ æ‰€ä¸‹å‘çš„é›†ç¾¤é‡Œæœ‰å®‰è£… v1.20 ä»¥ä¸‹ç‰ˆæœ¬çš„ Kubernetes ï¼Œè¯·åŠ ä¸Šè¿™ä¸ªå­—æ®µ</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            http:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">              &quot;/&quot;: 8000</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  policies:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    - type: topology</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      name: beijing-clusters</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      properties:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        clusters: [&quot;beijing-1&quot;,&quot;beijing-2&quot;]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªåº”ç”¨ä½¿ç”¨äº† <code>webservice</code> ç±»å‹çš„ç»„ä»¶ï¼Œæœ€åé€šè¿‡ <code>topology</code> çš„åº”ç”¨ç­–ç•¥åˆ†åˆ«å‘ beijing-1 å’Œ beijing-2 ä¸¤ä¸ªé›†ç¾¤åˆ†å‘ 3 å‰¯æœ¬ Deploymentã€‚</p><p><strong>è¯·æ³¨æ„ï¼Œç®¡æ§é›†ç¾¤å¯¹å­é›†ç¾¤ä¸‹å‘èµ„æºæˆåŠŸçš„å‰ææ˜¯ï¼Œå­é›†ç¾¤å¿…é¡»æœ‰å·²ç»æ–°å»ºçš„å¯¹åº”å‘½åç©ºé—´ã€‚ç”±äºæ¯ä¸ªé›†ç¾¤é»˜è®¤éƒ½æœ‰ </strong><code>default</code><strong> å‘½åç©ºé—´ï¼Œæ‰€ä»¥å¯ä»¥æ­£å¸¸ä¸‹å‘ã€‚å‡è®¾æˆ‘ä»¬å°†</strong> <code>basic.yaml</code> <strong>çš„å‘½åç©ºé—´æ”¹æˆ</strong> <code>multi-cluster</code> <strong>ï¼Œåˆ™ä¼šæ”¶åˆ°æŠ¥é”™ï¼š</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">... </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"> Status:        runningWorkflow</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Workflow:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  mode: DAG</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  finished: false</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Suspend: false</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Terminated: false</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Steps</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  - id:9fierfkhsc</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    name:deploy-beijing-clusters</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    type:deploy</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    phase:failed</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    message:step deploy: step deploy: run step(provider=oam,do=components-apply): Found 1 errors. [(failed to apply component beijing-1-multi-cluster-0: HandleComponentsRevision: failed to create componentrevision beijing-1/multi-cluster/hello-world-server-v1: namespaces &quot;multi-cluster&quot; not found)]</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Services:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">...</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><strong>åœ¨æœªæ¥çš„ KubeVela ç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬å°†æ”¯æŒä½¿ç”¨é‰´æƒç³»ç»Ÿï¼Œæ›´ä¾¿æ·æ›´å®‰å…¨çš„å®Œæˆè¿™é¡¹æ“ä½œï¼šé€šè¿‡ç®¡æ§é›†ç¾¤ä¸€é”®åœ¨å­é›†ç¾¤åˆ›å»ºå‘½åç©ºé—´ã€‚</strong></p><p>å®Œæˆå­é›†ç¾¤å‘½åç©ºé—´åˆ›å»ºåï¼Œåˆ‡å›ç®¡æ§é›†ç¾¤åˆ›å»ºåº”ç”¨å¹¶ä¸‹å‘èµ„æºï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">âœ   vela up -f basic.yaml</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Applying an application in vela K8s object format...</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;patching object&quot; name=&quot;example-app&quot; resource=&quot;core.oam.dev/v1beta1, Kind=Application&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">âœ… App has been deployed ğŸš€ğŸš€ğŸš€</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    Port forward: vela port-forward example-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">             SSH: vela exec example-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">         Logging: vela logs example-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      App status: vela status example-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Service status: vela status example-app --svc hello-world-server</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æˆ‘ä»¬é€šè¿‡ <code>vela status &lt;åº”ç”¨å&gt;</code> æŸ¥çœ‹æœåŠ¡ç›¸å…³ä¿¡æ¯ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">âœ   vela status example-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">About:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Name:         example-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Namespace:    default</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Created at:   2022-03-25 17:42:33 +0800 CST</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Status:       running</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Workflow:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  mode: DAG</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  finished: true</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Suspend: false</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Terminated: false</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Steps</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  - id:wftf9d4exj</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    name:deploy-beijing-clusters</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    type:deploy</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    phase:succeeded</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    message:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Services:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  - Name: hello-world-server</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    Cluster: beijing-1  Namespace: default</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    Type: webservice</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    Healthy Ready:3/3</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    Traits:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      âœ… scaler      âœ… gateway: Visiting URL: testsvc-mc.example.com, IP: 60.205.222.30</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  - Name: hello-world-server</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    Cluster: beijing-2  Namespace: default</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    Type: webservice</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    Healthy Ready:3/3</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    Traits:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      âœ… scaler      âœ… gateway: Visiting URL: testsvc-mc.example.com, IP: 182.92.222.128</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>beijing-1 å’Œ beijing-2 éƒ½ä¸‹å‘äº†å¯¹åº”çš„èµ„æºï¼Œå®ƒä»¬å¯ä¾›å¤–éƒ¨è®¿é—®çš„ IP åœ°å€ä¹Ÿæ˜¾ç¤ºå‡ºæ¥ï¼Œä½ å› è€Œå¯ä»¥ç”¨ä½ å¸Œæœ›çš„æ–¹å¼ä¾›ç”¨æˆ·è®¿é—®äº†ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ä½¿ç”¨é›†ç¾¤-labels-æŒ‰éœ€åˆ†ç»„åˆ†å‘"></a>ä½¿ç”¨é›†ç¾¤ labels æŒ‰éœ€åˆ†ç»„åˆ†å‘<a class="hash-link" href="#ä½¿ç”¨é›†ç¾¤-labels-æŒ‰éœ€åˆ†ç»„åˆ†å‘" title="Direct link to heading">#</a></h3><p>é™¤äº†ä¸Šè¿°çš„åŸºæœ¬æ“ä½œï¼Œæˆ‘ä»¬å¸¸å¸¸ä¼šé‡åˆ°å¦å¤–çš„æƒ…å†µï¼šè·¨åœ°åŸŸéƒ¨ç½²åˆ°æŸäº›é›†ç¾¤ã€æŒ‡å®šå“ªä¸ªäº‘å‚å•†çš„é›†ç¾¤ç­‰ç­‰ã€‚ä¸ºäº†å®ç°ç±»ä¼¼è¿™æ ·çš„éœ€æ±‚ï¼Œå¯ä»¥ä½¿ç”¨å¤šé›†ç¾¤çš„ labels åŠŸèƒ½ã€‚</p><p>åœ¨è¿™é‡Œï¼Œå‡è®¾ us-west-1 é›†ç¾¤æ¥è‡ª AWSï¼Œæˆ‘ä»¬è¦é¢å¤–åˆ†å‘åº”ç”¨åˆ° AWS çš„é›†ç¾¤ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ <code>vela cluster labels add</code> æ¥å¯¹é›†ç¾¤è¿›è¡Œæ ‡è®°ã€‚å½“ç„¶ï¼Œå¦‚æœè¿˜æœ‰ us-west-2 ç­‰å¤šä¸ª AWS ç›¸å…³é›†ç¾¤ï¼ŒåŒæ ·è¿›è¡Œæ ‡è®°åï¼Œå°†ä¼šç»Ÿä¸€ä¸‹å‘ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">âœ  ~ vela cluster labels add us-west-1 provider=AWS</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Successfully update labels for cluster us-west-1 (type: X509Certificate).</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">provider=AWS</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">âœ  ~ vela cluster list</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">CLUSTER         TYPE            ENDPOINT                    ACCEPTED    LABELS</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">beijing-1       X509Certificate https://47.95.22.71:6443    true</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">beijing-2       X509Certificate https://47.93.117.83:6443   true</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">us-west-1       X509Certificate https://47.88.31.118:6443   true        provider=AWS</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æ¥ä¸‹æ¥æˆ‘ä»¬å¯¹ <code>basic.yaml</code> è¿›è¡Œæ›´æ–°ï¼Œæ–°å¢ä¸€ä¸ªåº”ç”¨ç­–ç•¥ <code>topology-aws</code>ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">...</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  policies:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    - type: topology</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      name: beijing-clusters</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      properties:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        clusters: [&quot;beijing-1&quot;,&quot;beijing-2&quot;]</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    - type: topology</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      name: topology-aws</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      properties:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        clusterLabelSelector:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          provider: AWS</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ä¸ºäº†æ–¹ä¾¿ä½ å­¦ä¹ ï¼Œè¯·ç›´æ¥éƒ¨ç½²åŸºäº <code>basic.yaml</code> æ›´æ–°åçš„ <code>intermediate.yaml</code>ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">âœ  ~ vela up -f intermediate.yaml</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>å†æ¬¡æŸ¥çœ‹åº”ç”¨çš„çŠ¶æ€ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">âœ   vela status example-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">...</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  - Name: hello-world-server</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    Cluster: us-west-1  Namespace: default</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    Type: webservice</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    Healthy Ready:3/3</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    Traits:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      âœ… scaler      âœ… gateway: Visiting URL: testsvc-mc.example.com, IP: 192.168.40.10</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="é€šè¿‡åº”ç”¨ç­–ç•¥è¿›è¡Œé…ç½®å·®å¼‚åŒ–"></a>é€šè¿‡åº”ç”¨ç­–ç•¥è¿›è¡Œé…ç½®å·®å¼‚åŒ–<a class="hash-link" href="#é€šè¿‡åº”ç”¨ç­–ç•¥è¿›è¡Œé…ç½®å·®å¼‚åŒ–" title="Direct link to heading">#</a></h3><p>é™¤äº†åœ¨ <code>basic.yaml</code> é‡Œå®šä¹‰çš„ <code>deploy-beijing</code> è¿™ç§åº”ç”¨ç­–ç•¥ï¼Œæˆ‘ä»¬å¾€å¾€æœ‰æ›´å¤šçš„åº”ç”¨ç­–ç•¥éœ€æ±‚ï¼Œæ¯”å¦‚é«˜å¯ç”¨ï¼Œå¸Œæœ›å•ç‹¬ç»™æŸäº›èµ„æºåˆ†å‘ 5 ä¸ªå‰¯æœ¬ã€‚è¿™æ ·çš„è¯ï¼Œä½¿ç”¨ <code>override</code> ç±»å‹çš„åº”ç”¨ç­–ç•¥å³å¯ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">...        </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        clusterLabelSelector:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          provider: AWS</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    -  type: override</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       name: override-high-availability</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       properties:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          components:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            - type: webservice</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">              traits:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">              - type: scaler</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                properties:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                  replicas: 5</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>åŒæ—¶å‡è®¾ï¼Œæˆ‘ä»¬å¸Œæœ›çš„æ˜¯ï¼Œç»™ AWS çš„åº”ç”¨åˆ†å‘å¹¶è®¾ç½®ä¸ºé«˜å¯ç”¨ã€‚é‚£æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ KubeVela æä¾›çš„ä¸“é—¨ç”¨äºå®šä¹‰è¿‡ç¨‹æ§åˆ¶çš„å·¥ä½œæµæ¥ç®¡ç†ã€‚æˆ‘ä»¬ä½¿ç”¨å¦‚ä¸‹çš„ä¸€ä¸ªå·¥ä½œæµï¼Œå®ƒå¸Œæœ›å°†æœ¬æ¬¡åº”ç”¨éƒ¨ç½²ï¼Œé¦–å…ˆé€šè¿‡ deploy-beijing çš„åº”ç”¨ç­–ç•¥ï¼Œåˆ†å‘ç»™åŒ—äº¬çš„é›†ç¾¤ä»¬ï¼Œæ¥ç€ç»™ Label ä¸º AWS çš„é›†ç¾¤åˆ†å‘ 5 ä¸ªå‰¯æœ¬é«˜å¯ç”¨çš„åº”ç”¨ç­–ç•¥ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">...                </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                properties:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                  replicas: 5</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  workflow:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    steps:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      - type: deploy</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        name: deploy-beijing</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        properties:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          policies: [&quot;beijing-clusters&quot;]</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      - type: deploy</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        name: deploy-aws</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        properties:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          policies: [&quot;override-high-availability&quot;,&quot;topology-aws&quot;]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æ¥ç€æˆ‘ä»¬ç»™ <code>intermediate.yaml</code> åŠ ä¸Šä»¥ä¸Šçš„åº”ç”¨ç­–ç•¥å’Œå·¥ä½œæµåï¼Œæ›´æ–°ä¸º <code>advanced.yaml</code>ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">...</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  policies:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    - type: topology</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      name: beijing-clusters</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      properties:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        clusters: [&quot;beijing-1&quot;,&quot;beijing-2&quot;]</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    - type: topology</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      name: topology-aws</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      properties:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        clusterLabelSelector:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          provider: AWS</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    -  type: override</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       name: override-high-availability</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       properties:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          components:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            - type: webservice</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">              traits:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">              - type: scaler</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                properties:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                  replicas: 5</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  workflow:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    steps:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      - type: deploy</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        name: deploy-beijing</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        properties:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          policies: [&quot;beijing-clusters&quot;]</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      - type: deploy</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        name: deploy-aws</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        properties:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          policies: [&quot;override-high-availability&quot;,&quot;topology-aws&quot;]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ç„¶åå¯¹å…¶è¿›è¡Œéƒ¨ç½²ï¼Œå¹¶å†æ¬¡æŸ¥çœ‹åº”ç”¨çš„çŠ¶æ€ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">âœ   vela up -f advanced.yaml</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Applying an application in vela K8s object format...</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;patching object&quot; name=&quot;example-app&quot; resource=&quot;core.oam.dev/v1beta1, Kind=Application&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">âœ… App has been deployed ğŸš€ğŸš€ğŸš€</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    Port forward: vela port-forward example-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">             SSH: vela exec example-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">         Logging: vela logs example-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      App status: vela status example-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Service status: vela status example-app --svc hello-world-serverapplication.core.oam.dev/podinfo-app configured</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">âœ   vela status example-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">...</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  - Name: hello-world-server</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    Cluster: us-west-1  Namespace: default</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    Type: webservice</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    Healthy Ready:5/5</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    Traits:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      âœ… scaler      âœ… gateway: Visiting URL: testsvc-mc.example.com, IP: 192.168.40.10</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ä»¥ä¸Šå°±æ˜¯æœ¬æ¬¡çš„å…¨éƒ¨åˆ†äº«ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»å’Œè¯•ç©ã€‚</p><p><a href="https://kubevela.net/zh/docs/install" target="_blank" rel="noopener noreferrer">æ¬¢è¿ä½ ç»§ç»­æ¢ç´¢ KubeVela v1.3 æ­£å¼ç‰ˆ</a>ï¼Œè¿™é‡Œæœ‰æ›´å¤šå·®å¼‚åŒ–é…ç½®çš„è¿›é˜¶ç”¨æ³•ç­‰ä½ å‘ç°å’Œä½¿ç”¨ï¼Œæ¯”å¦‚ <code>override</code> åº”ç”¨ç­–ç•¥å¦‚ä½•å®Œæˆèµ„æºç±»å‹é€šé…è¿˜æ˜¯é’ˆå¯¹æŸäº›ç‰¹å®šç»„ä»¶è¿›è¡Œè¦†ç›–ç­‰ç­‰ï¼Œä»¥æ»¡è¶³æ›´åŠ å¤æ‚çš„åœºæ™¯éœ€æ±‚ã€‚</p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/zh/blog/tags/kube-vela">KubeVela</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/zh/blog/2022/04/01/offline-deployment-practice copy">China Merchants Bank&#x27;s Practice on Offline Installation with KubeVela</a></h2><div class="margin-vert--md"><time datetime="2022-04-01T00:00:00.000Z" class="blogPostDate_fNvV">2022å¹´4æœˆ1æ—¥ Â· é˜…è¯»éœ€è¦ 1 åˆ†é’Ÿ</time></div><div class="avatar margin-vert--md"><a href="http://www.cmbchina.com/" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="/img/china-merchants-bank.jpg" alt="Xiangbo Ma"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="http://www.cmbchina.com/" target="_blank" rel="noopener noreferrer">Xiangbo Ma</a></h4><small class="avatar__subtitle">(Cloud platform development team)</small></div></div></header><div class="markdown"><p>The cloud platform development team of China Merchants Bank has been trying out KubeVela since 2021 internally and aims to using it for enhancing our primary application delivery and management capabilities. Due to the specific security concern for financial insurance industry, network control measurements are relatively strict, and our intranet cannot directly pull Docker Hub image, and there is no Helm image source available as well. Therefore, in order to landing KubeVela in the intranet, you must perform a complete offline installation.</p><p>This article will take the KubeVela V1.2.5 version as an example, introduce the offline installation practice to help other users easier to complete KubeVela&#x27;s deployment in offline environment.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="kubevela-offline-installation-solution"></a>KubeVela Offline Installation Solution<a class="hash-link" href="#kubevela-offline-installation-solution" title="Direct link to heading">#</a></h2><p>We divide the offline installation of KubeVela in three parts, which are Vela CLI, Vela Core, and Addon offline installation. Each part mainly involves the loading of the relevant Docker image and Helm&#x27;s package, which can greatly speed up deployment process in offline environment.</p><p>Before doing so, please ensure that Kubernetes cluster version is  <code>&gt;= v1.19 &amp;&amp; &lt; v1.22</code>. One way of KubeVela as a control plane relies on Kubernetes, which can be placed in any product or in any cloud provider. At the same time, you can also use Kind or Minikube to deploy KubeVela locally.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="vela-cli-offline-installation"></a>Vela CLI Offline Installation<a class="hash-link" href="#vela-cli-offline-installation" title="Direct link to heading">#</a></h3><ul><li>First, you need to download of the binary version of <code>vela</code> that you want by checking KubeVela <a href="https://github.com/oam-dev/kubevela/releases" target="_blank" rel="noopener noreferrer">Release Log</a></li><li>Unzip binary files and configure the appropriate environment variables in <code>$PATH</code><ul><li>Unzip binary file<ul><li><code>tar -zxvf vela-v1.2.5-linux-amd64.tar.gz</code></li><li><code>mv ./linux-amd64/vela /usr/local/bin/vela</code></li></ul></li><li>Set environment variables<ul><li><code>vi /etc/profile</code></li><li><code>export PATH=&quot;$PATH:/usr/local/bin&quot;</code></li><li><code>source /etc/profile</code></li></ul></li><li>Verify the installation of Vela CLI through <code>vela version</code></li></ul></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">CLI VERSION: V1.2.5</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Core Version:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">GitRevision: git-ef80b66</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">GOLANGVERSION: Go1.17.7</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ul><li>At this point, Vela CLI has been deployed offline!</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="vela-core-offline-installation"></a>Vela Core Offline Installation<a class="hash-link" href="#vela-core-offline-installation" title="Direct link to heading">#</a></h3><ul><li>Before deploying Vela Core offline, first you need to install <a href="https://helm.sh/docs/intro/install/" target="_blank" rel="noopener noreferrer">Helm</a> in an offline environment and its version needs to meet <code>v3.2.0+</code></li><li>Prepare Docker image. Vela Core&#x27;s deployment mainly involves 5 images, you need to first visit the Docker Hub in extranet to download the corresponding images, then load them to offline environment<ul><li>Pull the image from Docker Hub<ul><li><code>docker pull oamdev/vela-core:v1.2.5</code></li><li><code>docker pull oamdev/cluster-gateway:v1.1.7</code></li><li><code>docker pull oamdev/kube-webhook-certgen:v2.3</code></li><li><code>docker pull oamdev/alpine-k8s:1.18.2</code></li><li><code>docker pull oamdev/hello-world:v1</code></li></ul></li><li>Save image to local disks<ul><li><code>docker save -o vela-core.tar oamdev/vela-core:v1.2.5</code></li><li><code>docker save -o cluster-gateway.tar oamdev/cluster-gateway:v1.1.7</code></li><li><code>docker save -o kube-webhook-certgen.tar oamdev/kube-webhook-certgen:v2.3</code></li><li><code>docker save -o alpine-k8s.tar oamdev/alpine-k8s:1.18.2</code></li><li><code>docker save -o hello-world.tar oamdev/hello-world:v1</code></li></ul></li><li>Re-load the image in the offline environment<ul><li><code>docker load vela-core.tar</code></li><li><code>docker load cluster-gateway.tar</code></li><li><code>docker load kube-webhook-certgen.tar</code></li><li><code>docker load alpine-k8s.tar</code></li><li><code>docker load hello-world.tar</code></li></ul></li></ul></li><li>Download <a href="https://github.com/oam-dev/KubeVela/releases" target="_blank" rel="noopener noreferrer">KubeVela Core</a>, copy it to offline environment and use Helm to repackage<ul><li>Repackage the KubeVela source code and install the chart package to the control cluster offline<ul><li><code>helm package kubevela/charts/vela-core --destination kubevela/charts</code></li><li><code>helm install --create-namespace -n vela-system kubevela kubevela/charts/vela-core-0.1.0.tgz --wait</code></li></ul></li><li>Check the output</li></ul></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">KubeVela Control Plane Has Been successfully </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">set</span><span class="token plain"> up on your cluster.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ul><li>At this point, Vela Core has been deployed offline!</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="addon-offline-installation"></a>Addon Offline Installation<a class="hash-link" href="#addon-offline-installation" title="Direct link to heading">#</a></h3><ul><li>First download <a href="https://github.com/oam-dev/catalog" target="_blank" rel="noopener noreferrer">Catalog Source</a> and copy it to offline environment</li><li>Here, we will take VelaUX, one of many more addons, as an example. First prepare its Docker image, VelaUX mainly involve 2 images, you need to first access the extranet to download the corresponding image from Docker Hub, then load it to offline environment<ul><li>Pull the image from Docker Hub<ul><li><code>docker pull oamdev/vela-apiserver:v1.2.5</code></li><li><code>docker pull oamdev/velaux:v1.2.5</code></li></ul></li><li>Save image to local disks<ul><li><code>docker save -o vela-apiserver.tar oamdev/vela-apiserver:v1.2.5</code></li><li><code>docker save -o velaux.tar oamdev/velaux:v1.2.5</code></li></ul></li><li>Re-load the image in the offline environment<ul><li><code>docker load vela-apiserver.tar</code></li><li><code>docker load velaux.tar</code></li></ul></li></ul></li><li>Install VelaUX<ul><li>Install VelaUX via Vela CLI<ul><li><code>vela addon enable catalog-master/addons/velaux</code></li></ul></li><li>Check the output</li></ul></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Addon: velaux enabled Successfully.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ul><li>If there is a cluster installed route Controller or Nginx Ingress Controller and also linked with an available domain, you can deploy external routing to make VelaUX accessible. Here present Openshift Route as an example, you can also choose Ingress if you wish</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> route.openshift.io/v1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Route</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> velaux</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">route</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">namespace</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> vela</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">system</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">host</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> velaux.xxx.xxx.cn</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">targetPort</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">80</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">to</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Service</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> velaux</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">weight</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">100</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">wildcardPolicy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> None</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ul><li>Check the installation</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> -I -m </span><span class="token number">10</span><span class="token plain"> -o /dev/null -s -w %</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">http_code</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> http://velaux.xxx.xxx.cn/applications</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ul><li>At this point, VelaUX has been deployed offline! At the same time, for other types of Addon&#x27;s offline deployment, access to the corresponding directory of the <a href="https://github.com/oam-dev/catalog" target="_blank" rel="noopener noreferrer">Catalog Source</a> and repeat the above moves, you would complete all the addons&#x27; offline deployments for good.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="summarize"></a>Summarize<a class="hash-link" href="#summarize" title="Direct link to heading">#</a></h2><p>During offline deployment, we also try to save Vela Core and Addon&#x27;s resource that generated to be YAML files after deploying in extranet and re-deploy them in an offline environment, but because of all different kinds of resource involved in and it requires many other authorization issues to resolve, this way is more than cumbersome.</p><p>With this practice of KubeVela&#x27;s offline deployment, we hope it help you build a complete set of KubeVela in offline environment much faster. Offline installation is pretty much a pain point for most developers, we also see that the KubeVela community is introducing the brand new <a href="https://github.com/oam-dev/velad" target="_blank" rel="noopener noreferrer">velad</a>, a fully offline, highly accountable installation tool. Velad can help automate completion by making many steps as one, such as preparing clusters, downloading and packing image, installing and etc. Further more, it do support many features: In Linux machine (such as Alibaba Cloud ECS) we can locally spin up a cluster to install Vela-Core; while starting a KubeVela control plane, do not have to worry about its data to be lost when machine behind it accidentally was shutdown; Velad can stores all the data from control plane cluster into a traditional database (such as MySQL deployed on another ECS).</p><p>In the recent version to come, China Merchants Bank will increase the efforts in the open source community of KubeVela, actively building: enterprise-level capacity, enhancement on multi-cluster, offline deployment and application-level observability. We&#x27;ll also be contributing the financial industry&#x27;s user scenarios and business needs, driving cloud-native ecology achieve more easily and efficient application management experience, and at last but not at least, welcome you the community member to join us together in this journey.</p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/zh/blog/tags/kube-vela">KubeVela</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/zh/blog/2022/03/02/kubevela-with-machine-learning">åŸºäº KubeVela çš„æœºå™¨å­¦ä¹ å®è·µ</a></h2><div class="margin-vert--md"><time datetime="2022-03-02T00:00:00.000Z" class="blogPostDate_fNvV">2022å¹´3æœˆ2æ—¥ Â· é˜…è¯»éœ€è¦ 1 åˆ†é’Ÿ</time></div><div class="avatar margin-vert--md"><a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://kubevela.io/img/logo.svg" alt="Tianxin Dong"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer">Tianxin Dong</a></h4><small class="avatar__subtitle">KubeVela å›¢é˜Ÿ</small></div></div></header><div class="markdown"><p>åœ¨æœºå™¨å­¦ä¹ æµªæ½®è¿¸å‘çš„å½“ä¸‹ï¼ŒAI å·¥ç¨‹å¸ˆé™¤äº†éœ€è¦è®­ç»ƒã€è°ƒè¯•è‡ªå·±çš„æ¨¡å‹ä¹‹å¤–ï¼Œè¿˜éœ€è¦å°†æ¨¡å‹è¿›è¡Œéƒ¨ç½²ä¸Šçº¿ï¼Œä»è€ŒéªŒè¯æ¨¡å‹çš„æ•ˆæœï¼ˆå½“ç„¶ï¼Œæœ‰çš„æ—¶å€™ï¼Œè¿™éƒ¨åˆ†å·¥ä½œç”± AI ç³»ç»Ÿå·¥ç¨‹å¸ˆæ¥å®Œæˆï¼‰ã€‚è¿™ä¸€éƒ¨åˆ†å·¥ä½œå¯¹äº AI å·¥ç¨‹å¸ˆä»¬æ¥è¯´æ˜¯ç¹çã€ä¸”æ¶ˆè€—é¢å¤–ç²¾åŠ›çš„ã€‚</p><p>è€Œåœ¨äº‘åŸç”Ÿæ—¶ä»£ï¼Œæˆ‘ä»¬çš„æ¨¡å‹è®­ç»ƒå’Œæ¨¡å‹æœåŠ¡ä¹Ÿé€šå¸¸åœ¨äº‘ä¸Šè¿›è¡Œã€‚è¿™æ ·åšä¸ä»…æé«˜äº†å¯æ‰©å±•æ€§ï¼Œè¿˜èƒ½å¤Ÿæå‡èµ„æºçš„åˆ©ç”¨ç‡ã€‚è¿™å¯¹äºéœ€è¦æ¶ˆè€—å¤§é‡è®¡ç®—èµ„æºçš„æœºå™¨å­¦ä¹ åœºæ™¯æ¥è¯´ï¼Œæ˜¯ååˆ†æœ‰æ•ˆçš„ã€‚</p><p>ä½†æ˜¯ AI å·¥ç¨‹å¸ˆè¦æƒ³ä½¿ç”¨äº‘åŸç”Ÿçš„èƒ½åŠ›é€šå¸¸æ¯”è¾ƒå›°éš¾ã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼Œäº‘åŸç”Ÿçš„æ¦‚å¿µå·²ç»è¶Šæ¥è¶Šå¤æ‚ã€‚æƒ³è¦åœ¨äº‘åŸç”Ÿä¹‹ä¸Šéƒ¨ç½²ä¸€ä¸ªç®€å•çš„æ¨¡å‹æœåŠ¡ï¼Œå¯èƒ½å¯¹äº AI å·¥ç¨‹å¸ˆæ¥è¯´ï¼Œéœ€è¦é¢å¤–å­¦ä¹ æ•°ç§æ¦‚å¿µï¼šæ¯”å¦‚ Deploymentã€Serviceã€Ingress ç­‰ã€‚</p><p>è€Œ KubeVela ä½œä¸ºä¸€ä¸ªç®€å•ã€æ˜“ç”¨ã€ä¸”é«˜å¯æ‰©å±•çš„äº‘åŸç”Ÿåº”ç”¨ç®¡ç†å·¥å…·ï¼Œèƒ½è®©å¼€å‘äººå‘˜æ–¹ä¾¿å¿«æ·åœ°åœ¨ Kubernetes ä¸Šå®šä¹‰ä¸äº¤ä»˜åº”ç”¨ï¼Œæ— éœ€äº†è§£ä»»ä½•åº•å±‚äº‘åŸç”ŸåŸºç¡€è®¾æ–½ç›¸å…³çš„ç»†èŠ‚ã€‚KubeVela æ‹¥æœ‰ç€ä¸°å¯Œçš„å¯æ‰©å±•æ€§ï¼Œå…¶ AI æ’ä»¶æä¾›äº†æ¨¡å‹è®­ç»ƒã€æ¨¡å‹æœåŠ¡ã€A/B æµ‹è¯•ç­‰åŠŸèƒ½ï¼Œè¦†ç›–äº† AI å·¥ç¨‹å¸ˆçš„åŸºæœ¬éœ€æ±‚ï¼Œèƒ½å¤Ÿå¸®åŠ© AI å·¥ç¨‹å¸ˆå¿«é€Ÿåœ¨äº‘åŸç”Ÿç¯å¢ƒä¸­è¿›è¡Œæ¨¡å‹è®­ç»ƒå’Œæ¨¡å‹æœåŠ¡ã€‚</p><p>æœ¬æ–‡ä¸»è¦ä»‹ç»å¦‚ä½•ä½¿ç”¨ KubeVela çš„ AI æ’ä»¶ï¼Œæ¥å¸®åŠ©å·¥ç¨‹å¸ˆæ›´ä¾¿æ·åœ°å®Œæˆæ¨¡å‹è®­ç»ƒåŠæ¨¡å‹æœåŠ¡ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="kubevela-ai-æ’ä»¶"></a>KubeVela AI æ’ä»¶<a class="hash-link" href="#kubevela-ai-æ’ä»¶" title="Direct link to heading">#</a></h2><p>KubeVela AI æ’ä»¶åˆ†ä¸ºæ¨¡å‹è®­ç»ƒå’Œæ¨¡å‹æœåŠ¡ä¸¤ä¸ªæ’ä»¶ï¼Œæ¨¡å‹è®­ç»ƒæ’ä»¶åŸºäº KubeFlow çš„ training-operatorï¼Œèƒ½å¤Ÿæ”¯æŒå¦‚ TensorFlowã€PyTorchã€MXNet ç­‰ä¸åŒæ¡†æ¶çš„åˆ†å¸ƒå¼æ¨¡å‹è®­ç»ƒã€‚è€Œæ¨¡å‹æœåŠ¡æ’ä»¶åŸºäº Seldon Coreï¼Œå¯ä»¥ä¾¿æ·åœ°ä½¿ç”¨æ¨¡å‹å¯åŠ¨æ¨¡å‹æœåŠ¡ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒæµé‡åˆ†å‘ï¼ŒA/B æµ‹è¯•ç­‰é«˜çº§åŠŸèƒ½ã€‚</p><p><img alt="alt" src="/zh/assets/images/ai-addon-b00e60c94fb2a6e6d6d661cbf2e1cef8.png"></p><p>é€šè¿‡ KubeVela AI æ’ä»¶ï¼Œå¯ä»¥å¤§å¤§ç®€åŒ–æ¨¡å‹è®­ç»ƒä»»åŠ¡çš„éƒ¨ç½²ä»¥åŠæ¨¡å‹æœåŠ¡çš„éƒ¨ç½²ï¼ŒåŒæ—¶ï¼Œå¯ä»¥å°†æ¨¡å‹è®­ç»ƒã€æ¨¡å‹æœåŠ¡ç­‰è¿‡ç¨‹ä¸ KubeVela æœ¬èº«çš„å·¥ä½œæµã€å¤šé›†ç¾¤ç­‰åŠŸèƒ½ç›¸ç»“åˆï¼Œä»è€Œå®Œæˆç”Ÿäº§å¯ç”¨çš„æœåŠ¡éƒ¨ç½²ã€‚</p><blockquote><p>æ³¨ï¼šä½ å¯ä»¥åœ¨ <a href="https://github.com/oam-dev/samples/tree/master/11.Machine_Learning_Demo" target="_blank" rel="noopener noreferrer">KubeVela Samples</a> ä¸­æ‰¾åˆ°æ‰€æœ‰çš„æºç å’Œ YAML æ–‡ä»¶ã€‚å¦‚æœä½ æƒ³ä½¿ç”¨åœ¨è¿™ä¸ªä¾‹å­ä¸­é¢„è®­ç»ƒçš„æ¨¡å‹ï¼Œæ–‡ä»¶å¤¹ä¸­çš„ <code>style-model.yaml</code> å’Œ <code>color-model.yaml</code> ä¼šå°†æ¨¡å‹å¤åˆ¶åˆ° PVC ä¸­ã€‚</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ¨¡å‹è®­ç»ƒ"></a>æ¨¡å‹è®­ç»ƒ<a class="hash-link" href="#æ¨¡å‹è®­ç»ƒ" title="Direct link to heading">#</a></h2><p>é¦–å…ˆå¯åŠ¨æ¨¡å‹è®­ç»ƒå’Œæ¨¡å‹æœåŠ¡çš„ä¸¤ä¸ªæ’ä»¶ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">vela addon </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">enable</span><span class="token plain"> model-training</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">vela addon </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">enable</span><span class="token plain"> model-serving</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æ¨¡å‹è®­ç»ƒä¸­åŒ…å« <code>model-training</code> å’Œ <code>jupyter-notebook</code> ä¸¤ä¸ªç»„ä»¶ç±»å‹ï¼Œ æ¨¡å‹æœåŠ¡ä¸­åŒ…å« <code>model-serving</code> è¿™ä¸ªç»„ä»¶ç±»å‹ã€‚å¯ä»¥é€šè¿‡ <code>vela show</code> å‘½ä»¤æ¥æŸ¥çœ‹è¿™ä¸‰ä¸ªç»„ä»¶ä¸­çš„å…·ä½“å‚æ•°ã€‚</p><blockquote><p>ä½ ä¹Ÿå¯ä»¥é€‰æ‹©æŸ¥é˜… <a href="https://kubevela.io/zh/docs/next/reference/addons/ai" target="_blank" rel="noopener noreferrer">KubeVela AI æ’ä»¶æ–‡æ¡£</a>, æ¥è·å–æ›´å¤šä¿¡æ¯ã€‚</p></blockquote><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">vela show model-training</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">vela show jupyter-notebook</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">vela show model-serving</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æˆ‘ä»¬æ¥è®­ç»ƒä¸€ä¸ªç®€å•çš„ä½¿ç”¨ TensorFlow æ¡†æ¶çš„æ¨¡å‹ï¼Œè¿™ä¸ªæ¨¡å‹çš„æ•ˆæœæ˜¯èƒ½å¤Ÿå°†ç°è‰²çš„å›¾ç‰‡å˜æˆå½©è‰²çš„ã€‚éƒ¨ç½²å¦‚ä¸‹ YAML æ–‡ä»¶ï¼š</p><blockquote><p>æ³¨ï¼šæ¨¡å‹è®­ç»ƒçš„æºç æ¥æºäºï¼š<a href="https://github.com/emilwallner/Coloring-greyscale-images" target="_blank" rel="noopener noreferrer">emilwallner/Coloring-greyscale-images</a></p></blockquote><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> core.oam.dev/v1beta1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Application</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> training</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">serving</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> default</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">components</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># è®­ç»ƒæ¨¡å‹</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> demo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">training</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">training</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># è®­ç»ƒæ¨¡å‹çš„é•œåƒ</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> fogdong/train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">color</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">v1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># æ¨¡å‹è®­ç»ƒçš„æ¡†æ¶</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">framework</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> tensorflow</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># å£°æ˜å­˜å‚¨ï¼Œå°†æ¨¡å‹æŒä¹…åŒ–ã€‚æ­¤å¤„ä¼šä½¿ç”¨é›†ç¾¤å†…çš„é»˜è®¤ storage class æ¥åˆ›å»º PVC</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">storage</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;my-pvc&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">mountPath</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/model&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æ­¤æ—¶ï¼Œ KubeVela å°†æ‹‰èµ·ä¸€ä¸ª <code>TFJob</code> è¿›è¡Œæ¨¡å‹è®­ç»ƒã€‚</p><p>ä»…ä»…æ˜¯è®­ç»ƒæ¨¡å‹å¾ˆéš¾çœ‹å‡ºæ•ˆæœï¼Œæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹è¿™ä¸ª YAML æ–‡ä»¶ï¼Œå°†æ¨¡å‹æœåŠ¡æ”¾åˆ°æ¨¡å‹è®­ç»ƒçš„æ­¥éª¤ä¹‹åã€‚åŒæ—¶ï¼Œå› ä¸ºæ¨¡å‹æœåŠ¡ä¼šç›´æ¥å¯åŠ¨æ¨¡å‹ï¼Œè€Œæ¨¡å‹çš„è¾“å…¥è¾“å‡ºä¸å¤ªç›´è§‚ï¼ˆndarray æˆ–è€… Tensorï¼‰ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å†éƒ¨ç½²ä¸€ä¸ªæµ‹è¯•æœåŠ¡æ¥è°ƒç”¨æœåŠ¡ï¼Œå¹¶å°†ç»“æœè½¬æ¢æˆå›¾åƒã€‚</p><p>éƒ¨ç½²å¦‚ä¸‹ YAML æ–‡ä»¶ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> core.oam.dev/v1beta1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Application</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> training</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">serving</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> default</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">components</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># è®­ç»ƒæ¨¡å‹</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> demo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">training</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">training</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> fogdong/train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">color</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">v1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">framework</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> tensorflow</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">storage</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;my-pvc&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">mountPath</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/model&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># å¯åŠ¨æ¨¡å‹æœåŠ¡</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> demo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">serving</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">serving</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># æ¨¡å‹æœåŠ¡ä¼šåœ¨æ¨¡å‹è®­ç»ƒå®Œæˆåå¯åŠ¨</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">dependsOn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> demo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">training</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># å¯åŠ¨æ¨¡å‹æœåŠ¡ä½¿ç”¨çš„åè®®ï¼Œå¯ä»¥ä¸å¡«ï¼Œé»˜è®¤ä½¿ç”¨ seldon è‡ªèº«çš„åè®®</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">protocol</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> tensorflow</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">predictors</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> model</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token comment" style="color:rgb(98, 114, 164)"># æ¨¡å‹æœåŠ¡çš„å‰¯æœ¬æ•°</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">replicas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">graph</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token comment" style="color:rgb(98, 114, 164)"># æ¨¡å‹å</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">model</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token comment" style="color:rgb(98, 114, 164)"># æ¨¡å‹æ¡†æ¶</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">implementation</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> tensorflow</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token comment" style="color:rgb(98, 114, 164)"># æ¨¡å‹åœ°å€ï¼Œä¸Šä¸€æ­¥ä¼šå°†è®­ç»ƒå®Œçš„æ¨¡å‹ä¿å­˜åˆ° my-pvc è¿™ä¸ª pvc å½“ä¸­ï¼Œæ‰€ä»¥é€šè¿‡ pvc://my-pvc æŒ‡å®šæ¨¡å‹çš„åœ°å€</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">modelUri</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> pvc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">//my</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">pvc</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># æµ‹è¯•æ¨¡å‹æœåŠ¡</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> demo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">rest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">serving</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> webservice</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># æµ‹è¯•æœåŠ¡ä¼šåœ¨æ¨¡å‹è®­ç»ƒå®Œæˆåå¯åŠ¨</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">dependsOn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> demo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">serving</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> fogdong/color</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">serving</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">v1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># ä½¿ç”¨ LoadBalancer æš´éœ²å¯¹å¤–åœ°å€ï¼Œæ–¹ä¾¿è°ƒç”¨</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">exposeType</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> LoadBalancer</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">env</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> URL</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token comment" style="color:rgb(98, 114, 164)"># æ¨¡å‹æœåŠ¡çš„åœ°å€</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">//ambassador.vela</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">system.svc.cluster.local/seldon/default/demo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">serving/v1/models/my</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">predict</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)"># æµ‹è¯•æœåŠ¡çš„ç«¯å£</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">3333</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">expose</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean important">true</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>éƒ¨ç½²ä¹‹åï¼Œé€šè¿‡ <code>vela ls</code> æ¥æŸ¥çœ‹åº”ç”¨çš„çŠ¶æ€ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ vela </span><span class="token function" style="color:rgb(80, 250, 123)">ls</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">training-serving        demo-training       model-training          running healthy Job Succeeded   </span><span class="token number">2022</span><span class="token plain">-03-02 </span><span class="token number">17</span><span class="token plain">:26:40 +0800 CST</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€                      demo-serving        model-serving           running healthy Available       </span><span class="token number">2022</span><span class="token plain">-03-02 </span><span class="token number">17</span><span class="token plain">:26:40 +0800 CST</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">â””â”€                      demo-rest-serving   webservice              running healthy Ready:1/1       </span><span class="token number">2022</span><span class="token plain">-03-02 </span><span class="token number">17</span><span class="token plain">:26:40 +0800 CST</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>å¯ä»¥çœ‹åˆ°ï¼Œåº”ç”¨å·²ç»æ­£å¸¸å¯åŠ¨ã€‚é€šè¿‡ <code>vela status &lt;app-name&gt; --endpoint</code> æ¥æŸ¥çœ‹åº”ç”¨çš„æœåŠ¡åœ°å€ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ vela status training-serving --endpoint</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">+---------+-----------------------------------+---------------------------------------------------+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain"> CLUSTER </span><span class="token operator">|</span><span class="token plain">     REF</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">KIND/NAMESPACE/NAME</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain">                     ENDPOINT                      </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">+---------+-----------------------------------+---------------------------------------------------+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain">         </span><span class="token operator">|</span><span class="token plain"> Service/default/demo-rest-serving </span><span class="token operator">|</span><span class="token plain"> tcp://47.251.10.177:3333                          </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain">         </span><span class="token operator">|</span><span class="token plain"> Service/vela-system/ambassador    </span><span class="token operator">|</span><span class="token plain"> http://47.251.36.228/seldon/default/demo-serving  </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain">         </span><span class="token operator">|</span><span class="token plain"> Service/vela-system/ambassador    </span><span class="token operator">|</span><span class="token plain"> https://47.251.36.228/seldon/default/demo-serving </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">+---------+-----------------------------------+---------------------------------------------------+</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>è¯¥åº”ç”¨æœ‰ä¸‰ä¸ªæœåŠ¡åœ°å€ï¼Œç¬¬ä¸€ä¸ªæ˜¯æˆ‘ä»¬çš„æµ‹è¯•æœåŠ¡çš„åœ°å€ï¼Œç¬¬äºŒä¸ªå’Œç¬¬ä¸‰éƒ½æ˜¯åŸç”Ÿæ¨¡å‹çš„åœ°å€ã€‚æˆ‘ä»¬å¯ä»¥è°ƒç”¨æµ‹è¯•æœåŠ¡æ¥æŸ¥çœ‹æ¨¡å‹çš„æ•ˆæœï¼šæµ‹è¯•æœåŠ¡ä¼šè¯»å–å›¾åƒçš„å†…å®¹ï¼Œå¹¶å°†å…¶è½¬æˆ <code>Tensor</code> å¹¶è¯·æ±‚æ¨¡å‹æœåŠ¡ï¼Œæœ€åå°†æ¨¡å‹æœåŠ¡è¿”å›çš„ <code>Tensor</code> è½¬æˆå›¾åƒè¿”å›ã€‚</p><p>æˆ‘ä»¬é€‰æ‹©ä¸€å¼ é»‘ç™½çš„å¥³æ€§å›¾ç‰‡ä½œä¸ºè¾“å…¥ï¼š</p><p><img alt="alt" src="/zh/assets/images/woman-grey-7d5fe53e7da342e9136cf2473d2c4f8b.png"></p><p>è¯·æ±‚åï¼Œå¯ä»¥çœ‹åˆ°ï¼Œè¾“å‡ºäº†ä¸€å¼ å½©è‰²å›¾ç‰‡ï¼š</p><p><img alt="alt" src="/zh/assets/images/test-request-d575b2a24081dc7da768f9dd8fd18572.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ¨¡å‹æœåŠ¡ï¼šç°åº¦æµ‹è¯•"></a>æ¨¡å‹æœåŠ¡ï¼šç°åº¦æµ‹è¯•<a class="hash-link" href="#æ¨¡å‹æœåŠ¡ï¼šç°åº¦æµ‹è¯•" title="Direct link to heading">#</a></h2><p>é™¤äº†ç›´æ¥å¯åŠ¨æ¨¡å‹æœåŠ¡ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åœ¨ä¸€ä¸ªæ¨¡å‹æœåŠ¡ä¸­ä½¿ç”¨å¤šä¸ªç‰ˆæœ¬çš„æ¨¡å‹ï¼Œå¹¶å¯¹å…¶åˆ†é…ä¸åŒçš„æµé‡ä»¥è¿›è¡Œç°åº¦æµ‹è¯•ã€‚</p><p>éƒ¨ç½²å¦‚ä¸‹ YAMLï¼Œå¯ä»¥çœ‹åˆ°ï¼Œv1 ç‰ˆæœ¬çš„æ¨¡å‹å’Œ v2 ç‰ˆæœ¬çš„æ¨¡å‹éƒ½è®¾ç½®ä¸ºäº† 50% çš„æµé‡ã€‚åŒæ ·ï¼Œæˆ‘ä»¬åœ¨æ¨¡å‹æœåŠ¡åé¢éƒ¨ç½²ä¸€ä¸ªæµ‹è¯•æœåŠ¡ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> core.oam.dev/v1beta1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Application</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> color</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">serving</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> default</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">components</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> color</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">serving</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">serving</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">protocol</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> tensorflow</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">predictors</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> model1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">replicas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token comment" style="color:rgb(98, 114, 164)"># v1 ç‰ˆæœ¬çš„æ¨¡å‹æµé‡ä¸º 50</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">traffic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">50</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">graph</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">model</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">implementation</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> tensorflow</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token comment" style="color:rgb(98, 114, 164)"># æ¨¡å‹åœ°å€ï¼Œåœ¨ color-model è¿™ä¸ª pvc ä¸­ /model/v1 è·¯å¾„ä¸‹å­˜æ”¾äº†æˆ‘ä»¬çš„ v1 ç‰ˆæœ¬æ¨¡å‹ï¼Œæ‰€ä»¥é€šè¿‡ pvc://color-model/model/v1 æŒ‡å®šæ¨¡å‹çš„åœ°å€</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">modelUri</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> pvc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">//color</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">model/model/v1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> model2</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">replicas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token comment" style="color:rgb(98, 114, 164)"># v2 ç‰ˆæœ¬çš„æ¨¡å‹æµé‡ä¸º 50</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">traffic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">50</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">graph</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">model</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">implementation</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> tensorflow</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token comment" style="color:rgb(98, 114, 164)"># æ¨¡å‹åœ°å€ï¼Œåœ¨ color-model è¿™ä¸ª pvc ä¸­ /model/v2 è·¯å¾„ä¸‹å­˜æ”¾äº†æˆ‘ä»¬çš„ v2 ç‰ˆæœ¬æ¨¡å‹ï¼Œæ‰€ä»¥é€šè¿‡ pvc://color-model/model/v2 æŒ‡å®šæ¨¡å‹çš„åœ°å€</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">modelUri</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> pvc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">//color</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">model/model/v2</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> color</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">rest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">serving</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> webservice</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">dependsOn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> color</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">serving</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> fogdong/color</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">serving</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">v1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">exposeType</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> LoadBalancer</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">env</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> URL</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">//ambassador.vela</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">system.svc.cluster.local/seldon/default/color</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">serving/v1/models/my</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">predict</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">3333</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">expose</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean important">true</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>å½“æ¨¡å‹éƒ¨ç½²å®Œæˆåï¼Œé€šè¿‡ <code>vela status &lt;app-name&gt; --endpoint</code> æŸ¥çœ‹æ¨¡å‹æœåŠ¡çš„åœ°å€ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ vela status color-serving --endpoint</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">+---------+------------------------------------+----------------------------------------------------------+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain"> CLUSTER </span><span class="token operator">|</span><span class="token plain">      REF</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">KIND/NAMESPACE/NAME</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain">                         ENDPOINT                         </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">+---------+------------------------------------+----------------------------------------------------------+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain">         </span><span class="token operator">|</span><span class="token plain"> Service/vela-system/ambassador     </span><span class="token operator">|</span><span class="token plain"> http://47.251.36.228/seldon/default/color-model-serving  </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain">         </span><span class="token operator">|</span><span class="token plain"> Service/vela-system/ambassador     </span><span class="token operator">|</span><span class="token plain"> https://47.251.36.228/seldon/default/color-model-serving </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain">         </span><span class="token operator">|</span><span class="token plain"> Service/default/color-rest-serving </span><span class="token operator">|</span><span class="token plain"> tcp://47.89.194.94:3333                                  </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">+---------+------------------------------------+----------------------------------------------------------+</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ä½¿ç”¨ä¸€å¼ é»‘ç™½çš„åŸå¸‚å›¾ç‰‡è¯·æ±‚æ¨¡å‹ï¼š</p><p><img alt="alt" src="/zh/assets/images/chicago-grey-9beb20b9876bfbb19f12ccb570ad3e77.png"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œç¬¬ä¸€æ¬¡è¯·æ±‚çš„ç»“æœå¦‚ä¸‹ã€‚è™½ç„¶å¤©ç©ºå’Œåœ°é¢éƒ½è¢«æ¸²æŸ“æˆå½©è‰²äº†ï¼Œä½†æ˜¯åŸå¸‚æœ¬èº«è¿˜æ˜¯é»‘ç™½çš„ï¼š</p><p><img alt="alt" src="/zh/assets/images/canary-request1-de4f9f1c4f81b200f2827e5277e8bc60.png"></p><p>å†æ¬¡è¯·æ±‚ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œè¿™æ¬¡è¯·æ±‚çš„ç»“æœä¸­ï¼Œå¤©ç©ºã€åœ°é¢å’ŒåŸå¸‚éƒ½è¢«æ¸²æŸ“æˆäº†å½©è‰²ï¼š</p><p><img alt="alt" src="/zh/assets/images/canary-request2-1ce63a83354786cb7e9f56891002771a.png"></p><p>é€šè¿‡å¯¹ä¸åŒç‰ˆæœ¬çš„æ¨¡å‹è¿›è¡Œæµé‡åˆ†å‘ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°å¯¹æ¨¡å‹ç»“æœè¿›è¡Œåˆ¤æ–­ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ¨¡å‹æœåŠ¡ï¼šab-æµ‹è¯•"></a>æ¨¡å‹æœåŠ¡ï¼šA/B æµ‹è¯•<a class="hash-link" href="#æ¨¡å‹æœåŠ¡ï¼šab-æµ‹è¯•" title="Direct link to heading">#</a></h2><p>åŒæ ·ä¸€å¼ é»‘ç™½çš„å›¾ç‰‡ï¼Œæˆ‘ä»¬æ—¢å¯ä»¥é€šè¿‡æ¨¡å‹å°†å…¶å˜æˆå½©è‰²çš„ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä¸Šä¼ å¦ä¸€å¼ é£æ ¼å›¾ç‰‡ï¼Œå¯¹åŸå›¾è¿›è¡Œé£æ ¼è¿ç§»ã€‚</p><p>å¯¹äºç”¨æˆ·æ¥è¯´ï¼Œç©¶ç«Ÿæ˜¯å½©è‰²çš„å›¾ç‰‡å¥½è¿˜æ˜¯ä¸åŒé£æ ¼çš„å›¾ç‰‡æ›´èƒœä¸€ç­¹ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿›è¡Œ A/B æµ‹è¯•ï¼Œæ¥æ¢ç´¢è¿™ä¸ªé—®é¢˜ã€‚</p><p>éƒ¨ç½²å¦‚ä¸‹ YAMLï¼Œé€šè¿‡è®¾ç½® <code>customRouting</code>ï¼Œå°† <code>Header</code> ä¸­å¸¦æœ‰ <code>style: transfer</code> çš„è¯·æ±‚ï¼Œè½¬å‘åˆ°é£æ ¼è¿ç§»çš„æ¨¡å‹ã€‚åŒæ—¶ï¼Œä½¿è¿™ä¸ªé£æ ¼è¿ç§»çš„æ¨¡å‹ä¸å½©è‰²åŒ–çš„æ¨¡å‹å…±ç”¨ä¸€ä¸ªåœ°å€ã€‚</p><blockquote><p>æ³¨ï¼šé£æ ¼è¿ç§»çš„æ¨¡å‹æ¥æºäº <a href="https://tfhub.dev/google/magenta/arbitrary-image-stylization-v1-256/2" target="_blank" rel="noopener noreferrer">TensorFlow Hub</a></p></blockquote><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> core.oam.dev/v1beta1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Application</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> color</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">style</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">ab</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">serving</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> default</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">components</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> color</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">ab</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">serving</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">serving</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">protocol</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> tensorflow</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">predictors</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> model1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">replicas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">graph</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">model</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">implementation</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> tensorflow</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">modelUri</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> pvc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">//color</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">model/model/v2</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> style</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">ab</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">serving</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">serving</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">protocol</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> tensorflow</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># é£æ ¼è¿ç§»çš„æ¨¡å‹éœ€è¦çš„æ—¶é—´è¾ƒé•¿ï¼Œè®¾ç½®è¶…æ—¶æ—¶é—´ä½¿è¯·æ±‚ä¸ä¼šè¢«è¶…æ—¶</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">timeout</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;10000&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">customRouting</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)"># æŒ‡å®šè‡ªå®šä¹‰ Header</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">header</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;style: transfer&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)"># æŒ‡å®šè‡ªå®šä¹‰è·¯ç”±</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">serviceName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;color-ab-serving&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">predictors</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> model2</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">replicas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">graph</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">model</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">implementation</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> tensorflow</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">modelUri</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> pvc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">//style</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">model/model</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ab</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">rest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">serving</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> webservice</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">dependsOn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> color</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">ab</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">serving</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> style</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">ab</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">serving</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> fogdong/style</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">serving</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">v1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">exposeType</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> LoadBalancer</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">env</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> URL</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">//ambassador.vela</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">system.svc.cluster.local/seldon/default/color</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">ab</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">serving/v1/models/my</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">predict</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">3333</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">expose</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean important">true</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>éƒ¨ç½²æˆåŠŸåï¼Œé€šè¿‡ <code>vela status &lt;app-name&gt; --endpoint</code> æŸ¥çœ‹æ¨¡å‹æœåŠ¡çš„åœ°å€ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ vela status color-style-ab-serving --endpoint</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">+---------+---------------------------------+-------------------------------------------------------+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain"> CLUSTER </span><span class="token operator">|</span><span class="token plain">    REF</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">KIND/NAMESPACE/NAME</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">     </span><span class="token operator">|</span><span class="token plain">                       ENDPOINT                        </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">+---------+---------------------------------+-------------------------------------------------------+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain">         </span><span class="token operator">|</span><span class="token plain"> Service/vela-system/ambassador  </span><span class="token operator">|</span><span class="token plain"> http://47.251.36.228/seldon/default/color-ab-serving  </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain">         </span><span class="token operator">|</span><span class="token plain"> Service/vela-system/ambassador  </span><span class="token operator">|</span><span class="token plain"> https://47.251.36.228/seldon/default/color-ab-serving </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain">         </span><span class="token operator">|</span><span class="token plain"> Service/vela-system/ambassador  </span><span class="token operator">|</span><span class="token plain"> http://47.251.36.228/seldon/default/style-ab-serving  </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain">         </span><span class="token operator">|</span><span class="token plain"> Service/vela-system/ambassador  </span><span class="token operator">|</span><span class="token plain"> https://47.251.36.228/seldon/default/style-ab-serving </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain">         </span><span class="token operator">|</span><span class="token plain"> Service/default/ab-rest-serving </span><span class="token operator">|</span><span class="token plain"> tcp://47.251.5.97:3333                                </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">+---------+---------------------------------+-------------------------------------------------------+</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>è¿™ä¸ªåº”ç”¨ä¸­ï¼Œä¸¤ä¸ªæœåŠ¡å„è‡ªæœ‰ä¸¤ä¸ªåœ°å€ï¼Œä½†æ˜¯ç¬¬äºŒä¸ª <code>style-ab-serving</code> çš„æ¨¡å‹æœåŠ¡åœ°å€æ˜¯æ— æ•ˆçš„ï¼Œå› ä¸ºè¿™ä¸ªæ¨¡å‹æœåŠ¡å·²ç»è¢«æŒ‡å‘äº† <code>color-ab-serving</code> çš„åœ°å€ä¸­ã€‚åŒæ ·ï¼Œæˆ‘ä»¬é€šè¿‡è¯·æ±‚æµ‹è¯•æœåŠ¡æ¥æŸ¥çœ‹æ¨¡å‹æ•ˆæœã€‚</p><p>é¦–å…ˆï¼Œåœ¨ä¸åŠ  header çš„æƒ…å†µä¸‹ï¼Œå›¾åƒä¼šä»é»‘ç™½å˜ä¸ºå½©è‰²ï¼š</p><p><img alt="alt" src="/zh/assets/images/ab-request1-05b112438a860a7e590f9922add14c46.png"></p><p>æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªæµ·æµªçš„å›¾ç‰‡ä½œä¸ºé£æ ¼æ¸²æŸ“ï¼š</p><p><img alt="alt" src="/zh/assets/images/wave-25ac6d548667b746e5349d29e39b915e.jpg"></p><p>æˆ‘ä»¬ä¸ºæœ¬æ¬¡è¯·æ±‚åŠ ä¸Š <code>style: transfer</code> çš„ Headerï¼Œå¯ä»¥çœ‹åˆ°ï¼ŒåŸå¸‚å˜æˆäº†æµ·æµªé£æ ¼ï¼š</p><p><img alt="alt" src="/zh/assets/images/ab-request2-9eb2e8760112fe66bcaf742fb97d4248.png"></p><p>æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ä¸€å¼ æ°´å¢¨ç”»çš„å›¾ç‰‡ä½œä¸ºé£æ ¼æ¸²æŸ“ï¼š</p><p><img alt="alt" src="/zh/assets/images/chinese-style-e6c8e27f2f4d33f707a58d3f274bde7a.jpg"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ¬¡åŸå¸‚å˜æˆäº†æ°´å¢¨ç”»é£æ ¼ï¼š</p><p><img alt="alt" src="/zh/assets/images/ab-request3-09e8be352e5bef4a239b1ab2bfa211da.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ€»ç»“"></a>æ€»ç»“<a class="hash-link" href="#æ€»ç»“" title="Direct link to heading">#</a></h2><p>é€šè¿‡ KubeVela çš„ AI æ’ä»¶ï¼Œå¯ä»¥å¸®åŠ©ä½ æ›´ä¾¿æ·åœ°è¿›è¡Œæ¨¡å‹è®­ç»ƒä¸æ¨¡å‹æœåŠ¡ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œé€šè¿‡ä¸ KubeVela çš„ç»“åˆï¼Œæˆ‘ä»¬è¿˜èƒ½å°†æµ‹è¯•å®Œæ•ˆæœçš„æ¨¡å‹é€šè¿‡ KubeVela çš„å¤šç¯å¢ƒåŠŸèƒ½ï¼Œä¸‹å‘åˆ°ä¸åŒçš„ç¯å¢ƒä¸­ï¼Œä»è€Œå®ç°æ¨¡å‹çš„çµæ´»éƒ¨ç½²ã€‚</p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/zh/blog/tags/kube-vela">KubeVela</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/zh/blog/2022/03/01/kubevela-generate-top-50-popular-resources-of-aws-using-100-lines-of-code">å¦‚ä½•ç”¨ 100 è¡Œä»£ç å¿«é€Ÿå¼•å…¥ AWS æœ€å—æ¬¢è¿çš„ 50 ç§äº‘èµ„æº</a></h2><div class="margin-vert--md"><time datetime="2022-03-01T00:00:00.000Z" class="blogPostDate_fNvV">2022å¹´3æœˆ1æ—¥ Â· é˜…è¯»éœ€è¦ 1 åˆ†é’Ÿ</time></div><div class="avatar margin-vert--md"><a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://kubevela.io/img/logo.svg" alt="Avery Qiï¼ˆåŒæµå¤§å­¦ï¼‰ å‘¨æ­£å–œï¼ˆé˜¿é‡Œäº‘)"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer">Avery Qiï¼ˆåŒæµå¤§å­¦ï¼‰ å‘¨æ­£å–œï¼ˆé˜¿é‡Œäº‘)</a></h4><small class="avatar__subtitle">KubeVela Team</small></div></div></header><div class="markdown"><p>KubeVela ç›®å‰å·²ç»æ”¯æŒäº† AWSã€Azureã€GCPã€é˜¿é‡Œäº‘ã€è…¾è®¯äº‘ã€ç™¾åº¦äº‘ã€UCloud ç­‰äº‘å‚å•†ï¼Œä¹Ÿæä¾›äº†<a href="https://kubevela.io/docs/next/platform-engineers/components/component-terraform" target="_blank" rel="noopener noreferrer">ç®€å•å¿«æ·çš„å‘½ä»¤è¡Œå·¥å…·</a>å¼•å…¥äº‘æœåŠ¡å•†çš„äº‘èµ„æºï¼Œä½†æ˜¯åœ¨ KubeVela é‡Œä¸€ä¸ªä¸€ä¸ªåœ°æ”¯æŒäº‘æœåŠ¡å•†çš„äº‘èµ„æºä¸åˆ©äºå¿«é€Ÿæ»¡è¶³ç”¨æˆ·å¯¹äºäº‘èµ„æºçš„éœ€æ±‚ï¼Œæœ¬æ–‡æä¾›äº†ä¸€ä¸ªæ–¹æ¡ˆï¼Œç”¨ä¸åˆ° 100 è¡Œä»£ç å¿«é€Ÿå¼•å…¥ AWS å‰ 50 æœ€å—æ¬¢è¿çš„äº‘èµ„æºã€‚</p><p>åŒæ—¶ï¼Œæˆ‘ä»¬ä¹ŸæœŸæœ›ç”¨æˆ·å—åˆ°æœ¬æ–‡çš„å¯å‘ï¼Œè´¡çŒ®å…¶ä»–äº‘æœåŠ¡å•†çš„äº‘èµ„æºã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="aws-æœ€å—æ¬¢è¿çš„äº‘èµ„æºåœ¨å“ªé‡Œï¼Ÿ"></a>AWS æœ€å—æ¬¢è¿çš„äº‘èµ„æºåœ¨å“ªé‡Œï¼Ÿ<a class="hash-link" href="#aws-æœ€å—æ¬¢è¿çš„äº‘èµ„æºåœ¨å“ªé‡Œï¼Ÿ" title="Direct link to heading">#</a></h2><p>Terraform å®˜ç½‘æä¾›äº†å„ä¸ªäº‘æœåŠ¡å•†çš„ Terraform modulesï¼Œæ¯”å¦‚ <a href="https://registry.terraform.io/namespaces/terraform-aws-modules" target="_blank" rel="noopener noreferrer">AWS çš„äº‘èµ„æº Terraform modules</a>ã€‚å…¶ä¸­ï¼Œäº‘èµ„æºæŒ‰ç…§å—æ¬¢è¿çš„ä½¿ç”¨ç¨‹åº¦ï¼ˆä¸‹è½½é‡ï¼‰æ’åºï¼Œæ¯”å¦‚ AWS VPC ä¸‹è½½é‡ä¸º 1870 ä¸‡æ¬¡ã€‚</p><p>é€šè¿‡ç®€å•åˆ†æï¼Œæˆ‘ä»¬å‘ç° AWS å‰ 50 Terraform modules çš„æ•°æ®å¯ä»¥é€šè¿‡è¯·æ±‚ <a href="https://registry.terraform.io/v2/modules?filter%5Bprovider%5D=aws&amp;include=latest-version&amp;page%5Bsize%5D=50&amp;page%5Bnumber%5D=1" target="_blank" rel="noopener noreferrer">https://registry.terraform.io/v2/modules?filter%5Bprovider%5D=aws&amp;include=latest-version&amp;page%5Bsize%5D=50&amp;page%5Bnumber%5D=1</a> è·å–ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å¼€å§‹ä¹‹å‰"></a>å¼€å§‹ä¹‹å‰<a class="hash-link" href="#å¼€å§‹ä¹‹å‰" title="Direct link to heading">#</a></h2><p>ä»£ç æ¥å—ä¸¤ä¸ªç”¨æˆ·ä¼ å…¥å‚æ•°ï¼š</p><ul><li>provider çš„åç§°</li><li>è¯¥ provider å¯¹åº”çš„ Terraform Modules çš„ URL</li></ul><p>å¯¹äº AWS æ¥è¯´ï¼ŒProvideråç§°ä¸º â€œawsâ€ï¼Œå¯¹åº”çš„ Terraform modulesä¸º<a href="https://registry.terraform.io/v2/modules?filter%5Bprovider%5D=aws&amp;include=latest-version&amp;page%5Bsize%5D=50&amp;page%5Bnumber%5D=1" target="_blank" rel="noopener noreferrer">Terraform Modules jsonæ ¼å¼æ¥å£</a>ï¼ˆå³åœ¨<a href="https://registry.terraform.io/" target="_blank" rel="noopener noreferrer">Terraform Registry</a>ä¸­æœç´¢providerä¸ºawsæ—¶æœ€å—æ¬¢è¿çš„50ç§äº‘èµ„æºï¼‰ã€‚</p><p>åœ¨æ‰§è¡Œä»£ç ä¹‹å‰éœ€è¦ç¡®è®¤providerName(aws)å’ŒModulesé“¾æ¥æ— è¯¯ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ‰§è¡Œä»£ç "></a>æ‰§è¡Œä»£ç <a class="hash-link" href="#æ‰§è¡Œä»£ç " title="Direct link to heading">#</a></h2><p>é‚£ä¹ˆä½ å°±å¯ä»¥é€šè¿‡ä»¥ä¸‹ 100 è¡Œå·¦å³çš„ä»£ç ï¼ˆæ–‡ä»¶å gen.goï¼‰æ¥æ‰¹é‡åœ°å¿«é€Ÿå¼•å…¥ AWS æœ€å—æ¬¢è¿çš„å‰ 50 ç§äº‘èµ„æºã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">import (</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  &quot;encoding/json&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  &quot;fmt&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  &quot;io&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  &quot;log&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  &quot;net/http&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  &quot;os&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  &quot;os/exec&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  &quot;path/filepath&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  &quot;strings&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  &quot;github.com/pkg/errors&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">type TFDownload struct {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Data     []DataItem     `json:&quot;data&quot;`</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Included []IncludedItem `json:&quot;included&quot;`</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">type IncludedItem struct {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Id         string     `json:&quot;id&quot;`</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Attributes Attributes `json:&quot;attributes&quot;`</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">type DataItem struct {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Attributes    Attributes    `json:&quot;attributes&quot;`</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Relationships Relationships `json:&quot;relationships&quot;`</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">type Relationships struct {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  LatestVersion RelationshipLatestVersion `json:&quot;latest-version&quot;`</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">type RelationshipLatestVersion struct {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Data RelationshipData `json:&quot;data&quot;`</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">type RelationshipData struct {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Id string `json:&quot;id&quot;`</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">var errNoVariables = errors.New(&quot;failed to find main.tf or variables.tf in Terraform configurations&quot;)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">type Attributes struct {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Name        string `json:&quot;name&quot;`</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Downloads   int    `json:&quot;downloads&quot;`</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Source      string `json:&quot;source&quot;`</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Description string `json:&quot;description&quot;`</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Verified    bool   `json:&quot;verified&quot;`</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">func main() {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  if len(os.Args) &lt; 2 {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     fmt.Println(&quot;Please provide the cloud provider name and an official Terraform modules URL&quot;)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     os.Exit(1)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  providerName := os.Args[1]</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  terraformModulesUrl := os.Args[2]</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  resp, err := http.Get(terraformModulesUrl)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  if err != nil {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     log.Fatal(err)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  defer resp.Body.Close()</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  body, err := io.ReadAll(resp.Body)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  if err != nil {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     log.Fatal(err)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  var modules TFDownload</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  if err := json.Unmarshal(body, &amp;modules); err != nil {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     fmt.Println(err.Error())</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     os.Exit(1)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  if _, err = os.Stat(providerName); err == nil {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     if err := os.RemoveAll(providerName); err != nil {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        log.Fatal(err)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     fmt.Printf(&quot;Successfully deleted existed directory %s\n&quot;, providerName)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  if _, err = os.Stat(providerName); os.IsNotExist(err) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     if err := os.Mkdir(providerName, 0755); err != nil {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        if !os.IsExist(err) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">           log.Fatal(err)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        fmt.Printf(&quot;Successfully created directory %s\n&quot;, providerName)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  for _, module := range modules.Data {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     var description string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     for _, attr := range modules.Included {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        if module.Relationships.LatestVersion.Data.Id == attr.Id {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">           description = attr.Attributes.Description</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     if description == &quot;&quot; {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        description = strings.ToUpper(providerName) + &quot; &quot; + strings.Title(module.Attributes.Name)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     outputFile := fmt.Sprintf(&quot;%s/terraform-%s-%s.yaml&quot;, providerName, providerName, module.Attributes.Name)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     if _, err := os.Stat(outputFile); !os.IsNotExist(err) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        continue</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     if providerName == &quot;aws&quot; &amp;&amp; (module.Attributes.Name == &quot;rds&quot; || module.Attributes.Name == &quot;s3-bucket&quot; ||</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        module.Attributes.Name == &quot;subnet&quot; || module.Attributes.Name == &quot;vpc&quot;) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        continue</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     if err := generateDefinition(providerName, module.Attributes.Name, module.Attributes.Source, &quot;&quot;, description); err != nil {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        fmt.Println(err.Error())</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        os.Exit(1)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">func generateDefinition(provider, name, gitURL, path, description string) error {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  defYaml := filepath.Join(provider, fmt.Sprintf(&quot;terraform-%s-%s.yaml&quot;, provider, name))</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  cmd := fmt.Sprintf(&quot;vela def init %s --type component --provider %s --git %s.git --desc \&quot;%s\&quot; -o %s&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     name, provider, gitURL, description, defYaml)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  if path != &quot;&quot; {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     cmd = fmt.Sprintf(&quot;%s --path %s&quot;, cmd, path)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  fmt.Println(cmd)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  stdout, err := exec.Command(&quot;bash&quot;, &quot;-c&quot;, cmd).CombinedOutput()</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  if err != nil {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     return errors.Wrap(err, string(stdout))</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  fmt.Println(string(stdout))</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  return nil</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æ‰§è¡Œå‘½ä»¤ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">go run gen.go aws &quot;https://registry.terraform.io/v2/modules?filter%5Bprovider%5D=aws&amp;include=latest-version&amp;page%5Bsize%5D=50&amp;page%5Bnumber%5D=1&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ä»£ç ç®€è¦è¯´æ˜"></a>ä»£ç ç®€è¦è¯´æ˜<a class="hash-link" href="#ä»£ç ç®€è¦è¯´æ˜" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="è§£æäº‘èµ„æºæ•°æ®"></a>è§£æäº‘èµ„æºæ•°æ®<a class="hash-link" href="#è§£æäº‘èµ„æºæ•°æ®" title="Direct link to heading">#</a></h3><p>è®¿é—®ç”¨æˆ·ä¼ å…¥çš„URLï¼Œå°†è¿”å›çš„jsonæ•°æ®è§£æä¸ºGoä¸­çš„ç»“æ„ä½“ã€‚</p><p>èµ„æºå¯¹åº”çš„jsonæ ¼å¼å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">{</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  &quot;data&quot;: [</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;type&quot;: &quot;modules&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;id&quot;: &quot;23&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;attributes&quot;: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;downloads&quot;: 18440513,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;full-name&quot;: &quot;terraform-aws-modules/vpc/aws&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;name&quot;: &quot;vpc&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;namespace&quot;: &quot;terraform-aws-modules&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;owner-name&quot;: &quot;&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;provider-logo-url&quot;: &quot;/images/providers/aws.png&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;provider-name&quot;: &quot;aws&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;source&quot;: &quot;https://github.com/terraform-aws-modules/terraform-aws-vpc&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;verified&quot;: true</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      },</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;relationships&quot;: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;latest-version&quot;: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;data&quot;: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            &quot;id&quot;: &quot;142143&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            &quot;type&quot;: &quot;module-versions&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      },</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;links&quot;: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;self&quot;: &quot;/v2/modules/23&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    },</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    ...</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  ],</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  &quot;included&quot;: [</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;type&quot;: &quot;module-versions&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;id&quot;: &quot;36806&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;attributes&quot;: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;created-at&quot;: &quot;2020-01-03T11:35:36Z&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;description&quot;: &quot;Terraform module Terraform module for creating AWS IAM Roles with heredocs&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;downloads&quot;: 260030,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;published-at&quot;: &quot;2020-02-06T06:26:08Z&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;source&quot;: &quot;&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;tag&quot;: &quot;v2.0.0&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;updated-at&quot;: &quot;2022-02-22T00:45:44Z&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;version&quot;: &quot;2.0.0&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      },</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;links&quot;: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;self&quot;: &quot;/v2/module-versions/36806&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    },</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    ...</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  ],</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  ...</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>åœ¨Moduleså¯¹åº”çš„jsonæ•°æ®ä¸­ï¼Œæˆ‘ä»¬åªå…³å¿ƒä¸¤ä¸ªé”®å€¼å¯¹ï¼Œå³ï¼š</p><ul><li>dataï¼šåŒ…å«Modulesåç§°åŠå±æ€§çš„åˆ—è¡¨</li><li>Includedï¼šç­›é€‰å‡ºçš„ç‰¹å®šç‰ˆæœ¬çš„Moduleså…·ä½“ä¿¡æ¯</li></ul><p>å…¶ä¸­ï¼Œå¯¹äºdataä¸­çš„æ¯ä¸ªModuleå…ƒç´ ï¼Œè§£æå®ƒçš„å±æ€§ï¼ŒIdå’Œrelationshipä¸­çš„latest-versionå¯¹åº”çš„idï¼›å¯¹äºIncludedä¸­çš„æ¯ä¸ªModuleç‰ˆæœ¬å…ƒç´ ï¼Œè§£æå®ƒçš„å±æ€§å’ŒIdã€‚</p><p>å±æ€§åˆè§£æå¦‚ä¸‹äº”é¡¹ï¼š</p><ul><li>Name</li><li>Downloads</li><li>Source</li><li>Description</li><li>Verified</li></ul><p>ç»“æ„ä½“å®šä¹‰åœ¨ç»“æ„ä½“ <code>TFDownload </code>ä¸­ï¼Œé€šè¿‡ http åº“è·å– json æ•°æ®ï¼Œå†é€šè¿‡ <code>json.Unmarshal</code> è§£æå‡º Terraform modules çš„ç»“æ„ä½“ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ‰¹é‡ç”Ÿæˆäº‘èµ„æº"></a>æ‰¹é‡ç”Ÿæˆäº‘èµ„æº<a class="hash-link" href="#æ‰¹é‡ç”Ÿæˆäº‘èµ„æº" title="Direct link to heading">#</a></h3><ol><li>æ–°å»ºç›®å½•ï¼Œç”Ÿæˆèµ„æºæ‰€éœ€æ–‡ä»¶</li></ol><p>è§£æå®Œæ¯•åï¼Œåœ¨å½“å‰ç›®å½•ä¸‹æ–°å»ºæ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶å¤¹å‘½åä¸ºprovideråç§°ã€‚</p><p>éå†è§£æåçš„dataï¼Œå¯¹äºå…¶ä¸­æ¯ä¸ªModuleå…ƒç´ ï¼Œæ‰§è¡Œä¸‹è¿°æ“ä½œï¼Œä¸ºå…¶ç”Ÿæˆç›¸åº”é…ç½®æ–‡ä»¶ï¼Œå®šä¹‰å’Œç›¸åº”æ–‡æ¡£ã€‚</p><ol start="2"><li>ç”Ÿæˆå®šä¹‰æ–‡ä»¶</li></ol><p>é€šè¿‡ä¸‹è¿° vela æŒ‡ä»¤ä»æ¨¡å—å¯¹åº”çš„githubä»“åº“è¯»å–ç›¸åº”ä¿¡æ¯ç”Ÿæˆå®šä¹‰æ–‡ä»¶ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">vela def init {ModuleName} --type component --provider {providerName} --git {gitURL} --desc {description} -o {yamlFileName}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æŒ‡ä»¤ä¸­éœ€è¦å¡«å…¥çš„å‡ é¡¹ç”±è§£æå¥½çš„Moduleç»“æ„ä½“ä¼ å…¥ã€‚</p><ul><li>gitURL: 	{Module.Attributes.Source}.git</li><li>description:	å¦‚æœIncludedä¸­å­˜åœ¨å…ƒç´ IDä¸æ¨¡å—relationshipä¸­latest-versionå¯¹åº”IDç›¸åŒï¼Œåˆ™descriptionä¸ºIncludedä¸­å¯¹åº”å…ƒç´ å±æ€§çš„description;å¦åˆ™descriptionä¸ºproviderNameä¸æ¨¡å—åç§°çš„æ‹¼æ¥</li><li>yamlFileNameï¼šterraform-{providerName}-{Module.Attributes.Name}.yaml</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ä½ ä¹Ÿæ¥è¯•è¯•ï¼Ÿ"></a>ä½ ä¹Ÿæ¥è¯•è¯•ï¼Ÿ<a class="hash-link" href="#ä½ ä¹Ÿæ¥è¯•è¯•ï¼Ÿ" title="Direct link to heading">#</a></h2><p>è¿˜æœ‰ä¸å°‘äº‘æœåŠ¡å•†ä¹Ÿæä¾›äº†ä¸°å¯Œçš„ Terraform modulesï¼Œæ¯”å¦‚</p><p>GCPï¼š<a href="https://registry.terraform.io/namespaces/terraform-google-modules" target="_blank" rel="noopener noreferrer">https://registry.terraform.io/namespaces/terraform-google-modules</a></p><p>é˜¿é‡Œäº‘ï¼š<a href="https://registry.terraform.io/namespaces/terraform-alicloud-modules" target="_blank" rel="noopener noreferrer">https://registry.terraform.io/namespaces/terraform-alicloud-modules</a></p><p>ä½ è¦ä¸è¦ä¹Ÿä¸º KubeVela å¼•å…¥ä½ æ­£åœ¨ä½¿ç”¨çš„ã€æˆ–å–œæ¬¢çš„äº‘æœåŠ¡å•†çš„äº‘èµ„æºï¼Ÿ</p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/zh/blog/tags/terraform">Terraform</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/zh/blog/2022/01/27/blog-1.2">KubeVela v1.2 å‘å¸ƒï¼šèšç„¦å¼€å‘è€…ä½“éªŒï¼Œè½»æ¾å‘å¸ƒä½ çš„å¤šé›†ç¾¤åº”ç”¨</a></h2><div class="margin-vert--md"><time datetime="2022-01-27T00:00:00.000Z" class="blogPostDate_fNvV">2022å¹´1æœˆ27æ—¥ Â· é˜…è¯»éœ€è¦ 1 åˆ†é’Ÿ</time></div><div class="avatar margin-vert--md"><a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://kubevela.io/img/logo.svg" alt="KubeVela Maintainers"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer">KubeVela Maintainers</a></h4><small class="avatar__subtitle">KubeVela Team</small></div></div></header><div class="markdown"><p>éšç€äº‘åŸç”Ÿçš„ä¸æ–­å‘å±•å’Œæˆç†Ÿï¼Œè¶Šæ¥è¶Šå¤šçš„åŸºç¡€è®¾æ–½èƒ½åŠ›é€æ¸æ ‡å‡†åŒ–æˆä¸º PaaS å¹³å°æˆ–è€… SaaS åŒ–äº§å“ã€‚ä¸€ä¸ªäº§å“çš„è¯ç”Ÿä¸å†åƒè¿‡å»é‚£æ ·éœ€è¦å»ºç«‹ä¸€ä¸ªå›¢é˜Ÿï¼Œä»å¼€å‘ã€æµ‹è¯•ä¸€ç›´åˆ°è¿ç»´ã€åŸºç¡€è®¾æ–½å…¨éƒ¨åˆ†å¤šç§è§’è‰²ç³»ç»Ÿå®Œæˆã€‚å¦‚ä»Šï¼Œæ•æ·ç»„ç»‡æ–‡åŒ–å’Œäº‘åŸç”ŸæŠ€æœ¯é©±åŠ¨ï¼Œä½¿å¾—è¿™äº›èŒè´£æ›´å¤šçš„æ˜¯â€œå·¦ç§»â€åˆ°äº†å¼€å‘è€…èº«ä¸Šï¼Œæµ‹è¯•å·¦ç§»ã€ç›‘æ§å·¦ç§»ã€å®‰å…¨å·¦ç§»ï¼Œä»¥åŠ DevOps ç­‰ä¸€ç³»åˆ—ç†å¿µéƒ½æ˜¯åœ¨å¼ºè°ƒï¼Œé€šè¿‡å¼€æºé¡¹ç›®æˆ–è€…äº‘çš„äº§å“å’ŒæœåŠ¡å°†æµ‹è¯•ã€ç›‘æ§ã€å®‰å…¨ã€è¿ç»´ç­‰ä¸€ç³»åˆ—äº‹åŠ¡æå‰åˆ°å¼€å‘é˜¶æ®µå®Œæˆã€‚è¿™çœ‹ä¼¼ç¾å¥½çš„æ„¿æ™¯å´ç»™å¼€å‘è€…å¸¦æ¥äº†å·¨å¤§çš„æŒ‘æˆ˜ï¼Œå¼€å‘è€…å¯¹åº•å±‚äº”èŠ±å…«é—¨çš„äº§å“å’Œå¤æ‚ API ç¼ºä¹æŒæ§åŠ›ï¼Œä»–ä»¬ä¸ä»…ä»…æ˜¯åœ¨åšé€‰æ‹©ï¼Œæ›´å¤šçš„éœ€è¦å»ç†è§£å’Œåè°ƒåº•å±‚å¤æ‚å¼‚æ„çš„åŸºç¡€è®¾æ–½èƒ½åŠ›ï¼Œä»¥ä¾¿æ»¡è¶³ä¸Šå±‚ä¸šåŠ¡çš„å¿«é€Ÿå‘å±•å’Œè¿­ä»£éœ€æ±‚ã€‚</p><p>è¿™ç§å¤æ‚æ€§å’Œä¸ç¡®å®šæ€§æ— ç–‘å¤§å¤§é™ä½äº†å¼€å‘è€…çš„ä½“éªŒï¼Œé™ä½äº†ä¸šåŠ¡ç³»ç»Ÿçš„äº¤ä»˜æ•ˆç‡ï¼Œå¢åŠ äº†è¿ç»´é£é™©ã€‚å¼€å‘è€…ä½“éªŒçš„æ ¸å¿ƒæ˜¯â€œç®€å•â€å’Œâ€œé«˜æ•ˆç‡â€ï¼Œä¸ç®¡æ˜¯å¼€å‘è€…è¿˜æ˜¯ä¼ä¸šéƒ½éœ€è¦æ›´å¥½ç”¨çš„å¼€å‘è€…å·¥å…·æˆ–è€…å¹³å°æ¥è¾¾æˆã€‚åœ¨ç°ä»£äº‘åŸç”ŸæŠ€æœ¯ä¹‹ä¸Šæ‰“é€ ä¸€æ¬¾å¸®åŠ©å¼€å‘è€…ä»å¼€å‘ã€äº¤ä»˜ä»¥åŠåç»­æŒç»­è¿ç»´çš„ä¸€ä½“åŒ–å¹³å°ï¼Œä¸€ç›´æ˜¯ KubeVela æ¼”è¿›çš„æ ¸å¿ƒç›®æ ‡ã€‚å¦‚å›¾ 1 æ‰€ç¤ºï¼Œåœ¨ v1.2 ç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬å›´ç»•å¼€å‘è€…ä½“éªŒæ–°å¢äº† UI æ§åˆ¶å°ç»„ä»¶ï¼ˆVelaUXï¼‰ï¼Œç®€åŒ–äº†ç¼–æ’ YAML çš„å¤æ‚æ€§ï¼Œå®Œå–„äº†æ’ä»¶ä½“ç³»å»ºè®¾ï¼Œä¸°å¯Œäº†äº‘èµ„æºçš„æ‰©å±•èƒ½åŠ›ï¼Œå¢åŠ äº†å¤§é‡ CI/CD ç­‰ç”Ÿæ€å¯¹æ¥çš„èƒ½åŠ›ï¼Œè¿›ä¸€æ­¥å®Œå–„äº†å¼€å‘è€…ç«¯åˆ°ç«¯çš„ä½¿ç”¨ä½“éªŒã€‚</p><p><img src="https://static.kubevela.net/images/1.2/architecture.jpg" alt="image.png">
å›¾1ï¼šKubeVela æ¶æ„è®¾è®¡</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å‘å±•å†ç¨‹å›é¡¾"></a>å‘å±•å†ç¨‹å›é¡¾<a class="hash-link" href="#å‘å±•å†ç¨‹å›é¡¾" title="Direct link to heading">#</a></h2><p>è®©æˆ‘ä»¬å†æ¥ç®€å•å›é¡¾ä¸€ä¸‹ OAM å’Œ KubeVela çš„å‘å±•é˜¶æ®µå’Œå†ç¨‹ï¼š</p><ul><li><p><strong>OAMï¼ˆOpen Application Modelï¼‰è¯ç”Ÿå’Œæˆé•¿</strong>
åœ¨å¤æ‚çš„ä¸–ç•Œä¸­è¦åˆ›é€ ç®€å•ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦è§£å†³çš„é—®é¢˜å°±æ˜¯æŠ½è±¡å’Œæ ‡å‡†åŒ–ã€‚é˜¿é‡Œäº‘å’Œå¾®è½¯è”åˆæ¨å‡º <strong>OAM </strong>æ¨¡å‹ï¼Œåˆ›æ–°æ€§åœ°æå‡ºâ€œå…³æ³¨ç‚¹åˆ†ç¦»â€çš„ç†å¿µï¼Œå¼€å‘è€…å…³æ³¨ä¸šåŠ¡æœ¬èº«ã€è¿ç»´å…³æ³¨æ¨¡å—åŒ–èƒ½åŠ›ã€‚OAM æ¨¡å‹å›´ç»•â€œä¸€åˆ‡çš†æœåŠ¡ï¼Œå…¨é¢æ¨¡å—åŒ–â€çš„æ€æƒ³ï¼Œä¸ºå„å¤§å‚å•†å’Œäº‘åŸç”Ÿçš„å¹³å°æ„å»ºè€…ä»¬å®ç°è‡ªå·±çš„åº”ç”¨ç®¡ç†å¹³å°æä¾›äº†ç®€å•æ˜“ç”¨ä¸é«˜åº¦å¯æ‰©å±•ç›¸ç»“åˆçš„æ ‡å‡†å®è·µæ–¹å¼ã€‚è¯¥æ¨¡å‹æå‡ºåçš„çŸ­çŸ­ä¸€å¹´å†…ä¾¿å¾—åˆ°äº†åŒ…æ‹¬ AWSã€Oracleã€è…¾è®¯ã€åä¸ºåœ¨å†…çš„å›½å†…å¤–å„å¤§å‚å•†å“åº”ï¼Œè¢«å›½å®¶ä¿¡é€šé™¢ç«‹é¡¹ä½œä¸ºè¡Œä¸šæ ‡å‡†ã€‚å› ä¸ºå¤§å®¶æœ‰å…±åŒçš„ç›®æ ‡ï¼Œé™ä½äº‘åŸç”Ÿçš„ä½¿ç”¨é—¨æ§›ï¼Œè®©åº”ç”¨äº¤ä»˜å’Œç®¡ç†æ›´ç®€å•ã€‚</p></li><li><p><strong>KubeVela å¼€æºé¡¹ç›® v1.0 å‘å¸ƒï¼Œä¸ºç¤¾åŒºå¸¦æ¥äº† OAM çš„æ ‡å‡†å®ç°</strong>
æœ‰äº† OAM æ¨¡å‹ä½œä¸ºå®è·µæŒ‡å¯¼ï¼Œç¤¾åŒºé«˜çº§ç©å®¶ä¹Ÿå¼€å§‹åˆ›é€ è‡ªå·±çš„å·¥å…·æ¥å®è·µï¼ŒåŒ…æ‹¬é˜¿é‡Œã€å¾®è½¯ã€Oracleã€Upbondã€è…¾è®¯åœ¨å†…çš„ä¸€ç³»åˆ—å…¬å¸éƒ½åŸºäº OAM çš„æŒ‡å¯¼æ„å»ºäº†è‡ªå·±çš„ä¸šåŠ¡å¹³å°ã€‚ä½†å¯¹äºæ›´å¹¿å¤§çš„å¼€å‘è€…å’Œä¸­å°å‹ä¼ä¸šç¾¤ä½“æ¥è¯´ï¼Œä»–ä»¬å´æ— æ³•ç›´æ¥äº«å—æ¨¡å‹å¸¦æ¥çš„çº¢åˆ©ï¼Œäºæ˜¯ï¼ŒKubeVela ä½œä¸º OAM ç¤¾åŒºçš„å®˜æ–¹å®ç°å¼•æ“è¯ç”Ÿäº†ã€‚å®ƒä»ä¸€å¼€å§‹å°±ç”± 7 å®¶æ¥è‡ªä¸åŒç»„ç»‡çš„ OAM ç¤¾åŒºæˆå‘˜ä»é›¶åˆ°ä¸€æ„å»ºã€‚KubeVela çš„å®ç°å¸æ”¶äº†å¤šå®¶å…¬å¸é’ˆå¯¹ OAM çš„å®è·µç»éªŒï¼ŒåŒæ—¶ç»“åˆ Kubernetes ç¤¾åŒºç”Ÿæ€ä¼˜åŠ¿ï¼Œå®ç°äº†è‡ªåŠ¨åŒ–ã€å¯æ”¶æ•›ã€å¹‚ç­‰ä¸”ç¨³å®šçš„åº”ç”¨å‘å¸ƒæ§åˆ¶å™¨ï¼Œå›´ç»• IaCï¼ˆåŸºç¡€è®¾æ–½å³é…ç½®ï¼‰æ„é€ äº†ç”¨æˆ·å‹å¥½çš„æŠ½è±¡å±‚ï¼Œå¸®åŠ©å¼€å‘è€…å®ç°äº†å¼€ç®±åŸºäºçš„ OAM å®ç°å¼•æ“ã€‚</p></li><li><p><strong>KubeVela v1.1 å‘å¸ƒï¼Œå®ç°åº”ç”¨äº¤ä»˜å·¥ä½œæµï¼ŒåŸç”Ÿæ”¯æŒæ··åˆç¯å¢ƒå¤šé›†ç¾¤åº”ç”¨äº¤ä»˜</strong>
éšç€ä¼ä¸šä¸Šäº‘è¿›ç¨‹çš„æ¨è¿›ï¼Œæ··åˆäº‘ã€åˆ†å¸ƒå¼äº‘ç­‰å¤šå…ƒåŒ–åŸºç¡€è®¾æ–½é€æ¸æˆä¸ºå¸¸æ€ã€‚KubeVela ä½œä¸ºç°ä»£åº”ç”¨ç®¡ç†ç³»ç»Ÿä¹Ÿé¡ºåº”æ½®æµï¼Œæ•´ä½“æ¶æ„å‡çº§ä¸ºé¢å‘æ··åˆç¯å¢ƒåšåº”ç”¨äº¤ä»˜å’Œç®¡ç†çš„æ§åˆ¶å¹³é¢ï¼Œå°†æ‰€æœ‰çš„åŠŸèƒ½å¤©ç„¶æ„ç­‘åœ¨å¤šé›†ç¾¤æŠ€æœ¯ä¹‹ä¸Šã€‚æˆ‘ä»¬ç›¸ä¿¡ï¼Œå‡ºäºé«˜å¯ç”¨ã€æˆæœ¬æ€§èƒ½ã€æ•°æ®å®‰å…¨ç­‰å¤šæ–¹é¢å› ç´ ï¼Œæœªæ¥å¤§å¤šæ•°ä¼ä¸šåº”ç”¨çš„å½¢æ€éƒ½å°†æ˜¯å¼‚æ„å¤šå…ƒçš„ã€‚KubeVela v1.1 ç‰ˆæœ¬çš„å‘å¸ƒï¼ŒåŒæ—¶ä¹Ÿå®ç°äº†é«˜åº¦å¯æ‰©å±•çš„åº”ç”¨å‘å¸ƒå·¥ä½œæµï¼Œå®ƒå¤©ç„¶ä»¥æ··åˆç¯å¢ƒæ¶æ„å‘ˆç°ï¼Œåˆ›æ–°æ€§çš„å®ç°äº†äº¤ä»˜å·¥ä½œæµä¸åº”ç”¨æŠ½è±¡ç›¸ç»“åˆçš„å·¥ä½œæ¨¡å¼ï¼Œå®ç°äº†é¢å‘ç»ˆæ€çš„åº”ç”¨äº¤ä»˜å·¥ä½œæµï¼Œå¤§å¤§ç®€åŒ–äº†æµç¨‹ç¼–æ’çš„å¤æ‚æ€§ã€‚</p></li></ul><p>æ—¶é—´æ¥åˆ° 2022 å¹´ï¼ŒKubeVela ä¹Ÿæ­£å¼è¿›å…¥äº†ç¬¬å››ä¸ªé˜¶æ®µï¼Œåœ¨åŸå…ˆæ ¸å¿ƒæ§åˆ¶å™¨ API åŸºæœ¬ç¨³å®šçš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬ä»¥æ’ä»¶çš„å½¢å¼å¢åŠ äº†ä¸€ç³»åˆ—å¼€ç®±å³ç”¨çš„åŠŸèƒ½ã€‚è®©å¼€å‘è€…å¯ä»¥é€šè¿‡ UI æ§åˆ¶å°çš„æ–¹å¼ï¼Œè¿æ¥ CI/CD å®Œæ•´æµç¨‹ï¼Œç«¯åˆ°ç«¯å‘å¸ƒå¤šé›†ç¾¤åº”ç”¨ï¼Œè¿›ä¸€æ­¥æå‡å¼€å‘è€…ä½“éªŒã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="v12-ç‰ˆæœ¬çš„æ ¸å¿ƒèƒ½åŠ›"></a>v1.2 ç‰ˆæœ¬çš„æ ¸å¿ƒèƒ½åŠ›<a class="hash-link" href="#v12-ç‰ˆæœ¬çš„æ ¸å¿ƒèƒ½åŠ›" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å›¾å½¢åŒ–æ“ä½œæ§åˆ¶å°ï¼ˆvelauxï¼‰"></a>å›¾å½¢åŒ–æ“ä½œæ§åˆ¶å°ï¼ˆVelaUXï¼‰<a class="hash-link" href="#å›¾å½¢åŒ–æ“ä½œæ§åˆ¶å°ï¼ˆvelauxï¼‰" title="Direct link to heading">#</a></h3><p>æä¾›å¥½ç”¨çš„å›¾å½¢åŒ–æ“ä½œç•Œé¢æ˜¯é™ä½å¼€å‘è€…ä½¿ç”¨é—¨æ§›çš„é¦–é€‰é€”å¾„ï¼Œä» KubeVela è¯ç”Ÿä»¥æ¥ï¼Œç¤¾åŒºå¯¹ UI æ§åˆ¶å°çš„å‘¼å£°ä¸€ç›´å¾ˆé«˜ã€‚ä» v1.2 ç‰ˆæœ¬å¼€å§‹ï¼Œå®ƒæ­£å¼åˆ°æ¥äº†ã€‚æ‰“é€  UI æ§åˆ¶å°çš„ç›®çš„æ˜¯å¸®åŠ©å¼€å‘è€…ä»¥æ›´æ ‡å‡†åŒ–çš„æ–¹å¼ç»„è£…å’Œç®¡ç†å¼‚æ„ä¸šåŠ¡åº”ç”¨ï¼Œå¸®åŠ©ä»–ä»¬åˆ†æå’Œæ›´å¿«çš„å‘ç°ä¸šåŠ¡æ•…éšœå’Œé˜»ç¢ã€‚</p><p><a href="https://github.com/oam-dev/velaux" target="_blank" rel="noopener noreferrer">VelaUX</a> æ˜¯ KubeVela çš„å‰ç«¯é¡¹ç›®ï¼Œè®¾è®¡å®ç°æ—¶å®ƒå……åˆ†è€ƒè™‘äº† KubeVela çš„å¯æ‰©å±•æ€§è¿™ä¸€æ ¸å¿ƒè¦ç‚¹ã€‚å¼•å…¥äº†ä½ä»£ç å¹³å°çš„ç†å¿µæ¥æ‰“é€ å‰ç«¯ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ‰“é€ ä¸€ä¸ªå¯ä»¥é€šè¿‡æ‹–æ‹‰æ‹½æ–¹å¼å°±èƒ½åšåˆ°è‡ªå®šä¹‰åº”ç”¨äº¤ä»˜è¾“å…¥å‚æ•°ï¼Œå¹¶ä¸”å®ç°è¿è¡Œæ•°æ®å¯è§‚æµ‹çš„å¹³å°ã€‚ä¸ºæ­¤æˆ‘ä»¬è®¾è®¡äº†å‰ç«¯æè¿°è§„èŒƒ <a href="https://kubevela.io/zh/docs/reference/ui-schema" target="_blank" rel="noopener noreferrer">UISchema</a>ï¼Œé…åˆ KubeVela çš„æ¨¡å—åŒ–å®šä¹‰ <a href="https://kubevela.net/zh/docs/platform-engineers/oam/x-definition" target="_blank" rel="noopener noreferrer">X-Definition</a>ï¼Œé€šè¿‡é…ç½®å°±å¯ä»¥æ¸²æŸ“å‡ºä¸°å¯Œçš„å‰ç«¯äº¤äº’å…ƒç´ ã€‚åŒæ—¶ä¸ºäº†è®©å‰ç«¯çš„æ•°æ®æŸ¥è¯¢ä¹Ÿé…ç½®åŒ–ï¼Œæˆ‘ä»¬è®¾è®¡äº†å¤šç»´æ•°æ®è‡ªå®šä¹‰æŸ¥è¯¢è¯­è¨€ <a href="https://kubevela.io/zh/docs/platform-engineers/system-operation/velaql" target="_blank" rel="noopener noreferrer">VelaQL</a>ï¼Œè¿™æ ·çš„è®¾è®¡å½¢æˆäº† KubeVela äº¤ä»˜å’Œç®¡ç†å¼‚æ„åº”ç”¨çš„åŸºç¡€ã€‚</p><p>ç›®å‰é€šè¿‡ VelaUX ï¼Œç”¨æˆ·å¯ä»¥ç®¡ç†æ‰©å±•ï¼Œè¿æ¥ Kubernetes é›†ç¾¤ï¼Œåˆ†é…äº¤ä»˜ç›®æ ‡ï¼Œè§„åˆ’ç¯å¢ƒå’Œäº¤ä»˜å„ç±»å‹åº”ç”¨ï¼Œå¹¶è§‚æµ‹åº”ç”¨è¿è¡ŒçŠ¶æ€ï¼Œå®ç°åº”ç”¨äº¤ä»˜çš„å®Œæ•´é—­ç¯ã€‚</p><p><img src="https://static.kubevela.net/images/1.2/dashboard.jpeg" alt="image.png">
å›¾2ï¼šVelaUX é¢„è§ˆ</p><p>å¦‚å›¾ 2 æ‰€ç¤ºï¼ŒVelaUX ä¸­å‡ºç°äº†ä¸€äº›æ–°åè¯ï¼Œè¯·å‚è€ƒ <a href="https://kubevela.net/zh/docs/getting-started/core-concept" target="_blank" rel="noopener noreferrer">æ ¸å¿ƒæ¦‚å¿µ</a> æ–‡æ¡£è¿›è¡Œå­¦ä¹ å’Œäº†è§£ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å¤šç¯å¢ƒç»Ÿä¸€åŒ–ç®¡ç†"></a>å¤šç¯å¢ƒç»Ÿä¸€åŒ–ç®¡ç†<a class="hash-link" href="#å¤šç¯å¢ƒç»Ÿä¸€åŒ–ç®¡ç†" title="Direct link to heading">#</a></h3><p>KubeVela å°† N ä¸ªKubernetes é›†ç¾¤ï¼ŒN ä¸ªäº‘å‚å•†æœåŠ¡æˆ–å…¶ä»–ç§æœ‰äº‘æœåŠ¡ç»Ÿä¸€ä¸ºå¤§çš„åŸºç¡€è®¾æ–½èµ„æºæ± ã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬çš„å¼€å‘è€…å¯ä»¥æŒ‰ç…§ä¸šåŠ¡éœ€æ±‚ã€æµç¨‹éœ€æ±‚ã€å›¢é˜Ÿéœ€æ±‚ç­‰å¤šç§ä¸šåŠ¡ç»´åº¦åˆ’åˆ†ç¯å¢ƒã€‚åœ¨å¤§èµ„æºæ± çš„åŸºç¡€ä¸Šå½¢æˆç¯å¢ƒç©ºé—´ã€‚åŒä¸€ä¸ªåº”ç”¨å¯å‘å¸ƒåˆ°ä¸åŒçš„ç¯å¢ƒï¼Œç¯å¢ƒä¹‹é—´ä»ç®¡ç†åˆ°è¿è¡Œæ€å®Œå…¨éš”ç¦»ã€‚</p><p><img src="https://static.kubevela.net/images/1.2/multiple-cluster.png" alt="image.png">
å›¾3ï¼šå¤šç¯å¢ƒ/å¤šé›†ç¾¤åº”ç”¨ç®¡ç†é¡µé¢</p><p>å¦‚å›¾ 3 æ‰€ç¤ºï¼Œåº”ç”¨å¯è¢«å‘å¸ƒåˆ°ç”Ÿäº§ã€æµ‹è¯•ã€é»˜è®¤ä¸‰ä¸ªç¯å¢ƒä¸­ï¼Œæ¯ä¸€ä¸ªç¯å¢ƒå¯ä»¥åŒ…æ‹¬å¤šä¸ªäº¤ä»˜ç›®æ ‡ï¼Œæ¯ä¸€ä¸ªäº¤ä»˜ç›®æ ‡èƒŒåå¯ä»¥æ˜¯ç‹¬ç«‹çš„ Kubernetes é›†ç¾¤ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å¼‚æ„åº”ç”¨æ ‡å‡†åŒ–äº¤ä»˜"></a>å¼‚æ„åº”ç”¨æ ‡å‡†åŒ–äº¤ä»˜<a class="hash-link" href="#å¼‚æ„åº”ç”¨æ ‡å‡†åŒ–äº¤ä»˜" title="Direct link to heading">#</a></h3><p>åœ¨äº‘åŸç”Ÿä½“ç³»ä¸­ï¼Œæˆ‘ä»¬äº¤ä»˜åº”ç”¨çš„å½¢å¼é€‰æ‹©éå¸¸å¤šã€‚åŸºäº Kubernetes åŸºç¡€è®¾æ–½ï¼Œæˆ‘ä»¬æ—¢å¯ä»¥é€šè¿‡æˆç†Ÿçš„ Helm Chart åŒ…äº¤ä»˜ä¸­é—´ä»¶å’Œç¬¬ä¸‰æ–¹å¼€æºåº”ç”¨ï¼Œä¹Ÿå¯ä»¥é€šè¿‡é•œåƒäº¤ä»˜ä¼ä¸šä¸šåŠ¡åº”ç”¨ï¼Œè¿˜å¯ä»¥é€šè¿‡ OpenYurt äº¤ä»˜ç®¡ç†è¾¹ç¼˜åº”ç”¨ã€‚ åŸºäºäº‘æœåŠ¡å•†çš„å¼€æ”¾èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥äº¤ä»˜æ•°æ®åº“ã€æ¶ˆæ¯ã€ç¼“å­˜ç­‰ä¸­é—´ä»¶ï¼Œä¹Ÿæœ‰æ—¥å¿—ã€åº”ç”¨ç›‘æ§ç­‰è¿ç»´èƒ½åŠ›ã€‚</p><p>å¯¹äºè¿™ä¹ˆå¤šçš„å¯é€‰é¡¹ï¼ŒKubeVela é‡‡ç”¨æ ‡å‡†çš„ OAM è§„èŒƒå®ç°å¯¹å¼‚æ„åº”ç”¨çš„ç»Ÿä¸€äº¤ä»˜å’Œç®¡ç†ã€‚KubeVela å®ç°äº†é«˜åº¦å¯æ‰©å±•çš„äº¤ä»˜ç³»ç»Ÿï¼Œé€šè¿‡å†…ç½®ã€ç¤¾åŒºå…±äº«ç­‰å½¢æ€å¸®åŠ©ç”¨æˆ·æ‰©å±•å¹³å°ï¼Œä»¥ä¸€è‡´åŒ–çš„äº¤ä»˜å’Œç®¡ç†ä½“éªŒå¤„ç†å¼‚æ„çš„åº”ç”¨ã€‚åœ¨ KubeVela ä¹‹ä¸Šï¼Œå¼€å‘è€…çœ‹åˆ°çš„éƒ½æ˜¯æ¨¡å—åŒ–ã€ä¸€åˆ‡çš†æœåŠ¡çš„ç®¡ç†å½¢æ€ã€‚</p><p><img src="https://static.kubevela.net/images/1.2/cloud-resource.png" alt="image.png">
å›¾4ï¼šäº‘æœåŠ¡åº”ç”¨ç®¡ç†é¡µé¢</p><p>å¦‚å›¾ 4 æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œç›¸åŒçš„åº”ç”¨ç®¡ç†é¡µé¢ï¼Œç”¨æˆ·å¯ä»¥éå¸¸ä¾¿æ·å¾—è·å–åˆ°äº‘æœåŠ¡åº”ç”¨ã€‚å¼€å‘è€…å¯ä»¥é€šè¿‡é˜…è¯»ä¸‹é¢å‡ ç¯‡æ–‡æ¡£æŸ¥çœ‹å¼‚æ„åº”ç”¨çš„äº¤ä»˜è¿‡ç¨‹ï¼š</p><ol><li><a href="https://kubevela.net/zh/docs/deliver-app/webservice" target="_blank" rel="noopener noreferrer">äº¤ä»˜ Docker é•œåƒ</a></li><li><a href="https://kubevela.net/zh/docs/deliver-app/helm" target="_blank" rel="noopener noreferrer">äº¤ä»˜ Helm Chart åŒ…</a></li><li><a href="https://kubevela.net/zh/docs/deliver-app/k8s-object" target="_blank" rel="noopener noreferrer">äº¤ä»˜ Kubernetes èµ„æº</a></li><li><a href="https://kubevela.net/zh/docs/tutorials/consume-cloud-services" target="_blank" rel="noopener noreferrer">äº¤ä»˜ äº‘æœåŠ¡</a></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ‰©å±•ä½“ç³»ï¼ˆaddonï¼‰"></a>æ‰©å±•ä½“ç³»ï¼ˆAddonï¼‰<a class="hash-link" href="#æ‰©å±•ä½“ç³»ï¼ˆaddonï¼‰" title="Direct link to heading">#</a></h3><p>KubeVela ä»ä¸€å¼€å§‹å°±æ˜¯è®¾è®¡ä¸ºä¸€æ¬¾å¾®å†…æ ¸é«˜å¯æ‰©å±•çš„ç³»ç»Ÿï¼Œä¸Šæ–‡æˆ‘ä»¬è¯´åˆ°å¼‚æ„åº”ç”¨ï¼ŒKubeVela å¯ä»¥é€šè¿‡æ‰©å±•ä½“ç³»ï¼Œä»¥æ ‡å‡†åŒ–çš„å½¢æ€ï¼Œæ‰©å……æ— é™çš„åº”ç”¨äº¤ä»˜èƒ½åŠ›ã€‚æ—¢åŒ¹é…ä¼ä¸šå·®å¼‚æ€§è¯‰æ±‚ï¼Œä¹Ÿä¸å¸¦æ¥è¿‡å¤šçš„è®¤çŸ¥è´Ÿæ‹…ã€‚KubeVela ä¸­å¯æ‰©å±•çš„ç‚¹åŒ…æ‹¬äº†ç»„ä»¶ç±»å‹ã€è¿ç»´èƒ½åŠ›ã€å·¥ä½œæµç±»å‹ã€åº”ç”¨äº¤ä»˜ç­–ç•¥ç­‰ã€‚åœ¨å½“å‰ç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬å‘å¸ƒäº† Addon æ‰©å±•ä½“ç³»ã€‚Addon  æ˜¯ç»„ç»‡å„ç§æ‰©å±•èƒ½åŠ›çš„æ‰¿è½½ä½“ï¼Œå®ƒä¾¿äºåˆ†å‘å’Œç®¡ç†ã€‚</p><p><img src="https://static.kubevela.net/images/1.2/addon.png" alt="image.png">
å›¾5ï¼šKubeVela æ’ä»¶ç®¡ç†é¡µé¢</p><p>ç›®å‰åœ¨å®˜æ–¹ä»“åº“ä¸­å·²ç»å­˜åœ¨å¦‚å›¾ 5 æ‰€ç¤ºçš„å¯ç”¨ Addonã€‚åŒæ—¶åœ¨å®éªŒæ€§ä»“åº“ä¸­æˆ‘ä»¬æ­£åœ¨è”åˆç¤¾åŒºç”¨æˆ·ç§¯æåˆ›é€ æ›´å¤šçš„æ‰©å±•èƒ½åŠ›ã€‚å½“ç„¶ï¼Œè¿™é‡Œéœ€è¦æ¯ä¸€ä¸ªç¤¾åŒºå¼€å‘è€…çš„ç§¯æå‚ä¸ã€‚</p><p>æˆªæ­¢åˆ°ç°åœ¨ï¼ŒKubeVela å·²ç»æˆé•¿ä¸ºä¸€æ¬¾å¯ç›´æ¥æœåŠ¡äºå¹¿å¤§å¼€å‘è€…çš„åº”ç”¨äº¤ä»˜å¹³å°ï¼Œé‚£ä¹ˆä¼ä¸šå“ªäº›åœºæ™¯å¯ä»¥ç›´æ¥åˆ©ç”¨ KubeVela å‘¢ï¼Ÿæˆ‘ä»¬æ•´ç†äº†ä»¥ä¸‹å‡ ä¸ªå¸¸è§åœºæ™¯ï¼š</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ä¼ä¸šå¼€å‘åœºæ™¯è§£å†³æ–¹æ¡ˆ"></a>ä¼ä¸šå¼€å‘åœºæ™¯è§£å†³æ–¹æ¡ˆ<a class="hash-link" href="#ä¼ä¸šå¼€å‘åœºæ™¯è§£å†³æ–¹æ¡ˆ" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å¤šé›†ç¾¤åº”ç”¨-devops"></a>å¤šé›†ç¾¤åº”ç”¨ DevOps<a class="hash-link" href="#å¤šé›†ç¾¤åº”ç”¨-devops" title="Direct link to heading">#</a></h3><p>åœ¨è¿‡å¾€ç¤¾åŒºçš„äº¤æµä¸­ï¼Œæˆ‘ä»¬å‘ç°ä¼ä¸šä¸»æµçš„ç ”å‘ä½“ç³»éƒ½ç±»ä¼¼å¦‚å›¾ 6 æ‰€ç¤ºçš„ç»“æ„ï¼Œä»–ä»¬ä½¿ç”¨äº‘æœåŠ¡å‚å•†æä¾›çš„è®¡ç®—èµ„æºä½œä¸ºç”Ÿäº§ã€æ¼”ç¤ºç¯å¢ƒã€‚ä½¿ç”¨è‡ªå·±è´­ä¹°æˆ–å†å²é—ç•™çš„æœåŠ¡å™¨æ­å»ºå¼€å‘ã€æµ‹è¯•ç¯å¢ƒã€‚å¦‚æœä¸šåŠ¡æœ‰å¤šåŒºåŸŸæˆ–ç¾å¤‡éœ€æ±‚ï¼Œç”Ÿäº§ç¯å¢ƒå¯èƒ½éœ€è¦éƒ¨ç½²åˆ°å¤šä¸ªåŒºåŸŸæˆ–å¤šäº‘ã€‚</p><p><img src="https://static.kubevela.net/images/1.2/devops-zh.png" alt="image.png">
å›¾6ï¼šå¤šé›†ç¾¤åº”ç”¨å®è·µæ¶æ„</p><p>å¯¹äºåŸºç¡€çš„ DevOps æµç¨‹ï¼ŒåŒ…æ‹¬äº†ä»£ç æ‰˜ç®¡å’Œ CI/CD çš„ç¯èŠ‚ã€‚KubeVela ç›®å‰ä¸ºä½ æä¾› CD ç¯èŠ‚çš„æ”¯æŒã€‚å¯¹äºä¼ä¸šå®è·µçš„æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li>æ ¹æ®å®é™…æƒ…å†µå‡†å¤‡æœ¬åœ°æˆ–äº‘æœåŠ¡èµ„æºã€‚è‡³å°‘å•é¡¹æ‰“é€šæœ¬åœ°å’Œäº‘èµ„æºçš„ç½‘ç»œï¼Œä¾¿äºèµ„æºé›†ä¸­ç®¡ç†ã€‚</li><li>å°† KubeVela ç³»ç»Ÿæ­å»ºåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä¿éšœæŒç»­çš„å¯ç”¨æ€§ã€‚</li><li>é€šè¿‡ KubeVela éƒ¨ç½² Gitlabã€Jenkinsã€Sonar ç­‰ DevOps å·¥å…·ï¼Œå¹¶æ‰“é€šå·¥å…·é“¾ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œä»£ç æ‰˜ç®¡å’Œå¼€å‘å·¥å…·çš„å¯ç”¨æ€§è‡³å…³é‡è¦ï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶éƒ¨ç½²åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼ˆå¦‚æœä½ æœ¬åœ°æœºæˆ¿å…·å¤‡ç”Ÿäº§å¯ç”¨æ€§ï¼Œä¸”å¸Œæœ›ä»£ç æ•°æ®åœ¨æœ¬åœ°ç¯å¢ƒæµè½¬ï¼Œå¯éƒ¨ç½²åœ¨æœ¬åœ°æœºæˆ¿ï¼‰ã€‚</li><li>é€šè¿‡ KubeVela è§„åˆ’æœ¬åœ°å¼€å‘ç¯å¢ƒï¼Œéƒ¨ç½²æœ¬åœ°æµ‹è¯•ç”¨ä¸­é—´ä»¶ï¼Œè§„åˆ’ç”Ÿäº§ç¯å¢ƒå’Œéƒ¨ç½²äº‘æœåŠ¡ä¸­é—´ä»¶ã€‚</li><li>é€šè¿‡ Jenkins æ­å»ºä¸šåŠ¡ä»£ç  CI æµæ°´çº¿ï¼Œäº§å‡º Docker é•œåƒäº¤ç”± KubeVela è¿›è¡Œå¤šç¯å¢ƒéƒ¨ç½²ï¼Œå½¢æˆå®Œæ•´åº”ç”¨äº¤ä»˜å·¥ä½œæµã€‚</li></ol><p>ç»“åˆ KubeVela çš„å¤šé›†ç¾¤åº”ç”¨ DevOps æ–¹æ¡ˆæœ‰å¦‚ä¸‹ä¼˜åŠ¿ï¼š</p><ol><li>å¼€å‘è€…æ— éœ€æŒæ¡è¿‡å¤šçš„ Kubernetes ç”Ÿæ€çŸ¥è¯†ï¼Œå¯å®ç°å¼‚æ„åº”ç”¨äº‘åŸç”Ÿéƒ¨ç½²ã€‚</li><li>å¤šé›†ç¾¤ï¼Œå¤šç¯å¢ƒç»Ÿä¸€ç®¡ç†ï¼ŒåŸç”Ÿå¯éƒ¨ç½²è·¨é›†ç¾¤åº”ç”¨ã€‚</li><li>ç»Ÿä¸€çš„åº”ç”¨ç®¡ç†æ¨¡å¼ï¼Œæ— è®ºæ˜¯ä¸šåŠ¡åº”ç”¨è¿˜æ˜¯å¼€å‘å·¥å…·é“¾ã€‚</li><li>çµæ´»çš„å·¥ä½œæµï¼Œå¸®åŠ©ä¼ä¸šæ‰“é€šå„ç§å¼€å‘è§„èŒƒæµç¨‹ã€‚</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ··åˆç¯å¢ƒä¸€ä½“åŒ–ç®¡ç†"></a>æ··åˆç¯å¢ƒä¸€ä½“åŒ–ç®¡ç†<a class="hash-link" href="#æ··åˆç¯å¢ƒä¸€ä½“åŒ–ç®¡ç†" title="Direct link to heading">#</a></h3><p>ä¸åŒçš„ä¼ä¸šå¾€å¾€éƒ½å­˜åœ¨ä¸ä¸€æ ·çš„åŸºç¡€è®¾æ–½å’Œä¸šåŠ¡è¯‰æ±‚ã€‚åœ¨åŸºç¡€è®¾æ–½ä¾§ï¼šä¼ä¸šå¯èƒ½æ­å»ºäº†ç§æœ‰äº‘ï¼Œå¯èƒ½è´­ä¹°äº†å…¬æœ‰äº‘ï¼Œå¯èƒ½è¿˜æœ‰è¾¹ç¼˜è®¡ç®—èµ„æºã€‚åœ¨ä¸šåŠ¡ä¾§ï¼šä¸åŒçš„ä¸šåŠ¡è§„æ¨¡ä¸åŒï¼Œèµ„æºéœ€æ±‚ä¸åŒï¼Œå¯èƒ½æœ‰å¤šäº‘å¤šæ´»åº”ç”¨ï¼Œä¹Ÿæœ‰ä¼ä¸šé—ç•™ç³»ç»Ÿã€‚åœ¨ç ”å‘ä¾§ï¼šä¸šåŠ¡ç ”å‘å¾€å¾€éœ€è¦å¼€å‘ã€æµ‹è¯•ã€é¢„å‘å’Œç”Ÿäº§ç¯å¢ƒã€‚åœ¨ç®¡ç†ä¾§ï¼šä¸åŒçš„ä¸šåŠ¡å›¢é˜Ÿéœ€è¦ç›¸äº’éš”ç¦»ï¼Œåˆå¯èƒ½éœ€è¦ä¸šåŠ¡äº’é€šã€‚</p><p>éšç€æ—¶é—´çš„ç´¯ç§¯ï¼Œä¼ä¸šç”±äºèŒè´£è¾¹ç•Œå’Œä¸åŒåˆ†å·¥çš„å½±å“ï¼Œä¼šé€æ¸å½¢æˆä¸åŒä¸šåŠ¡å›¢é˜Ÿç›¸äº’ç‹¬ç«‹ç”šè‡³å‰²è£‚çš„çŠ¶æ€ï¼Œè¿™ç§å‰²è£‚åŒ…æ‹¬äº†ï¼šå¼€å‘å·¥å…·å‰²è£‚ï¼ŒæŠ€æœ¯æ¶æ„å‰²è£‚ï¼Œä¸šåŠ¡ç®¡ç†å½¢æ€å‰²è£‚ã€‚KubeVela ç§‰æŒç€â€œå°Šé‡ç°å®ï¼Œç§¯æåˆ›æ–°â€çš„åŸåˆ™ï¼Œå¸¦æ¥çš„æ–¹æ¡ˆæ˜¯è¿½æ±‚ç»Ÿä¸€çš„è¿‡ç¨‹ä¸­ç”¨é«˜æ‰©å±•çš„èƒ½åŠ›å»å…¼å®¹å·®å¼‚æ€§ã€‚</p><ul><li>é¢å¯¹åŸºç¡€è®¾æ–½å·®å¼‚ï¼Œæˆ‘ä»¬æ”¯æŒä»¥ Kubernetes APIã€äº‘æœåŠ¡ API æˆ–å…¶ä»–è‡ªå®šä¹‰ API çš„å½¢æ€ï¼Œå»å¯¹åŸºç¡€è®¾æ–½è¿›è¡Œå……åˆ†çš„æ¨¡å‹åŒ–ã€‚æœ€ç»ˆé€šè¿‡ç»Ÿä¸€çš„ OAM æ¨¡å‹å‘ä¸Šæš´éœ²ä¸€è‡´çš„æ¦‚å¿µã€‚</li><li>é¢å¯¹ä¸šåŠ¡æ¶æ„å·®å¼‚ï¼Œåº”ç”¨æ¨¡å‹æ˜¯å¼€æ”¾çš„ï¼Œå¯¹æ¶æ„æ— è¦æ±‚çš„ã€‚KubeVela åšçš„æ˜¯è¿æ¥å’Œèµ‹èƒ½ï¼Œè¿æ¥å·²æœ‰ç³»ç»Ÿï¼Œé€šè¿‡æ‰©å±•æœºåˆ¶åŠ æŒæ–°çš„ç”Ÿæ€æŠ€æœ¯ã€‚</li><li>é¢å¯¹å¼€å‘å·¥å…·é“¾çš„å·®å¼‚ï¼Œä¼ä¸šä¸­å¯èƒ½å·²ç»å­˜åœ¨ä¸åŒçš„å¼€å‘å·¥å…·é“¾ï¼Œäº§å‡ºä¸åŒçš„ä¸šåŠ¡åˆ¶å“ã€‚ KubeVela é€šè¿‡æ‰©å±•å’Œæ ‡å‡†æ¨¡å‹å»æ”¯æŒå„ç±»åˆ¶å“ï¼Œå®ç°å…¶æ ‡å‡†åŒ–äº¤ä»˜ã€‚å½“ç„¶ï¼Œå®ƒçš„æ ‡å‡†é€æ­¥è¡ç”Ÿåˆ°å‰ç½®ç¯èŠ‚ï¼Œå¸®åŠ©ä¼ä¸šé€æ­¥å®ç°å·¥å…·é“¾ä¸€è‡´åŒ–ã€‚å› æ­¤ï¼Œä½ ä¸ç”¨æ‹…å¿ƒä½ æ˜¯ç”¨çš„ Gitlab è¿˜æ˜¯ Jenkinsï¼Œå®ƒéƒ½èƒ½å¯¹æ¥ã€‚</li><li>é¢å¯¹è¿ç»´èƒ½åŠ›å·®å¼‚ï¼Œä¼ä¸šä¸­ä¸åŒå›¢é˜Ÿçš„è¿ç»´èƒ½åŠ›ã€å·¥å…·æ–¹æ¡ˆå¯ä»¥åœ¨ KubeVela çš„è§„èŒƒä¸‹é€æ­¥ç§¯ç´¯ï¼Œèƒ½åŠ›äº’é€šã€‚æ›´å¤šè¿ç»´èƒ½åŠ›ä¹ŸåŒæ ·åœ¨ç¤¾åŒºçš„ç»´åº¦è¿›è¡Œå…±äº«å’Œå¤ç”¨ã€‚</li></ul><p>å› æ­¤ï¼Œä½¿ç”¨ KubeVela æ¥ä½œä¸ºä¼ä¸šæ‰“é€šä¸šåŠ¡ï¼Œè¿›è¡Œç»Ÿä¸€èƒ½åŠ›å»ºè®¾çš„åŸºç¡€å¹³å°ï¼Œå®ƒæ˜¯å¯è½åœ°ã€æœ‰æœªæ¥çš„æ–¹æ¡ˆ</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="è‡ªå®šä¹‰ä¼ä¸šå‘å¸ƒå¹³å°"></a>è‡ªå®šä¹‰ä¼ä¸šå‘å¸ƒå¹³å°<a class="hash-link" href="#è‡ªå®šä¹‰ä¼ä¸šå‘å¸ƒå¹³å°" title="Direct link to heading">#</a></h3><p>ä» Heroku ã€Cloud Foundry æ—¶ä»£å¼€å§‹ï¼Œå¸‚åœºä¸Šä¸€ç›´åœ¨äº§ç”Ÿä¸åŒçš„ PaaS å¹³å°ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“å›ºå®šæ¨¡å¼çš„å‘å¸ƒå¹³å°å¾€å¾€ä¸é€‚åˆæ‰€æœ‰çš„ä¼ä¸šã€‚ä¸¾ä¸ªä¾‹å­ï¼ŒæŸäº›è§„èŒƒåŒ–ç¨‹åº¦è¾ƒé«˜çš„ä¼ä¸šï¼Œä»–ä»¬åŸºäºä¸šåŠ¡çš„ç‰¹æ€§ï¼Œå‘å¸ƒåº”ç”¨æ—¶ä»…éœ€æ›´æ–°é•œåƒåç§°ï¼Œç„¶è€Œä½¿ç”¨é€šç”¨ PaaS å°±ä¸å¾—ä¸å»ç†è§£å¤§é‡çš„æ¦‚å¿µå’Œå‚æ•°ã€‚å†æ¯”å¦‚æŸä¸ªä¼ä¸šç”Ÿäº§çš„æ˜¯ AI åº”ç”¨ï¼Œå¯¹äº AI åº”ç”¨çš„å‘å¸ƒä¸æ™®é€šåº”ç”¨æœ‰æ¯”è¾ƒå¤§çš„åŒºåˆ«ï¼Œè¿™æ—¶å°±éœ€è¦å®šåˆ¶ AI åœºæ™¯çš„ PaaSï¼Œä¼ä¸šä¸å¾—ä¸ä»˜æ›´å¤šçš„è´¹ç”¨å’Œå­¦ä¹ æ›´å¤šçš„æ¦‚å¿µã€‚</p><p>é€šç”¨äº§å“ä¸ç¬¦åˆä¼ä¸šéœ€æ±‚æ—¶ï¼Œè‡ªç ”æ˜¯çœŸå®å­˜åœ¨çš„è¯‰æ±‚ã€‚ä½†æ˜¯å¯¹äºä»é›¶å¼€å§‹è‡ªç ”å¹³å°ï¼Œå¿…ç„¶åˆéœ€è¦æŠ•å…¥å¤§é‡çš„äººåŠ›ç‰©åŠ›ï¼Œç”šè‡³è¶…è¿‡äº†ä¼ä¸šæ ¸å¿ƒä¸šåŠ¡çš„æŠ•å…¥ï¼Œè¿™æ˜¾å¾—å¾—ä¸å¿å¤±ã€‚KubeVela ä¹Ÿè€ƒè™‘åˆ°äº†å…·å¤‡è‡ªç ”èƒ½åŠ›ä¼ä¸šçš„ç‹¬ç‰¹è¯‰æ±‚ï¼Œä»–ä»¬å¯ä»¥åŸºäº KubeVela å¾®å†…æ ¸ã€é«˜å¯æ‰©å±•çš„è®¾è®¡ï¼Œé’ˆå¯¹è‡ªå·±çš„ä¸šåŠ¡åœºæ™¯å’Œé¢†åŸŸçŸ¥è¯†ï¼Œæ‰“é€ å±äºè‡ªå·±çš„ã€æ›´ä¸ºç®€å•æ˜“ç”¨çš„ä¸šåŠ¡å¹³å°ã€‚</p><p>å¯¹äºéœ€è¦è‡ªç ”å‘å¸ƒå¹³å°çš„ä¼ä¸šæ¥è¯´ï¼ŒKubeVela çš„å¾®å†…æ ¸æ˜¯ä¸€ä¸ª PaaS å¹³å°ç ”å‘æ¡†æ¶ã€‚ä¸€æ–¹é¢ï¼Œä¼ä¸šå¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚è‡ªç ”æˆ–è€…å®‰è£…ç¤¾åŒºçš„å„ç§åŠŸèƒ½æ’ä»¶ï¼›å¦ä¸€æ–¹é¢ï¼Œä¼ä¸šä¹Ÿå¯ä»¥åŸºäº OAM æ¨¡å‹ä¿®æ”¹æ¨¡å—åŒ–é…ç½®ï¼Œæ–°å¢æˆ–è£å‰ªç”¨æˆ·ä½¿ç”¨çš„å‚æ•°ã€‚è¿™ç§æ¨¡å—åŒ–çš„è®¾è®¡å¯ä»¥å¤§å¤§é™ä½ä¼ä¸šçš„æŠ•å…¥æˆæœ¬ï¼ŒåŒæ—¶å¯ä»¥è·Ÿä¸Šç¤¾åŒºçš„å‘å±•æ½®æµï¼Œéšæ—¶å°†ç¤¾åŒºæ›´å¤šçš„å…ˆè¿›æŠ€æœ¯è½¬åŒ–ä¸ºè‡ªèº«çš„ç”Ÿäº§åŠ›ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å‚ä¸ç¤¾åŒº"></a>å‚ä¸ç¤¾åŒº<a class="hash-link" href="#å‚ä¸ç¤¾åŒº" title="Direct link to heading">#</a></h2><p>åšäº†è¿™ä¹ˆå¤šçš„ä»‹ç»ï¼Œä½ æ˜¯å¦å¯¹ KubeVela çš„å‘å±•æœ‰äº†ä¸€äº›æ–°çš„è®¤è¯†ï¼Œæ²¡æœ‰å“ªä¸ªäº§å“æ˜¯ç»å¯¹çš„é“¶å¼¹ï¼Œä¹Ÿæ²¡æœ‰ä¸€ä¸ªæ–¹æ¡ˆå¯ä»¥è§£å†³æ‰€æœ‰çš„é—®é¢˜ã€‚ä½†æ˜¯æˆ‘ä»¬çš„ç†æƒ³æ˜¯å¯ä»¥åˆ›é€ ä¸€ä¸ªæ ‡å‡†åŒ–æ¨¡å¼ï¼Œè®©æ›´å¤šçš„ä¼ä¸šå’Œå¼€å‘è€…ç”¨æˆ·å‚ä¸åˆ°è¿™åœºä¸ºäº†â€œç®€å•â€å’Œâ€œé«˜æ•ˆâ€çš„å¼€å‘è€…ä½“éªŒæˆ˜å½¹ä¸­æ¥ã€‚KubeVela è¿˜å¾ˆå¹´è½»ï¼Œæˆ‘ä»¬å¸Œæœ›ä½ å¯ä»¥å‚ä¸è¿›æ¥å…±åŒæ‰“é€ ã€‚è¿™é‡Œéå¸¸æ„Ÿè°¢åœ¨è¿‡å»å‚ä¸ KubeVela è´¡çŒ®çš„ <a href="https://github.com/oam-dev/kubevela/graphs/contributors" target="_blank" rel="noopener noreferrer">100 å¤šä½å¼€å‘è€…</a>ï¼Œæ­£æ˜¯å› ä¸ºä½ ä»¬çš„æºæ‰‹åŠªåŠ›ï¼Œæ‰è®©æˆ‘ä»¬çš„ç¤¾åŒºç”Ÿæ€å˜å¾—æ›´åŠ ç¹è£ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å…±å»º-oam-åº”ç”¨è§„èŒƒ"></a>å…±å»º OAM åº”ç”¨è§„èŒƒ<a class="hash-link" href="#å…±å»º-oam-åº”ç”¨è§„èŒƒ" title="Direct link to heading">#</a></h3><p>å¯¹äº OAM åº”ç”¨è§„èŒƒï¼Œæ¨¡å‹çš„æ›´æ–°å’Œå‡çº§åŸºäº KubeVela å®è·µé©±åŠ¨ï¼Œä½†æ˜¯å®ƒå¹¶ä¸ç»‘å®š KubeVela å®ç°ã€‚å®ƒæ˜¯ KubeVela åœ¨äº‘åŸç”Ÿåº”ç”¨äº¤ä»˜å’Œç®¡ç†å±‚é¢å®è·µç»éªŒçš„æ€»ç»“å’ŒæŠ½è±¡ï¼Œæ˜¯åˆ›é€ è§„èŒƒåŒ–åº”ç”¨ç®¡ç†ä½“ç³»çš„æœ€ä½³å®è·µå’Œæ ¸å¿ƒç†å¿µã€‚æˆ‘ä»¬éå¸¸æ¬¢è¿äº‘å‚å•†ã€å¹³å°å‚å•†ã€æœ€ç»ˆç”¨æˆ·å¯ä»¥å‚ä¸è¿›æ¥ï¼ŒåŒæ—¶æˆ‘ä»¬ä¹Ÿæ¬£å–œçš„çœ‹åˆ°å›½å†…åŒ…æ‹¬è…¾è®¯åœ¨å†…çš„å¤šå®¶å‚å•†å¯¹ OAM åº”ç”¨è§„èŒƒçš„å…³æ³¨å’Œæ”¯æŒã€‚ä»»ä½•äººã€ç»„ç»‡éƒ½å¯ä»¥å‘è¡¨ä½ çš„æƒ³æ³•ã€å»ºè®®å’Œæ€è€ƒã€‚</p><p>è®¿é—®ï¼Œ<a href="https://github.com/oam-dev/spec" target="_blank" rel="noopener noreferrer">å‚ä¸ OAM æ¨¡å‹è®¨è®º</a>ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å…±å»º-addon-æ‰©å±•ç”Ÿæ€"></a>å…±å»º Addon æ‰©å±•ç”Ÿæ€<a class="hash-link" href="#å…±å»º-addon-æ‰©å±•ç”Ÿæ€" title="Direct link to heading">#</a></h3><p>å¦‚ä¸Šæ–‡ä»‹ç»çš„ä¸€æ ·ï¼Œæˆ‘ä»¬å·²ç»å¼€å¯äº† Addon çš„æ‰©å±•ä½“ç³»ï¼Œéå¸¸æ¬¢è¿ç¤¾åŒºçš„åˆ›é€ è€…ã€å¼€å‘è€…å¯ä»¥æ¥è´¡çŒ®æ›´å¤šçš„æ‰©å±•èƒ½åŠ›ã€‚</p><p>è®¿é—®ï¼Œ<a href="https://kubevela.net/zh/docs/platform-engineers/addon/intro" target="_blank" rel="noopener noreferrer">å¦‚ä½•æ‰©å±•å’Œè´¡çŒ® Addon å‚è€ƒæ–‡æ¡£</a>ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="è´¡çŒ®äº‘æœåŠ¡èƒ½åŠ›"></a>è´¡çŒ®äº‘æœåŠ¡èƒ½åŠ›<a class="hash-link" href="#è´¡çŒ®äº‘æœåŠ¡èƒ½åŠ›" title="Direct link to heading">#</a></h3><p>KubeVela é€šè¿‡é›†æˆ Terraform Module æ¥æ‰©å±•äº‘æœåŠ¡é›†æˆèƒ½åŠ›ï¼Œæˆ‘ä»¬å·²ç»æ”¯æŒäº† <a href="https://kubevela.io/zh/docs/end-user/components/cloud-services/provider-and-consume-cloud-services#%E6%94%AF%E6%8C%81%E7%9A%84%E4%BA%91%E8%B5%84%E6%BA%90%E5%88%97%E8%A1%A8" target="_blank" rel="noopener noreferrer">å¸¸ç”¨çš„äº‘èµ„æº</a> ï¼Œæ¬¢è¿ç¤¾åŒºæœ‹å‹å‚è€ƒå¹¶è´¡çŒ®æ›´å¤šçš„äº‘æœåŠ¡å‚å•†å’Œäº§å“ã€‚</p><p>è®¿é—®ï¼Œ<a href="https://kubevela.net/zh/docs/platform-engineers/components/component-terraform" target="_blank" rel="noopener noreferrer">å¦‚ä½•æ‰©å±•å’Œè´¡çŒ®äº‘èµ„æº</a>ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="åé¦ˆä½ çš„éœ€æ±‚æˆ–ç—›ç‚¹"></a>åé¦ˆä½ çš„éœ€æ±‚æˆ–ç—›ç‚¹<a class="hash-link" href="#åé¦ˆä½ çš„éœ€æ±‚æˆ–ç—›ç‚¹" title="Direct link to heading">#</a></h3><p>æˆ–è®¸ä½ æ˜¯æ™®é€šå¼€å‘è€…ï¼Œä¹Ÿæˆ–è®¸ä½ æ˜¯äº‘åŸç”Ÿé¢†åŸŸçš„ä»ä¸šè€…ï¼Œå¦‚æœä½ è®¤å¯æˆ‘ä»¬çš„æ–¹å‘ï¼Œè®¤å¯æˆ‘ä»¬æ­£åœ¨åšçš„äº‹æƒ…ï¼Œæˆ‘ä»¬éå¸¸æ¬¢è¿ä½ å¯ä»¥å‚ä¸åˆ° KubeVela ç¤¾åŒºè®¨è®ºä¸­æ¥ã€‚</p><p>è®¿é—®ï¼Œ<a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer">å‚ä¸ç¤¾åŒºè®¨è®º</a>ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="kubevela-ç½‘ç«™åŠ é€Ÿè®¿é—®"></a>KubeVela ç½‘ç«™åŠ é€Ÿè®¿é—®<a class="hash-link" href="#kubevela-ç½‘ç«™åŠ é€Ÿè®¿é—®" title="Direct link to heading">#</a></h3><p>KubeVela çš„å®˜æ–¹æ–‡æ¡£æ‰˜ç®¡åœ¨ <a href="https://github.com/oam-dev/kubevela.io" target="_blank" rel="noopener noreferrer">GitHub kubevela.io</a> ä¸Šï¼Œå¦‚æœä½ å‘ç°æœ‰ä»»ä½•é”™æ¼æˆ–è€…æƒ³è¦å‚ä¸ç¿»è¯‘ï¼Œæ¬¢è¿ç›´æ¥åˆ°é¡¹ç›®ä¸­è´¡çŒ®ã€‚åŒæ—¶ä¸ºäº†å›½å†…ç”¨æˆ·å¯ä»¥åŠ é€Ÿè®¿é—®ï¼Œæˆ‘ä»¬å¢åŠ äº† kubevela.net è¿™ä¸ªåŸŸåï¼Œå¯ä»¥æ–¹ä¾¿å›½å†…ç”¨æˆ·æ›´å¿«çš„è®¿é—®ï¼Œå†…å®¹ä¸ kubevela.io çš„åŸŸåå®Œå…¨ä¸€è‡´ã€å®æ—¶åŒæ­¥ã€‚</p><blockquote><p>KubeVela æ˜¯ CNCF æ²™ç®±é¡¹ç›®ï¼Œäº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥é˜…<a href="https://kubevela.io/zh/docs/install" target="_blank" rel="noopener noreferrer">å®˜æ–¹æ–‡æ¡£</a></p></blockquote></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/zh/blog/tags/dev-ops">DevOps</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/zh/blog/2021/10/10/kubevela-gitops">åŸºäº KubeVela çš„ GitOps äº¤ä»˜</a></h2><div class="margin-vert--md"><time datetime="2021-10-10T00:00:00.000Z" class="blogPostDate_fNvV">2021å¹´10æœˆ10æ—¥ Â· é˜…è¯»éœ€è¦ 1 åˆ†é’Ÿ</time></div><div class="avatar margin-vert--md"><a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://kubevela.io/img/logo.svg" alt="Tianxin Dong"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer">Tianxin Dong</a></h4><small class="avatar__subtitle">KubeVela å›¢é˜Ÿ</small></div></div></header><div class="markdown"><p>KubeVela ä½œä¸ºä¸€ä¸ªç®€å•ã€æ˜“ç”¨ã€ä¸”é«˜å¯æ‰©å±•çš„äº‘åŸç”Ÿåº”ç”¨ç®¡ç†å·¥å…·ï¼Œèƒ½è®©å¼€å‘äººå‘˜æ–¹ä¾¿å¿«æ·åœ°åœ¨ Kubernetes ä¸Šå®šä¹‰ä¸äº¤ä»˜ç°ä»£å¾®æœåŠ¡åº”ç”¨ï¼Œæ— éœ€äº†è§£ä»»ä½• Kubernetes åŸºç¡€è®¾æ–½ç›¸å…³çš„ç»†èŠ‚ã€‚</p><p>KubeVela èƒŒåçš„ OAM æ¨¡å‹å¤©ç„¶è§£å†³äº†åº”ç”¨æ„å»ºè¿‡ç¨‹ä¸­å¯¹å¤æ‚èµ„æºçš„ç»„åˆã€ç¼–æ’ç­‰ç®¡ç†é—®é¢˜ï¼ŒåŒæ—¶ä¹Ÿå°†åæœŸçš„è¿ç»´ç­–ç•¥æ¨¡å‹åŒ–ï¼Œè¿™æ„å‘³ç€ KubeVela å¯ä»¥ç»“åˆ GitOps ç®¡ç†å¤æ‚å¤§è§„æ¨¡åº”ç”¨ï¼Œæ”¶æ•›å›¢é˜Ÿä¸ç³»ç»Ÿè§„æ¨¡å˜å¤§ä»¥åçš„ç³»ç»Ÿå¤æ‚åº¦é—®é¢˜ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ä»€ä¹ˆæ˜¯-gitops"></a>ä»€ä¹ˆæ˜¯ GitOps<a class="hash-link" href="#ä»€ä¹ˆæ˜¯-gitops" title="Direct link to heading">#</a></h2><p>GitOps æ˜¯ä¸€ç§ç°ä»£åŒ–çš„æŒç»­äº¤ä»˜æ‰‹æ®µï¼Œå®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šåœ¨æ‹¥æœ‰ä¸€ä¸ªåŒ…å«ç¯å¢ƒåŸºç¡€è®¾æ–½åŠå„ç§åº”ç”¨é…ç½®çš„ Git ä»“åº“ä¸­ï¼Œé…åˆä¸€ä¸ªè‡ªåŠ¨åŒ–è¿‡ç¨‹â€”â€”â€”â€”ä½¿å¾—æ¯æ¬¡ä»“åº“è¢«æ›´æ–°åï¼Œè‡ªåŠ¨åŒ–è¿‡ç¨‹éƒ½èƒ½é€æ¸å°†ç¯å¢ƒæ›´æ–°åˆ°æœ€æ–°é…ç½®ã€‚</p><p>è¿™æ ·çš„æ–¹å¼å…è®¸å¼€å‘äººå‘˜é€šè¿‡ç›´æ¥æ›´æ”¹ Git ä»“åº“ä¸­çš„ä»£ç å’Œé…ç½®æ¥è‡ªåŠ¨éƒ¨ç½²åº”ç”¨ï¼Œä½¿ç”¨ GitOps çš„å¥½å¤„æœ‰å¾ˆå¤šï¼Œå¦‚ï¼š</p><ul><li>æé«˜ç”Ÿäº§æ•ˆç‡ã€‚é€šè¿‡è‡ªåŠ¨çš„æŒç»­éƒ¨ç½²èƒ½å¤ŸåŠ å¿«å¹³å‡éƒ¨ç½²æ—¶é—´ï¼Œå¢åŠ å¼€å‘æ•ˆç‡ã€‚</li><li>é™ä½å¼€å‘äººå‘˜éƒ¨ç½²çš„é—¨æ§›ã€‚é€šè¿‡æ¨é€ä»£ç è€Œéå®¹å™¨é…ç½®ï¼Œå¼€å‘äººå‘˜å¯ä»¥ä¸éœ€è¦äº†è§£ Kubernetes çš„å†…éƒ¨å®ç°ï¼Œä¾¿å¯ä»¥è½»æ˜“éƒ¨ç½²ã€‚</li><li>ä½¿å˜æ›´è®°å½•å¯è¿½è¸ªã€‚é€šè¿‡ Git æ¥ç®¡ç†é›†ç¾¤ï¼Œå¯ä»¥ä½¿æ¯ä¸€æ¬¡æ›´æ”¹éƒ½å¯è¿½è¸ªï¼ŒåŠ å¼ºäº†å®¡è®¡è·Ÿè¸ªã€‚</li><li>å¯é€šè¿‡ Git çš„å›æ»š/åˆ†æ”¯åŠŸèƒ½æ¥æ¢å¤é›†ç¾¤ã€‚</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="kubevela-ä¸-gitops"></a>KubeVela ä¸ GitOps<a class="hash-link" href="#kubevela-ä¸-gitops" title="Direct link to heading">#</a></h2><p>KubeVela ä½œä¸ºä¸€ä¸ªå£°æ˜å¼çš„åº”ç”¨äº¤ä»˜æ§åˆ¶å¹³é¢ï¼Œå¤©ç„¶å°±å¯ä»¥ä»¥ GitOps çš„æ–¹å¼è¿›è¡Œä½¿ç”¨ï¼Œå¹¶ä¸”è¿™æ ·åšä¼šåœ¨ GitOps çš„åŸºç¡€ä¸Šä¸ºç”¨æˆ·æä¾›æ›´å¤šçš„ç›Šå¤„å’Œç«¯åˆ°ç«¯çš„ä½“éªŒï¼ŒåŒ…æ‹¬ï¼š</p><ul><li>åº”ç”¨äº¤ä»˜å·¥ä½œæµï¼ˆCD æµæ°´çº¿ï¼‰<ul><li>å³ï¼šKubeVela æ”¯æŒåœ¨ GitOps æ¨¡å¼ä¸­æè¿°è¿‡ç¨‹å¼çš„åº”ç”¨äº¤ä»˜ï¼Œè€Œä¸åªæ˜¯ç®€å•çš„å£°æ˜ç»ˆæ€ï¼›</li></ul></li><li>å¤„ç†éƒ¨ç½²è¿‡ç¨‹ä¸­çš„å„ç§ä¾èµ–å…³ç³»å’Œæ‹“æ‰‘ç»“æ„ï¼›</li><li>åœ¨ç°æœ‰å„ç§ GitOps å·¥å…·çš„è¯­ä¹‰ä¹‹ä¸Šæä¾›ç»Ÿä¸€çš„ä¸Šå±‚æŠ½è±¡ï¼Œç®€åŒ–åº”ç”¨äº¤ä»˜ä¸ç®¡ç†è¿‡ç¨‹ï¼›</li><li>ç»Ÿä¸€è¿›è¡Œäº‘æœåŠ¡çš„å£°æ˜ã€éƒ¨ç½²å’ŒæœåŠ¡ç»‘å®šï¼›</li><li>æä¾›å¼€ç®±å³ç”¨çš„äº¤ä»˜ç­–ç•¥ï¼ˆé‡‘ä¸é›€ã€è“ç»¿å‘å¸ƒç­‰ï¼‰ï¼›</li><li>æä¾›å¼€ç®±å³ç”¨çš„æ··åˆäº‘/å¤šäº‘éƒ¨ç½²ç­–ç•¥ï¼ˆæ”¾ç½®è§„åˆ™ã€é›†ç¾¤è¿‡æ»¤è§„åˆ™ç­‰ï¼‰ï¼›</li><li>åœ¨å¤šç¯å¢ƒäº¤ä»˜ä¸­æä¾› Kustomize é£æ ¼çš„ Patch æ¥æè¿°éƒ¨ç½²å·®å¼‚ï¼Œè€Œæ— éœ€å­¦ä¹ ä»»ä½• Kustomize æœ¬èº«çš„ç»†èŠ‚ï¼›</li><li>â€¦â€¦ ä»¥åŠæ›´å¤šã€‚</li></ul><p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦è®²è§£ç›´æ¥ä½¿ç”¨ KubeVela åœ¨ GitOps æ¨¡å¼ä¸‹è¿›è¡Œäº¤ä»˜çš„æ­¥éª¤ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="gitops-å·¥ä½œæµ"></a>GitOps å·¥ä½œæµ<a class="hash-link" href="#gitops-å·¥ä½œæµ" title="Direct link to heading">#</a></h2><p>GitOps å·¥ä½œæµåˆ†ä¸º CI å’Œ CD ä¸¤ä¸ªéƒ¨åˆ†ï¼š</p><ul><li>CIï¼ˆContinuous Integrationï¼‰ï¼šæŒç»­é›†æˆå¯¹ä¸šåŠ¡ä»£ç è¿›è¡Œä»£ç æ„å»ºã€æ„å»ºé•œåƒå¹¶æ¨é€è‡³é•œåƒä»“åº“ã€‚ç›®å‰æœ‰è®¸å¤šæˆç†Ÿçš„ CI å·¥å…·ï¼šå¦‚å¼€æºé¡¹ç›®å¸¸ç”¨çš„ GitHub Actionã€Travis ç­‰ï¼Œä»¥åŠä¼ä¸šä¸­å¸¸ç”¨çš„ Jenkinsã€Tekton ç­‰ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ GitHub Action æ¥å®Œæˆ CI è¿™ä¸€æ­¥ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨åˆ«çš„ CI å·¥å…·æ¥ä»£æ›¿æ­¤æ­¥ï¼ŒKubeVela å›´ç»• GitOps å¯ä»¥å¯¹æ¥ä»»æ„å·¥å…·ä¸‹çš„ CI æµç¨‹ã€‚</li><li>CDï¼ˆContinuous Deliveryï¼‰ï¼šæŒç»­éƒ¨ç½²ä¼šè‡ªåŠ¨æ›´æ–°é›†ç¾¤ä¸­çš„é…ç½®ï¼Œå¦‚å°†é•œåƒä»“åº“ä¸­çš„æœ€æ–°é•œåƒæ›´æ–°åˆ°é›†ç¾¤ä¸­ã€‚<ul><li>ç›®å‰ä¸»è¦æœ‰ä¸¤ç§æ–¹æ¡ˆçš„ CDï¼š<ul><li>Push-Basedï¼šPush æ¨¡å¼çš„ CD ä¸»è¦æ˜¯é€šè¿‡é…ç½® CI æµæ°´çº¿æ¥å®Œæˆçš„ï¼Œè¿™ç§æ–¹å¼éœ€è¦å°†é›†ç¾¤çš„è®¿é—®ç§˜é’¥å…±äº«ç»™ CIï¼Œä»è€Œä½¿å¾— CI æµæ°´çº¿èƒ½å¤Ÿé€šè¿‡å‘½ä»¤å°†æ›´æ”¹æ¨é€åˆ°é›†ç¾¤ä¸­ã€‚è¿™ç§æ–¹å¼çš„é›†æˆå¯ä»¥å‚è€ƒæˆ‘ä»¬ä¹‹å‰å‘è¡¨çš„åšå®¢ï¼š<a href="/zh/blog/2021/09/02/kubevela-jenkins-cicd">ä½¿ç”¨ Jenkins + KubeVela å®Œæˆåº”ç”¨çš„æŒç»­äº¤ä»˜</a>ã€‚</li><li>Pull-Basedï¼šPull æ¨¡å¼çš„ CD ä¼šåœ¨é›†ç¾¤ä¸­ç›‘å¬ä»“åº“ï¼ˆä»£ç ä»“åº“æˆ–è€…é…ç½®ä»“åº“ï¼‰çš„å˜åŒ–ï¼Œå¹¶ä¸”å°†è¿™äº›å˜åŒ–åŒæ­¥åˆ°é›†ç¾¤ä¸­ã€‚è¿™ç§æ–¹å¼ä¸ Push æ¨¡å¼ç›¸æ¯”ï¼Œç”±é›†ç¾¤ä¸»åŠ¨æ‹‰å–æ›´æ–°ï¼Œä»è€Œé¿å…äº†ç§˜é’¥æš´éœ²çš„é—®é¢˜ã€‚è¿™ä¹Ÿæ˜¯æœ¬æ–‡ä»‹ç»çš„æ ¸å¿ƒå†…å®¹ã€‚</li></ul></li></ul></li></ul><p>äº¤ä»˜çš„é¢å‘äººå‘˜æœ‰ä»¥ä¸‹ä¸¤ç§ï¼Œæˆ‘ä»¬å°†åˆ†åˆ«ä»‹ç»ï¼š</p><ol><li>é¢å‘å¹³å°ç®¡ç†å‘˜/è¿ç»´äººå‘˜çš„åŸºç¡€è®¾æ–½äº¤ä»˜ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ç›´æ¥æ›´æ–°ä»“åº“ä¸­çš„é…ç½®æ–‡ä»¶ï¼Œä»è€Œæ›´æ–°é›†ç¾¤ä¸­çš„åŸºç¡€è®¾æ–½é…ç½®ï¼Œå¦‚ç³»ç»Ÿçš„ä¾èµ–è½¯ä»¶ã€å®‰å…¨ç­–ç•¥ã€å­˜å‚¨ã€ç½‘ç»œç­‰åŸºç¡€è®¾æ–½é…ç½®ã€‚</li><li>é¢å‘ç»ˆç«¯å¼€å‘è€…çš„äº¤ä»˜ï¼Œç”¨æˆ·çš„ä»£ç ä¸€æ—¦åˆå¹¶åˆ°åº”ç”¨ä»£ç ä»“åº“ï¼Œå°±è‡ªåŠ¨åŒ–è§¦å‘é›†ç¾¤ä¸­åº”ç”¨çš„æ›´æ–°ï¼Œå¯ä»¥æ›´é«˜æ•ˆçš„å®Œæˆåº”ç”¨çš„è¿­ä»£ï¼Œä¸ KubeVela çš„ç°åº¦å‘å¸ƒã€æµé‡è°ƒæ‹¨ã€å¤šé›†ç¾¤éƒ¨ç½²ç­‰åŠŸèƒ½ç»“åˆå¯ä»¥å½¢æˆæ›´ä¸ºå¼ºå¤§çš„è‡ªåŠ¨åŒ–å‘å¸ƒèƒ½åŠ›ã€‚</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="é¢å‘å¹³å°ç®¡ç†å‘˜è¿ç»´äººå‘˜çš„äº¤ä»˜"></a>é¢å‘å¹³å°ç®¡ç†å‘˜/è¿ç»´äººå‘˜çš„äº¤ä»˜<a class="hash-link" href="#é¢å‘å¹³å°ç®¡ç†å‘˜è¿ç»´äººå‘˜çš„äº¤ä»˜" title="Direct link to heading">#</a></h2><p>å¦‚å›¾æ‰€ç¤ºï¼Œå¯¹äºå¹³å°ç®¡ç†å‘˜/è¿ç»´äººå‘˜è€Œè¨€ï¼Œä»–ä»¬å¹¶ä¸éœ€è¦å…³å¿ƒåº”ç”¨çš„ä»£ç ï¼Œæ‰€ä»¥åªéœ€è¦å‡†å¤‡ä¸€ä¸ª Git é…ç½®ä»“åº“å¹¶éƒ¨ç½² KubeVela é…ç½®æ–‡ä»¶ï¼Œåç»­å¯¹äºåº”ç”¨åŠåŸºç¡€è®¾æ–½çš„é…ç½®å˜åŠ¨ï¼Œä¾¿å¯é€šè¿‡ç›´æ¥æ›´æ–° Git é…ç½®ä»“åº“æ¥å®Œæˆï¼Œä½¿å¾—æ¯ä¸€æ¬¡é…ç½®å˜æ›´å¯è¿½è¸ªã€‚</p><p><img alt="alt" src="/zh/assets/images/ops-flow-8bec0d06df6baf12234cfe6c18bff438.jpg"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å‡†å¤‡é…ç½®ä»“åº“"></a>å‡†å¤‡é…ç½®ä»“åº“<a class="hash-link" href="#å‡†å¤‡é…ç½®ä»“åº“" title="Direct link to heading">#</a></h3><blockquote><p>å…·ä½“çš„é…ç½®å¯å‚è€ƒ <a href="https://github.com/oam-dev/samples/tree/master/09.GitOps_Demo/for-SREs" target="_blank" rel="noopener noreferrer">ç¤ºä¾‹ä»“åº“</a>ã€‚</p></blockquote><p>åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†éƒ¨ç½²ä¸€ä¸ª MySQL æ•°æ®åº“è½¯ä»¶ä½œä¸ºé¡¹ç›®çš„åŸºç¡€è®¾æ–½ï¼ŒåŒæ—¶éƒ¨ç½²ä¸€ä¸ªä¸šåŠ¡åº”ç”¨ï¼Œä½¿ç”¨è¿™ä¸ªæ•°æ®åº“ã€‚é…ç½®ä»“åº“çš„ç›®å½•ç»“æ„å¦‚ä¸‹:</p><ul><li><code>clusters/</code> ä¸­åŒ…å«é›†ç¾¤ä¸­çš„ KubeVela GitOps é…ç½®ï¼Œç”¨æˆ·éœ€è¦å°† <code>clusters/</code> ä¸­çš„æ–‡ä»¶æ‰‹åŠ¨éƒ¨ç½²åˆ°é›†ç¾¤ä¸­ã€‚è¿™ä¸ªæ˜¯ä¸€æ¬¡æ€§çš„ç®¡æ§æ“ä½œï¼Œæ‰§è¡Œå®Œæˆåï¼ŒKubeVela ä¾¿èƒ½è‡ªåŠ¨ç›‘å¬é…ç½®ä»“åº“ä¸­çš„æ–‡ä»¶å˜åŠ¨ä¸”è‡ªåŠ¨æ›´æ–°é›†ç¾¤ä¸­çš„é…ç½®ã€‚å…¶ä¸­ï¼Œ<code>clusters/apps.yaml</code> å°†ç›‘å¬ <code>apps/</code> ä¸‹æ‰€æœ‰åº”ç”¨çš„å˜åŒ–ï¼Œ<code>clusters/infra.yaml</code> å°†ç›‘å¬ <code>infrastructure/</code> ä¸‹æ‰€æœ‰åŸºç¡€è®¾æ–½çš„å˜åŒ–ã€‚</li><li><code>apps/</code> ç›®å½•ä¸­åŒ…å«ä¸šåŠ¡åº”ç”¨çš„æ‰€æœ‰é…ç½®ï¼Œåœ¨æœ¬ä¾‹ä¸­ä¸ºä¸€ä¸ªä½¿ç”¨æ•°æ®åº“çš„ä¸šåŠ¡åº”ç”¨ã€‚</li><li><code>infrastructure/</code> ä¸­åŒ…å«ä¸€äº›åŸºç¡€è®¾æ–½ç›¸å…³çš„é…ç½®å’Œç­–ç•¥ï¼Œåœ¨æœ¬ä¾‹ä¸­ä¸º MySQL æ•°æ®åº“ã€‚</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ apps</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚Â Â  â””â”€â”€ my-app.yaml</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ clusters</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚Â Â  â”œâ”€â”€ apps.yaml</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚Â Â  â””â”€â”€ infra.yaml</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">â””â”€â”€ infrastructure</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    â””â”€â”€ mysql.yaml</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><blockquote><p>KubeVela å»ºè®®ä½¿ç”¨å¦‚ä¸Šçš„ç›®å½•ç»“æ„ç®¡ç†ä½ çš„ GitOps ä»“åº“ã€‚<code>clusters/</code> ä¸­å­˜æ”¾ç›¸å…³çš„ KubeVela GitOps é…ç½®å¹¶éœ€è¦è¢«æ‰‹åŠ¨éƒ¨ç½²åˆ°é›†ç¾¤ä¸­ï¼Œ<code>apps/</code> å’Œ <code>infrastructure/</code> ä¸­åˆ†åˆ«å­˜æ”¾ä½ çš„åº”ç”¨å’ŒåŸºç¡€è®¾æ–½é…ç½®ã€‚é€šè¿‡æŠŠåº”ç”¨å’ŒåŸºç¡€é…ç½®åˆ†å¼€ï¼Œèƒ½å¤Ÿæ›´ä¸ºåˆç†çš„ç®¡ç†ä½ çš„éƒ¨ç½²ç¯å¢ƒï¼Œéš”ç¦»åº”ç”¨çš„å˜åŠ¨å½±å“ã€‚</p></blockquote><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="clusters-ç›®å½•"></a><code>clusters/</code> ç›®å½•<a class="hash-link" href="#clusters-ç›®å½•" title="Direct link to heading">#</a></h4><p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹ clusters ç›®å½•ï¼Œè¿™ä¹Ÿæ˜¯ KubeVela å¯¹æ¥ GitOps çš„åˆå§‹åŒ–æ“ä½œé…ç½®ç›®å½•ã€‚</p><p>ä»¥ <code>clusters/infra.yaml</code> ä¸ºä¾‹ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> core.oam.dev/v1beta1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Application</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> infra</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">components</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> database</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">config</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> kustomize</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">repoType</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> git</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># å°†æ­¤å¤„æ›¿æ¢æˆä½ éœ€è¦ç›‘å¬çš„ git é…ç½®ä»“åº“åœ°å€</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">url</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> https</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">//github.com/FogDong/KubeVela</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">GitOps</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">Infra</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">Demo</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># å¦‚æœæ˜¯ç§æœ‰ä»“åº“ï¼Œè¿˜éœ€è¦å…³è” git secret</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># secretRef: git-secret</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># è‡ªåŠ¨æ‹‰å–é…ç½®çš„æ—¶é—´é—´éš”ï¼Œç”±äºåŸºç¡€è®¾æ–½çš„å˜åŠ¨æ€§è¾ƒå°ï¼Œæ­¤å¤„è®¾ç½®ä¸ºååˆ†é’Ÿ</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">pullInterval</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> 10m</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">git</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)"># ç›‘å¬å˜åŠ¨çš„åˆ†æ”¯</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">branch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> main</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># ç›‘å¬å˜åŠ¨çš„è·¯å¾„ï¼ŒæŒ‡å‘ä»“åº“ä¸­ infrastructure ç›®å½•ä¸‹çš„æ–‡ä»¶</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ./infrastructure</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><code>apps.yaml</code> ä¸ <code>infra.yaml</code> å‡ ä¹ä¿æŒä¸€è‡´ï¼Œåªä¸è¿‡ç›‘å¬çš„æ–‡ä»¶ç›®å½•æœ‰æ‰€åŒºåˆ«ã€‚
åœ¨ <code>apps.yaml</code> ä¸­ï¼Œ<code>properties.path</code> çš„å€¼å°†æ”¹ä¸º <code>./apps</code>ï¼Œè¡¨æ˜ç›‘å¬ <code>apps/</code> ç›®å½•ä¸‹çš„æ–‡ä»¶å˜åŠ¨ã€‚</p><p>cluster æ–‡ä»¶å¤¹ä¸­çš„ GitOps ç®¡æ§é…ç½®æ–‡ä»¶éœ€è¦åœ¨åˆå§‹åŒ–çš„æ—¶å€™ä¸€æ¬¡æ€§æ‰‹åŠ¨éƒ¨ç½²åˆ°é›†ç¾¤ä¸­ï¼Œåœ¨æ­¤ä¹‹å KubeVela å°†è‡ªåŠ¨ç›‘å¬ <code>apps/</code> ä»¥åŠ <code>infrastructure/</code> ç›®å½•ä¸‹çš„é…ç½®æ–‡ä»¶å¹¶å®šæœŸæ›´æ–°åŒæ­¥ã€‚</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="apps-ç›®å½•"></a><code>apps/</code> ç›®å½•<a class="hash-link" href="#apps-ç›®å½•" title="Direct link to heading">#</a></h4><p><code>apps/</code> ç›®å½•ä¸­å­˜æ”¾ç€åº”ç”¨é…ç½®æ–‡ä»¶ï¼Œè¿™æ˜¯ä¸€ä¸ªé…ç½®äº†æ•°æ®åº“ä¿¡æ¯ä»¥åŠ Ingress çš„ç®€å•åº”ç”¨ã€‚è¯¥åº”ç”¨å°†è¿æ¥åˆ°ä¸€ä¸ª MySQL æ•°æ®åº“ï¼Œå¹¶ç®€å•åœ°å¯åŠ¨æœåŠ¡ã€‚åœ¨é»˜è®¤çš„æœåŠ¡è·¯å¾„ä¸‹ï¼Œä¼šæ˜¾ç¤ºå½“å‰ç‰ˆæœ¬å·ã€‚åœ¨ <code>/db</code> è·¯å¾„ä¸‹ï¼Œä¼šåˆ—å‡ºå½“å‰æ•°æ®åº“ä¸­çš„ä¿¡æ¯ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> core.oam.dev/v1beta1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Application</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> default</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">components</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">server</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> webservice</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ghcr.io/fogdong/test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">fog</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">master</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">cba5605f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token number">1632714412</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">8088</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">env</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> DB_HOST</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> mysql</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">cluster</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">mysql.default.svc.cluster.local</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">3306</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> DB_PASSWORD</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">valueFrom</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">              </span><span class="token key atrule">secretKeyRef</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> mysql</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">secret</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token key atrule">key</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ROOT_PASSWORD</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">traits</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ingress</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">domain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> testsvc.example.com</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">              </span><span class="token key atrule">/</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">8088</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨äº† KubeVela å†…ç½®ç»„ä»¶ç±»å‹ <code>webservice</code> çš„åº”ç”¨ï¼Œè¯¥åº”ç”¨ç»‘å®šäº† Ingress è¿ç»´ç‰¹å¾ã€‚é€šè¿‡åœ¨åº”ç”¨ä¸­å£°æ˜è¿ç»´èƒ½åŠ›çš„æ–¹å¼ï¼Œåªéœ€ä¸€ä¸ªæ–‡ä»¶ï¼Œä¾¿èƒ½å°†åº•å±‚çš„ Deploymentã€Serviceã€Ingress é›†åˆèµ·æ¥ï¼Œä»è€Œæ›´ä¸ºä¾¿æ·åœ°ç®¡ç†åº”ç”¨ã€‚</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="infrastructure-ç›®å½•"></a><code>infrastructure/</code> ç›®å½•<a class="hash-link" href="#infrastructure-ç›®å½•" title="Direct link to heading">#</a></h4><p><code>infrastructure/</code> ç›®å½•ä¸‹å­˜æ”¾ä¸€äº›åŸºç¡€è®¾æ–½çš„é…ç½®ã€‚æ­¤å¤„æˆ‘ä»¬ä½¿ç”¨ <a href="https://github.com/bitpoke/mysql-operator" target="_blank" rel="noopener noreferrer">mysql controller</a> æ¥éƒ¨ç½²äº†ä¸€ä¸ª MySQL é›†ç¾¤ã€‚</p><blockquote><p>æ³¨æ„ï¼Œè¯·ç¡®ä¿ä½ çš„é›†ç¾¤ä¸­æœ‰ä¸€ä¸ª secretï¼Œå¹¶é€šè¿‡ <code>ROOT_PASSWORD</code> å£°æ˜äº† MySQL å¯†ç ã€‚</p></blockquote><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> core.oam.dev/v1beta1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Application</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> mysql</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> default</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">components</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> mysql</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">controller</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> helm</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">repoType</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> helm</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">url</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> https</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">//presslabs.github.io/charts</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">chart</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> mysql</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">operator</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">version</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0.4.0&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> mysql</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">cluster</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> raw</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">dependsOn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> mysql</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">controller</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> mysql.presslabs.org/v1alpha1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> MysqlCluster</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> mysql</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">cluster</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">replicas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token comment" style="color:rgb(98, 114, 164)"># å…³è” secret åç§°</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">secretName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> mysql</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">secret</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>åœ¨è¿™ä¸ª MySQL åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† KubeVela å·¥ä½œæµçš„èƒ½åŠ›ã€‚å·¥ä½œæµåˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼Œç¬¬ä¸€ä¸ªæ­¥éª¤ä¼šå»éƒ¨ç½² MySQL çš„ controllerã€‚å½“ controller éƒ¨ç½²æˆåŠŸä¸”æ­£ç¡®è¿è¡Œåï¼Œç¬¬äºŒä¸ªæ­¥éª¤å°†å¼€å§‹éƒ¨ç½² MySQL é›†ç¾¤ã€‚</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="éƒ¨ç½²-clusters-ç›®å½•ä¸‹çš„æ–‡ä»¶"></a>éƒ¨ç½² <code>clusters/</code> ç›®å½•ä¸‹çš„æ–‡ä»¶<a class="hash-link" href="#éƒ¨ç½²-clusters-ç›®å½•ä¸‹çš„æ–‡ä»¶" title="Direct link to heading">#</a></h4><p>é…ç½®å®Œä»¥ä¸Šæ–‡ä»¶å¹¶å­˜æ”¾åˆ° Git é…ç½®ä»“åº“åï¼Œæˆ‘ä»¬éœ€è¦åœ¨é›†ç¾¤ä¸­æ‰‹åŠ¨éƒ¨ç½² <code>clusters/</code> ç›®å½•ä¸‹çš„ KubeVela GitOps é…ç½®æ–‡ä»¶ã€‚</p><p>é¦–å…ˆï¼Œåœ¨é›†ç¾¤ä¸­éƒ¨ç½² <code>clusters/infra.yaml</code>ã€‚å¯ä»¥çœ‹åˆ°å®ƒè‡ªåŠ¨åœ¨é›†ç¾¤ä¸­æ‹‰èµ·äº† <code>infrastructure/</code> ç›®å½•ä¸‹çš„ MySQL éƒ¨ç½²æ–‡ä»¶ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl apply -f clusters/infra.yaml</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ vela </span><span class="token function" style="color:rgb(80, 250, 123)">ls</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">APP     COMPONENT           TYPE        TRAITS  PHASE   HEALTHY STATUS  CREATED-TIME</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">infra   database-config     kustomize           running healthy         </span><span class="token number">2021</span><span class="token plain">-09-26 </span><span class="token number">20</span><span class="token plain">:48:09 +0800 CST</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">mysql   mysql-controller    helm                running healthy         </span><span class="token number">2021</span><span class="token plain">-09-26 </span><span class="token number">20</span><span class="token plain">:48:11 +0800 CST</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">â””â”€      mysql-cluster       raw                 running healthy         </span><span class="token number">2021</span><span class="token plain">-09-26 </span><span class="token number">20</span><span class="token plain">:48:11 +0800 CST</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æ¥ç€ï¼Œåœ¨é›†ç¾¤ä¸­éƒ¨ç½² <code>clusters/apps.yaml</code>ï¼Œå¯ä»¥çœ‹åˆ°å®ƒè‡ªåŠ¨æ‹‰èµ·äº† <code>apps/</code> ç›®å½•ä¸‹çš„åº”ç”¨éƒ¨ç½²æ–‡ä»¶ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl apply -f clusters/apps.yaml</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">APP     COMPONENT           TYPE        TRAITS  PHASE   HEALTHY STATUS  CREATED-TIME</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">apps    apps                kustomize           running healthy         </span><span class="token number">2021</span><span class="token plain">-09-27 </span><span class="token number">16</span><span class="token plain">:55:53 +0800 CST</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">infra   database-config     kustomize           running healthy         </span><span class="token number">2021</span><span class="token plain">-09-26 </span><span class="token number">20</span><span class="token plain">:48:09 +0800 CST</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">my-app  my-server           webservice  ingress running healthy         </span><span class="token number">2021</span><span class="token plain">-09-27 </span><span class="token number">16</span><span class="token plain">:55:55 +0800 CST</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">mysql   mysql-controller    helm                running healthy         </span><span class="token number">2021</span><span class="token plain">-09-26 </span><span class="token number">20</span><span class="token plain">:48:11 +0800 CST</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">â””â”€      mysql-cluster       raw                 running healthy         </span><span class="token number">2021</span><span class="token plain">-09-26 </span><span class="token number">20</span><span class="token plain">:48:11 +0800 CST</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>è‡³æ­¤ï¼Œæˆ‘ä»¬é€šè¿‡éƒ¨ç½² KubeVela GitOps é…ç½®æ–‡ä»¶ï¼Œè‡ªåŠ¨åœ¨é›†ç¾¤ä¸­æ‹‰èµ·äº†åº”ç”¨åŠæ•°æ®åº“ã€‚</p><p>é€šè¿‡ curl åº”ç”¨çš„ Ingressï¼Œå¯ä»¥çœ‹åˆ°ç›®å‰çš„ç‰ˆæœ¬æ˜¯ 0.1.5ï¼Œå¹¶ä¸”æˆåŠŸåœ°è¿æ¥åˆ°äº†æ•°æ®åº“ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ kubectl get ingress</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">NAME        CLASS    HOSTS                 ADDRESS         PORTS   AGE</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">my-server   </span><span class="token operator">&lt;</span><span class="token plain">none</span><span class="token operator">&gt;</span><span class="token plain">   testsvc.example.com   </span><span class="token operator">&lt;</span><span class="token plain">ingress-ip</span><span class="token operator">&gt;</span><span class="token plain">    </span><span class="token number">80</span><span class="token plain">      162m</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> -H </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Host:testsvc.example.com&quot;</span><span class="token plain"> http://</span><span class="token operator">&lt;</span><span class="token plain">ingress-ip</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Version: </span><span class="token number">0.1</span><span class="token plain">.5</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> -H </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Host:testsvc.example.com&quot;</span><span class="token plain"> http://</span><span class="token operator">&lt;</span><span class="token plain">ingress-ip</span><span class="token operator">&gt;</span><span class="token plain">/db</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">User: KubeVela</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Description: It&#x27;s a </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">test</span><span class="token plain"> user</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ä¿®æ”¹é…ç½®"></a>ä¿®æ”¹é…ç½®<a class="hash-link" href="#ä¿®æ”¹é…ç½®" title="Direct link to heading">#</a></h3><p>å®Œæˆäº†é¦–æ¬¡éƒ¨ç½²åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®ä»“åº“ä¸­çš„é…ç½®ï¼Œæ¥å®Œæˆé›†ç¾¤ä¸­åº”ç”¨çš„é…ç½®æ›´æ–°ã€‚</p><p>ä¿®æ”¹åº”ç”¨ Ingress çš„ Domainï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">...</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">traits</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ingress</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">domain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> kubevela.example.com</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">              </span><span class="token key atrule">/</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">8089</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ç»è¿‡ä¸€æ®µæ—¶é—´åï¼Œé‡æ–°æŸ¥çœ‹é›†ç¾¤ä¸­çš„ Ingressï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">NAME        CLASS    HOSTS                 ADDRESS         PORTS   AGE</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">my-server   </span><span class="token operator">&lt;</span><span class="token plain">none</span><span class="token operator">&gt;</span><span class="token plain">   kubevela.example.com  </span><span class="token operator">&lt;</span><span class="token plain">ingress-ip</span><span class="token operator">&gt;</span><span class="token plain">    </span><span class="token number">80</span><span class="token plain">      162m</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>å¯ä»¥çœ‹åˆ°ï¼ŒIngress çš„ Host åœ°å€å·²è¢«æˆåŠŸæ›´æ–°ã€‚</p><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥æ–¹ä¾¿åœ°é€šè¿‡æ›´æ–° Git é…ç½®ä»“åº“ä¸­çš„æ–‡ä»¶ï¼Œä»è€Œè‡ªåŠ¨åŒ–æ›´æ–°é›†ç¾¤ä¸­çš„é…ç½®ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="é¢å‘ç»ˆç«¯å¼€å‘è€…çš„äº¤ä»˜"></a>é¢å‘ç»ˆç«¯å¼€å‘è€…çš„äº¤ä»˜<a class="hash-link" href="#é¢å‘ç»ˆç«¯å¼€å‘è€…çš„äº¤ä»˜" title="Direct link to heading">#</a></h2><p>å¦‚å›¾æ‰€ç¤ºï¼Œå¯¹äºç»ˆç«¯å¼€å‘è€…è€Œè¨€ï¼Œåœ¨ KubeVela Git é…ç½®ä»“åº“ä»¥å¤–ï¼Œè¿˜éœ€è¦å‡†å¤‡ä¸€ä¸ªåº”ç”¨ä»£ç ä»“åº“ã€‚åœ¨ç”¨æˆ·æ›´æ–°äº†åº”ç”¨ä»£ç ä»“åº“ä¸­çš„ä»£ç åï¼Œéœ€è¦é…ç½®ä¸€ä¸ª CI æ¥è‡ªåŠ¨æ„å»ºé•œåƒå¹¶æ¨é€è‡³é•œåƒä»“åº“ä¸­ã€‚KubeVela ä¼šç›‘å¬é•œåƒä»“åº“ä¸­çš„æœ€æ–°é•œåƒï¼Œå¹¶è‡ªåŠ¨æ›´æ–°é…ç½®ä»“åº“ä¸­çš„é•œåƒé…ç½®ï¼Œæœ€åå†æ›´æ–°é›†ç¾¤ä¸­çš„åº”ç”¨é…ç½®ã€‚ä½¿ç”¨æˆ·å¯ä»¥è¾¾æˆåœ¨æ›´æ–°ä»£ç åï¼Œé›†ç¾¤ä¸­çš„é…ç½®ä¹Ÿè‡ªåŠ¨æ›´æ–°çš„æ•ˆæœã€‚</p><p><img alt="alt" src="/zh/assets/images/dev-flow-e2153e9687ba8904dddea46db8aa7a85.jpg"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å‡†å¤‡ä»£ç ä»“åº“"></a>å‡†å¤‡ä»£ç ä»“åº“<a class="hash-link" href="#å‡†å¤‡ä»£ç ä»“åº“" title="Direct link to heading">#</a></h3><p>å‡†å¤‡ä¸€ä¸ªä»£ç ä»“åº“ï¼Œé‡Œé¢åŒ…å«ä¸€äº›æºä»£ç ä»¥åŠå¯¹åº”çš„ Dockerfileã€‚</p><p>è¿™äº›ä»£ç å°†è¿æ¥åˆ°ä¸€ä¸ª MySQL æ•°æ®åº“ï¼Œå¹¶ç®€å•åœ°å¯åŠ¨æœåŠ¡ã€‚åœ¨é»˜è®¤çš„æœåŠ¡è·¯å¾„ä¸‹ï¼Œä¼šæ˜¾ç¤ºå½“å‰ç‰ˆæœ¬å·ã€‚åœ¨ <code>/db</code> è·¯å¾„ä¸‹ï¼Œä¼šåˆ—å‡ºå½“å‰æ•°æ®åº“ä¸­çš„ä¿¡æ¯ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly go"><div tabindex="0" class="prism-code language-go codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">    http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">HandleFunc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">w http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">ResponseWriter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> r </span><span class="token operator">*</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token boolean">_</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">_</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> fmt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Fprintf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">w</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Version: %s\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> VERSION</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">HandleFunc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/db&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">w http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">ResponseWriter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> r </span><span class="token operator">*</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        rows</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> err </span><span class="token operator">:=</span><span class="token plain"> db</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Query</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;select * from userinfo;&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> err </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token boolean">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token boolean">_</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">_</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> fmt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Fprintf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">w</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Error: %v\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> rows</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Next</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token plain"> username </span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token plain"> desc </span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            err </span><span class="token operator">=</span><span class="token plain"> rows</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Scan</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token operator">&amp;</span><span class="token plain">username</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">desc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> err </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token boolean">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token boolean">_</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">_</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> fmt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Fprintf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">w</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Scan Error: %v\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token boolean">_</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">_</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> fmt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Fprintf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">w</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;User: %s \nDescription: %s\n\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> username</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> desc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> err </span><span class="token operator">:=</span><span class="token plain"> http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">ListenAndServe</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;:8088&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">nil</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> err </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token boolean">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token function" style="color:rgb(80, 250, 123)">panic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">err</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Error</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æˆ‘ä»¬å¸Œæœ›ç”¨æˆ·æ”¹åŠ¨ä»£ç è¿›è¡Œæäº¤åï¼Œè‡ªåŠ¨æ„å»ºå‡ºæœ€æ–°çš„é•œåƒå¹¶æ¨é€åˆ°é•œåƒä»“åº“ã€‚è¿™ä¸€æ­¥ CI å¯ä»¥é€šè¿‡é›†æˆ GitHub Actionsã€Jenkins æˆ–è€…å…¶ä»– CI å·¥å…·æ¥å®ç°ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å€ŸåŠ© GitHub Actions æ¥å®ŒæˆæŒç»­é›†æˆã€‚å…·ä½“çš„ä»£ç æ–‡ä»¶åŠé…ç½®å¯å‚è€ƒ <a href="https://github.com/oam-dev/samples/tree/master/09.GitOps_Demo/for-developers/app-code" target="_blank" rel="noopener noreferrer">ç¤ºä¾‹ä»“åº“</a>ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="é…ç½®ç§˜é’¥ä¿¡æ¯"></a>é…ç½®ç§˜é’¥ä¿¡æ¯<a class="hash-link" href="#é…ç½®ç§˜é’¥ä¿¡æ¯" title="Direct link to heading">#</a></h3><p>åœ¨æ–°çš„é•œåƒæ¨é€åˆ°é•œåƒä»“åº“åï¼ŒKubeVela ä¼šè¯†åˆ«åˆ°æ–°çš„é•œåƒï¼Œå¹¶æ›´æ–°ä»“åº“åŠé›†ç¾¤ä¸­çš„ <code>Application</code> é…ç½®æ–‡ä»¶ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå«æœ‰ Git ä¿¡æ¯çš„ Secretï¼Œä½¿ KubeVela å‘ Git ä»“åº“è¿›è¡Œæäº¤ã€‚éƒ¨ç½²å¦‚ä¸‹æ–‡ä»¶ï¼Œå°†å…¶ä¸­çš„ç”¨æˆ·åå’Œå¯†ç æ›¿æ¢æˆä½ çš„ Git ç”¨æˆ·ååŠå¯†ç ï¼ˆæˆ– Tokenï¼‰ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> v1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Secret</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">secret</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> kubernetes.io/basic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">auth</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">stringData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">username</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> &lt;your username</span><span class="token punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">password</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> &lt;your password</span><span class="token punctuation" style="color:rgb(248, 248, 242)">&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å‡†å¤‡é…ç½®ä»“åº“-1"></a>å‡†å¤‡é…ç½®ä»“åº“<a class="hash-link" href="#å‡†å¤‡é…ç½®ä»“åº“-1" title="Direct link to heading">#</a></h3><p>é…ç½®ä»“åº“ä¸ä¹‹å‰é¢å‘è¿ç»´äººå‘˜çš„é…ç½®å¤§åŒå°å¼‚ï¼Œåªéœ€è¦åŠ ä¸Šä¸é•œåƒä»“åº“ç›¸å…³çš„é…ç½®å³å¯ã€‚å…·ä½“é…ç½®è¯·å‚è€ƒ <a href="https://github.com/oam-dev/samples/tree/master/09.GitOps_Demo/for-developers/kubevela-config" target="_blank" rel="noopener noreferrer">ç¤ºä¾‹ä»“åº“</a>ã€‚</p><p>ä¿®æ”¹ <code>clusters/</code> ä¸­çš„ <code>apps.yaml</code>ï¼Œè¯¥ GitOps é…ç½®ä¼šç›‘å¬ä»“åº“ä¸­ <code>apps/</code> ä¸‹çš„åº”ç”¨æ–‡ä»¶å˜åŠ¨ä»¥åŠé•œåƒä»“åº“ä¸­çš„é•œåƒæ›´æ–°ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">...</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">imageRepository</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># é•œåƒåœ°å€</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> &lt;your image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># å¦‚æœè¿™æ˜¯ä¸€ä¸ªç§æœ‰çš„é•œåƒä»“åº“ï¼Œå¯ä»¥é€šè¿‡ `kubectl create secret docker-registry` åˆ›å»ºå¯¹åº”çš„é•œåƒç§˜é’¥å¹¶ç›¸å…³è”</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># secretRef: imagesecret</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">filterTags</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># å¯å¯¹é•œåƒ tag è¿›è¡Œè¿‡æ»¤</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">pattern</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;^master-[a-f0-9]+-(?P&lt;ts&gt;[0-9]+)&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">extract</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;$ts&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># é€šè¿‡ policy ç­›é€‰å‡ºæœ€æ–°çš„é•œåƒ Tag å¹¶ç”¨äºæ›´æ–°</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">policy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">numerical</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">order</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> asc</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># è¿½åŠ æäº¤ä¿¡æ¯</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">commitMessage</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Image: {{range .Updated.Images}}{{println .}}{{end}}&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ä¿®æ”¹ <code>apps/my-app.yaml</code> ä¸­çš„ image å­—æ®µï¼Œåœ¨åé¢åŠ ä¸Š <code># {&quot;$imagepolicy&quot;: &quot;default:apps&quot;}</code> çš„æ³¨é‡Šã€‚KubeVela ä¼šé€šè¿‡è¯¥æ³¨é‡Šå»æ›´æ–°å¯¹åº”çš„é•œåƒå­—æ®µã€‚<code>default:apps</code> æ˜¯ä¸Šé¢ GitOps é…ç½®å¯¹åº”çš„å‘½åç©ºé—´å’Œåç§°ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">components</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">server</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> webservice</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ghcr.io/fogdong/test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">fog</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">master</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">cba5605f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token number">1632714412</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># {&quot;$imagepolicy&quot;: &quot;default:apps&quot;}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>å°† <code>clusters/</code> ä¸­åŒ…å«é•œåƒä»“åº“é…ç½®çš„æ–‡ä»¶æ›´æ–°åˆ°é›†ç¾¤ä¸­åï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥é€šè¿‡ä¿®æ”¹ä»£ç æ¥å®Œæˆåº”ç”¨çš„æ›´æ–°ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ä¿®æ”¹ä»£ç "></a>ä¿®æ”¹ä»£ç <a class="hash-link" href="#ä¿®æ”¹ä»£ç " title="Direct link to heading">#</a></h3><p>å°†ä»£ç æ–‡ä»¶ä¸­çš„ <code>Version</code> æ”¹ä¸º <code>0.1.6</code>ï¼Œå¹¶ä¿®æ”¹æ•°æ®åº“ä¸­çš„æ•°æ®:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly go"><div tabindex="0" class="prism-code language-go codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> VERSION </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0.1.6&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">...</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">InsertInitData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">db </span><span class="token operator">*</span><span class="token plain">sql</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">DB</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    stmt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> err </span><span class="token operator">:=</span><span class="token plain"> db</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Prepare</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">insertInitData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> err </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token boolean">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token function" style="color:rgb(80, 250, 123)">panic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">err</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">defer</span><span class="token plain"> stmt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Close</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token boolean">_</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> err </span><span class="token operator">=</span><span class="token plain"> stmt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Exec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;KubeVela2&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;It&#x27;s another test user&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> err </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token boolean">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token function" style="color:rgb(80, 250, 123)">panic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">err</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æäº¤è¯¥æ”¹åŠ¨è‡³ä»£ç ä»“åº“ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬é…ç½®çš„ CI æµæ°´çº¿å¼€å§‹æ„å»ºé•œåƒå¹¶æ¨é€è‡³é•œåƒä»“åº“ã€‚</p><p>è€Œ KubeVela ä¼šé€šè¿‡ç›‘å¬é•œåƒä»“åº“ï¼Œæ ¹æ®æœ€æ–°çš„é•œåƒ Tag æ¥æ›´æ–°é…ç½®ä»“åº“ä¸­ <code>apps/</code> ä¸‹çš„åº”ç”¨ <code>my-app</code>ã€‚</p><p>æ­¤æ—¶ï¼Œå¯ä»¥çœ‹åˆ°é…ç½®ä»“åº“ä¸­æœ‰ä¸€æ¡æ¥è‡ª <code>kubevelabot</code> çš„æäº¤ï¼Œæäº¤ä¿¡æ¯å‡å¸¦æœ‰ <code>Update image automatically.</code> å‰ç¼€ã€‚ä½ ä¹Ÿå¯ä»¥é€šè¿‡ <code>{{range .Updated.Images}}{{println .}}{{end}}</code> åœ¨ <code>commitMessage</code> å­—æ®µä¸­è¿½åŠ ä½ æ‰€éœ€è¦çš„ä¿¡æ¯ã€‚</p><p><img alt="alt" src="/zh/assets/images/gitops-commit-31c4a9477065754e172f97792bb14f91.png"></p><blockquote><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä½ å¸Œæœ›å°†ä»£ç å’Œé…ç½®æ”¾åœ¨åŒä¸€ä¸ªä»“åº“ï¼Œéœ€è¦è¿‡æ»¤æ‰æ¥è‡ª <code>kubevelabot</code> çš„æäº¤æ¥é˜²æ­¢æµæ°´çº¿çš„é‡å¤æ„å»ºã€‚å¯ä»¥åœ¨ CI ä¸­é€šè¿‡å¦‚ä¸‹é…ç½®è¿‡æ»¤ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">jobs:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"> publish:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">   if: </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;!contains(github.event.head_commit.message, &#x27;Update image automatically&#x27;)&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></blockquote><p>é‡æ–°æŸ¥çœ‹é›†ç¾¤ä¸­çš„åº”ç”¨ï¼Œå¯ä»¥çœ‹åˆ°ç»è¿‡ä¸€æ®µæ—¶é—´åï¼Œåº”ç”¨ <code>my-app</code> çš„é•œåƒå·²ç»è¢«æ›´æ–°ã€‚</p><blockquote><p>KubeVela ä¼šé€šè¿‡ä½ é…ç½®çš„ <code>interval</code> æ—¶é—´é—´éš”ï¼Œæ¥æ¯éš”ä¸€æ®µæ—¶é—´åˆ†åˆ«ä»é…ç½®ä»“åº“åŠé•œåƒä»“åº“ä¸­è·å–æœ€æ–°ä¿¡æ¯ï¼š</p><ul><li>å½“ Git ä»“åº“ä¸­çš„é…ç½®æ–‡ä»¶è¢«æ›´æ–°æ—¶ï¼ŒKubeVela å°†æ ¹æ®æœ€æ–°çš„é…ç½®æ›´æ–°é›†ç¾¤ä¸­çš„åº”ç”¨ã€‚</li><li>å½“é•œåƒä»“åº“ä¸­å¤šäº†æ–°çš„ Tag æ—¶ï¼ŒKubeVela å°†æ ¹æ®ä½ é…ç½®çš„ policy è§„åˆ™ï¼Œç­›é€‰å‡ºæœ€æ–°çš„é•œåƒ Tagï¼Œå¹¶æ›´æ–°åˆ° Git ä»“åº“ä¸­ã€‚è€Œå½“ä»£ç ä»“åº“ä¸­çš„æ–‡ä»¶è¢«æ›´æ–°åï¼ŒKubeVela å°†é‡å¤ç¬¬ä¸€æ­¥ï¼Œæ›´æ–°é›†ç¾¤ä¸­çš„æ–‡ä»¶ï¼Œä»è€Œè¾¾åˆ°äº†è‡ªåŠ¨éƒ¨ç½²çš„æ•ˆæœã€‚</li></ul></blockquote><p>é€šè¿‡ <code>curl</code> å¯¹åº”çš„ <code>Ingress</code> æŸ¥çœ‹å½“å‰ç‰ˆæœ¬å’Œæ•°æ®åº“ä¿¡æ¯ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ kubectl get ingress</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">NAME        CLASS    HOSTS                 ADDRESS         PORTS   AGE</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">my-server   </span><span class="token operator">&lt;</span><span class="token plain">none</span><span class="token operator">&gt;</span><span class="token plain">   kubevela.example.com  </span><span class="token operator">&lt;</span><span class="token plain">ingress-ip</span><span class="token operator">&gt;</span><span class="token plain">    </span><span class="token number">80</span><span class="token plain">      162m</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> -H </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Host:kubevela.example.com&quot;</span><span class="token plain"> http://</span><span class="token operator">&lt;</span><span class="token plain">ingress-ip</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Version: </span><span class="token number">0.1</span><span class="token plain">.6</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> -H </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Host:kubevela.example.com&quot;</span><span class="token plain"> http://</span><span class="token operator">&lt;</span><span class="token plain">ingress-ip</span><span class="token operator">&gt;</span><span class="token plain">/db</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">User: KubeVela</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Description: It</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;s a test user</span></div><div class="token-line" style="color:#F8F8F2"><span class="token string" style="display:inline-block;color:rgb(255, 121, 198)">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">User: KubeVela2</span></div><div class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Description: It&#x27;</span><span class="token plain">s another </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">test</span><span class="token plain"> user</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ç‰ˆæœ¬å·²è¢«æˆåŠŸæ›´æ–°ï¼è‡³æ­¤ï¼Œæˆ‘ä»¬å®Œæˆäº†ä»å˜æ›´ä»£ç ï¼Œåˆ°è‡ªåŠ¨éƒ¨ç½²è‡³é›†ç¾¤çš„å…¨éƒ¨æ“ä½œã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ€»ç»“"></a>æ€»ç»“<a class="hash-link" href="#æ€»ç»“" title="Direct link to heading">#</a></h2><p>åœ¨è¿ç»´ä¾§ï¼Œå¦‚è‹¥éœ€è¦æ›´æ–°åŸºç¡€è®¾æ–½ï¼ˆå¦‚æ•°æ®åº“ï¼‰çš„é…ç½®ï¼Œæˆ–æ˜¯åº”ç”¨çš„é…ç½®é¡¹ï¼Œåªéœ€è¦ä¿®æ”¹é…ç½®ä»“åº“ä¸­çš„æ–‡ä»¶ï¼ŒKubeVela å°†è‡ªåŠ¨æŠŠé…ç½®åŒæ­¥åˆ°é›†ç¾¤ä¸­ï¼Œç®€åŒ–äº†éƒ¨ç½²æµç¨‹ã€‚</p><p>åœ¨ç ”å‘ä¾§ï¼Œç”¨æˆ·ä¿®æ”¹ä»£ç ä»“åº“ä¸­çš„ä»£ç åï¼ŒKubeVela å°†è‡ªåŠ¨æ›´æ–°é…ç½®ä»“åº“ä¸­çš„é•œåƒã€‚ä»è€Œè¿›è¡Œåº”ç”¨çš„ç‰ˆæœ¬æ›´æ–°ã€‚</p><p>é€šè¿‡ä¸ GitOps çš„ç»“åˆï¼ŒKubeVela åŠ é€Ÿäº†åº”ç”¨ä»å¼€å‘åˆ°éƒ¨ç½²çš„æ•´ä¸ªæµç¨‹ã€‚</p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/zh/blog/tags/kube-vela">KubeVela</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/zh/blog/2021/10/08/blog-1.1">KubeVela 1.1 å‘å¸ƒï¼Œå¼€å¯æ··åˆç¯å¢ƒåº”ç”¨æŒç»­äº¤ä»˜æ–°é‡Œç¨‹ç¢‘</a></h2><div class="margin-vert--md"><time datetime="2021-10-08T00:00:00.000Z" class="blogPostDate_fNvV">2021å¹´10æœˆ8æ—¥ Â· é˜…è¯»éœ€è¦ 1 åˆ†é’Ÿ</time></div><div class="avatar margin-vert--md"><a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://kubevela.io/img/logo.svg" alt="KubeVela Maintainers"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer">KubeVela Maintainers</a></h4><small class="avatar__subtitle">KubeVela Team</small></div></div></header><div class="markdown"><p>åœ¨äº‘åŸç”Ÿç†å¿µè¿…é€Ÿæ™®åŠçš„ä»Šå¤©ï¼Œæ··åˆç¯å¢ƒéƒ¨ç½²ï¼ˆæ··åˆäº‘/å¤šäº‘/åˆ†å¸ƒå¼äº‘/è¾¹ç¼˜ï¼‰å·²ç»æˆä¸ºäº†å¤§å¤šæ•°ä¼ä¸šåº”ç”¨ã€SaaS æœåŠ¡ã€åº”ç”¨æŒç»­äº¤ä»˜å¹³å°çš„å¿…ç„¶é€‰æ‹©ï¼Œè€Œäº‘åŸç”ŸæŠ€æœ¯çš„å‘å±•è¶‹åŠ¿ä¹Ÿæ­£åœ¨æœç€â€œä¸€è‡´çš„ã€è·¨äº‘ã€è·¨ç¯å¢ƒçš„çš„åº”ç”¨äº¤ä»˜â€ä¸æ–­è¿ˆè¿›ã€‚ç„¶è€Œï¼Œæ— è®ºæ˜¯ Kubernetes æœ¬èº«è¿˜æ˜¯ç°æœ‰çš„å„ç±»åº”ç”¨äº¤ä»˜ç³»ç»Ÿï¼Œéƒ½æ²¡æœ‰åœ¨ç°ä»Šæ··åˆã€åˆ†å¸ƒå¼çš„éƒ¨ç½²ç¯å¢ƒä¹‹ä¸Šå¼•å…¥ä¸€è‡´çš„ä¸Šå±‚æŠ½è±¡æ¥ä¸ºåº”ç”¨äº¤ä»˜è¿›è¡Œå»ºæ¨¡ã€‚è¿™ç§ç¼ºä¹ç»Ÿä¸€ä¸Šå±‚æŠ½è±¡çš„åº”ç”¨äº¤ä»˜è¿‡ç¨‹ï¼Œå¾€å¾€åŒåº•å±‚åŸºç¡€è®¾æ–½ç´§å¯†è€¦åˆï¼Œå¯¼è‡´ç”¨æˆ·å¿ƒæ™ºè´Ÿæ‹…å¾ˆé‡å¹¶ä¸”ä¸¥é‡ä¾èµ–äºç”¨æˆ·ä¸ªäººçš„ç»éªŒå’Œèƒ½åŠ›ã€‚è¿™ä¸ä»…ä¼šå¤§å¹…å½±å“ç”¨æˆ·ä½“éªŒã€é™ä½ç”Ÿäº§æ•ˆç‡ï¼Œç”šè‡³è¿˜ä¼šå¯¼è‡´é”™è¯¯å’Œæ•…éšœçš„å‘ç”Ÿã€‚</p><p>è€Œç°åœ¨ï¼Œè¿™ä¸ªé—®é¢˜ç»ˆäºæœ‰äº†ä¸€ä¸ªå¼€æºã€æ ‡å‡†ï¼Œåˆä¸å¤±çµæ´»åº¦çš„è§£æ³•ã€‚å®ƒå°±æ˜¯ï¼š</p><p><img src="https://static.kubevela.net/images/logo.png" alt="kubevela-logo.png"> </p><p>KubeVela ä½œä¸ºä¸€ä¸ªå¼€ç®±å³ç”¨ã€é¢å‘ç°ä»£å¾®æœåŠ¡æ¶æ„çš„åº”ç”¨äº¤ä»˜ä¸ç®¡ç†å¹³å°ï¼Œä»Šå¤©æ­£å¼å‘å¸ƒäº† 1.1 ç‰ˆæœ¬ï¼Œä»¥æ›´åŠ ç”¨æˆ·å‹å¥½å’Œå®Œå–„çš„åŠŸèƒ½é›†ï¼Œå¼€å¯äº†â€è®©æ··åˆç¯å¢ƒåº”ç”¨äº¤ä»˜æ›´åŠ ç®€å•é«˜æ•ˆâ€œçš„é‡è¦é‡Œç¨‹ç¢‘ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œ1.1 ç‰ˆæœ¬çš„ KubeVela ä¸ç°æœ‰å„ç±»åº”ç”¨äº¤ä»˜ç³»ç»Ÿç›¸æ¯”ï¼Œæœ‰ç€æ˜¾è‘—çš„ä¸åŒå’Œä¼˜åŠ¿ï¼š</p><ul><li><p><strong>å®Œå…¨ä»¥åº”ç”¨ä¸ºä¸­å¿ƒ</strong>  ä¸å„ç±»â€œæ­ç§¯æœ¨â€å¼çš„ PaaS ç³»ç»Ÿæˆ–è€…åº”ç”¨å¹³å°ä¸åŒï¼ŒKubeVela é¡¹ç›®æœ¬èº«æ˜¯æ„å»ºäºä¸€å¥—å®Œå–„çš„åº”ç”¨äº¤ä»˜æ¨¡å‹ä¸ç†è®ºåŸºç¡€ä¹‹ä¸Šçš„ï¼Œè¿™å°±æ˜¯â€œå¼€æ”¾åº”ç”¨æ¨¡å‹ï¼ˆOAMï¼‰â€æŠ€æœ¯ã€‚OAM æ¨¡å‹èƒ½å¤Ÿé€šè¿‡å£°æ˜å¼çš„å®šä¹‰æ¥æ•è·é¢å‘æ··åˆç¯å¢ƒçš„å¾®æœåŠ¡åº”ç”¨äº¤ä»˜çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œç”šè‡³åŒ…æ‹¬äº‘æœåŠ¡çš„æ‹‰èµ·ä¸ç»‘å®šã€å¯è§‚æµ‹æ€§ã€å¤šé›†ç¾¤åˆ†å‘ç­–ç•¥ã€æµé‡è°ƒé…å’Œæ»šåŠ¨æ›´æ–°ç­‰å„ç§è¿ç»´è¡Œä¸ºå’Œç‰¹å¾ã€‚é€šè¿‡è¿™æ ·ä¸€ä¸ªç»Ÿä¸€çš„ã€åŸºç¡€è®¾æ–½æ— å…³çš„ä¸Šå±‚æ¨¡å‹ï¼ŒKubeVela å¤©ç„¶å°±èƒ½å¤Ÿåšåˆ°è®©ç”¨æˆ·æ— éœ€å…³å¿ƒä»»ä½•åŸºç¡€è®¾æ–½ç»†èŠ‚ã€åªä¸“æ³¨äºä¸šåŠ¡ä»·å€¼å’Œäº¤ä»˜è¿‡ç¨‹ï¼ŒçœŸæ­£å®ç°äº†å®Œå…¨ Serverless åŒ–çš„åº”ç”¨ç®¡ç†ä¸äº¤ä»˜ä½“éªŒã€‚</p></li><li><p><strong>å¯ç¼–ç¨‹å¼äº¤ä»˜å·¥ä½œæµ</strong> - åœ¨ Kubernetes é¢å‘ç»ˆæ€çš„åŸºç¡€ä¸Šï¼ŒKubeVela è¿˜é€šè¿‡â€œäº¤ä»˜æµæ°´çº¿ï¼ˆWorkflowï¼‰â€œæ¥æ”¯æŒé¢å‘è¿‡ç¨‹çš„åº”ç”¨äº¤ä»˜æµç¨‹ï¼ŒåŒæ—¶é€šè¿‡ Kubernetes ç»ˆæ€èƒ½åŠ›æ¥ä¿è¯è¯¥æµæ°´çº¿æ‰§è¡Œçš„æ­£ç¡®æ€§ä¸å¹‚ç­‰æ€§ã€‚åœ¨å†…æ ¸ä¸­ï¼ŒKubeVela æµæ°´çº¿æ˜¯é€šè¿‡ CUE æ¥å®ç°çš„ã€‚CUE æ˜¯ä¸€ç§è¯ç”Ÿè‡ª Google Borg ç³»ç»Ÿçš„æ•°æ®é…ç½®è¯­è¨€ï¼ˆå³ï¼šborgcfgï¼‰ï¼Œå®ƒå¯ä»¥å°†åº”ç”¨äº¤ä»˜è¿‡ç¨‹çš„æ‰€æœ‰æ­¥éª¤ã€æ‰€éœ€èµ„æºã€å…³è”çš„è¿ç»´åŠ¨ä½œä»¥å¯ç¼–ç¨‹çš„æ–¹å¼å®šä¹‰æˆä¸€ä¸ª DAGï¼ˆæœ‰å‘æ— ç¯å›¾ï¼‰ï¼Œå¹¶ä»¥æ­¤ä½œä¸ºç”¨æˆ·æœ€ç»ˆçš„äº¤ä»˜è®¡åˆ’ã€‚è¿™ä½¿å¾— KubeVela çš„äº¤ä»˜æµæ°´çº¿ä¸ä»…ä½¿ç”¨ç®€å•ã€æ‰©å±•æ€§æå¼ºï¼Œä¹Ÿæ›´ç¬¦åˆç°ä»£ GitOps åº”ç”¨äº¤ä»˜çš„è¶‹åŠ¿ä¸è¦æ±‚ã€‚</p></li><li><p><strong>åŸºç¡€è®¾æ–½æ— å…³</strong> - åœ¨ 1.1 ç‰ˆæœ¬ä¸­ï¼ŒKubeVela å®Œæˆäº† 100% çš„â€œæ§åˆ¶å¹³é¢åŒ–â€ã€‚è¿™æ„å‘³ç€å®ƒæœ¬èº«æˆä¸ºäº†ä¸€ä¸ªè¿è¡Œåœ¨ç®¡æ§é›†ç¾¤ä¸­çš„ã€å®Œå…¨ä¸åº”ç”¨è¿è¡ŒåŸºç¡€è®¾æ–½æ— å…³çš„äº¤ä»˜æ§åˆ¶å¹³é¢ã€‚è¿™ç§â€œä½¿ç”¨ Kubernetes ä½œä¸ºç®¡æ§å¹³é¢ã€é¢å‘ä»»ä½•åŸºç¡€è®¾æ–½è¿›è¡Œåº”ç”¨äº¤ä»˜ä¸ç®¡ç†â€çš„æ–°æ¶æ„ï¼Œä½¿å¾— KubeVela å¯ä»¥æŒ‰ç…§ç”¨æˆ·å®šä¹‰çš„å·¥ä½œæµä¸äº¤ä»˜ç­–ç•¥ï¼Œé¢å‘ä»»ä½•ç¯å¢ƒäº¤ä»˜å’Œç®¡ç†ä»»æ„ç±»å‹çš„åº”ç”¨ç»„ä»¶ï¼ŒåŒ…æ‹¬ï¼šå®¹å™¨ã€äº‘å‡½æ•°ã€æ•°æ®åº“ã€äº‘æœåŠ¡ã€è™šæ‹Ÿæœºå®ä¾‹ç­‰ç­‰ã€‚</p></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="kubevela-11-ä»‹ç»"></a>KubeVela 1.1 ä»‹ç»<a class="hash-link" href="#kubevela-11-ä»‹ç»" title="Direct link to heading">#</a></h2><p>è‡ª Kubevela 1.0 ç‰ˆæœ¬å‘å¸ƒä»¥æ¥ï¼ŒKubeVela ç¤¾åŒºå‘å±•éå¸¸è¿…é€Ÿï¼Œæˆªæ­¢ç›®å‰å·²ç»æœ‰è¶…è¿‡ 100+ åå¼€å‘è€…å‚ä¸è´¡çŒ®ï¼Œè€Œä¸”å°±åœ¨ä¸Šä¸ªæœˆï¼ŒKubeVela å’Œ OAM é¡¹ç›®ä¹Ÿå·²ç»æ•´ä½“æèµ ç»™äº† CNCF åŸºé‡‘ä¼šè¿›è¡Œæ‰˜ç®¡ã€‚åœ¨ 1.1 ç‰ˆæœ¬ä¸­ï¼ŒKubeVela æ›´åŠ èšç„¦é¢å‘æ··åˆç¯å¢ƒçš„åº”ç”¨äº¤ä»˜æµç¨‹ï¼Œå¸¦æ¥äº†å¤šé›†ç¾¤äº¤ä»˜ã€äº¤ä»˜æµç¨‹å®šä¹‰ã€ç°åº¦å‘å¸ƒã€å…¬æœ‰äº‘èµ„æºæ¥å…¥ç­‰å¤šä¸ªå¼€ç®±å³ç”¨çš„èƒ½åŠ›å’Œæ›´åŠ å‹å¥½çš„ç”¨æˆ·ä½“éªŒã€‚è¿™å…¶ä¸­ï¼Œæœ‰ä¸¤ä¸ªæ ¸å¿ƒèƒ½åŠ›å€¼å¾—ç‰¹åˆ«å…³æ³¨ï¼š</p><ul><li><p><strong>å¤©ç„¶æ”¯æŒå¤šç¯å¢ƒã€å¤šé›†ç¾¤åº”ç”¨äº¤ä»˜</strong>ï¼šKubevela å°†åº•å±‚ç¯å¢ƒçš„åŸºç¡€è®¾æ–½è¿›è¡Œäº†é¢å‘åº”ç”¨çš„æ ‡å‡†åŒ–æŠ½è±¡ï¼Œæ¶µç›–äº†äº¤ä»˜åˆ¶å“ã€ç®—åŠ›ï¼ˆåŸºç¡€è®¡ç®—ã€AIè®¡ç®—ã€äº‘è¾¹ååŒè®¡ç®—ï¼‰ã€è¿ç»´ç‰¹å¾ï¼ˆç›‘æ§ã€æµé‡æ²»ç†ã€æ—¥å¿—æ”¶é›†ç­‰ï¼‰ç­‰å¤šä¸ªç»´åº¦ã€‚ç”¨æˆ·èƒ½å¤Ÿéå¸¸æ–¹ä¾¿çš„å°†åº”ç”¨æè¿°è·Ÿä¸åŒçš„å¾…äº¤ä»˜ç¯å¢ƒï¼ˆé›†ç¾¤ï¼‰è¿›è¡ŒåŒ¹é…ã€å®šä¹‰ä¸åŒç¯å¢ƒä¸‹çš„é…ç½® Patchï¼Œä»è€ŒæŠŠåº”ç”¨å·®å¼‚åŒ–åœ°äº¤ä»˜åˆ°ä¸åŒç¯å¢ƒæˆ–è€…é›†ç¾¤å½“ä¸­ã€‚</p></li><li><p><strong>å¤©ç„¶æ”¯æŒå£°æ˜å¼äº¤ä»˜å·¥ä½œæµ</strong>ï¼šä¼—æ‰€å‘¨çŸ¥ï¼ŒKubernetes çš„èµ„æºæ¨¡å‹æ˜¯ä»¥ç»ˆæ€æ¥ç»´æŠ¤çš„ï¼Œä½†æ˜¯å®é™…çš„åº”ç”¨äº¤ä»˜åœºæ™¯ï¼Œå´å¾€å¾€æ˜¯ä¸€ä¸ªé¢å‘è¿‡ç¨‹çš„ç³»åˆ—æ“ä½œï¼ˆæ¯”å¦‚ï¼šå£°æ˜ç»„ä»¶ A - éƒ¨ç½²ç»„ä»¶ A åˆ°æµ‹è¯•é›†ç¾¤ - åˆ‡ 50% æµé‡åˆ°ç»„ä»¶ A - è¿è¡Œæµ‹è¯• - å‘å¸ƒåˆ°ç”Ÿæˆé›†ç¾¤ç­‰ç­‰ï¼‰ã€‚æ‰€ä»¥åœ¨ç¤¾åŒºä¸­ï¼Œç”¨æˆ·å¸Œæœ›ç®€å•ã€é€æ˜çš„æ§åˆ¶åº”ç”¨äº¤ä»˜æµç¨‹çš„è¯‰æ±‚éå¸¸å¼ºçƒˆï¼Œä½†å¾€å¾€åˆä¸å¸Œæœ›å› æ­¤å¼•å…¥ä¸€å¥—å…¨æ–°çš„ã€å®Œæ•´çš„ CI/CD ç³»ç»Ÿã€‚ä¸ºæ­¤ï¼ŒKubeVela 1.1 åœ¨åº”ç”¨æ¨¡å‹ä¸­å¢åŠ äº† Workflow è¯­ä¹‰æ¥ç²¾ç»†åŒ–çš„æè¿°æ•´ä¸ªåº”ç”¨äº¤ä»˜å·¥ä½œæµï¼Œå¹¶ä¸”å†…ç½®å°±æä¾›â€äººå·¥å®¡æ‰¹â€œã€â€å›æ»šâ€œã€â€æ•°æ®ä¼ é€’â€œã€â€œSlack/é’‰é’‰é€šçŸ¥â€ç­‰å¤šä¸ªå·¥ä½œæµæ­¥éª¤ï¼ˆStepï¼‰ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œè¿™ç§å®ç°åœ¨åº”ç”¨æ¨¡å‹å±‚çš„å£°æ˜å¼ Workflow  å¤©ç„¶å…·å¤‡è¢«é›†æˆèƒ½åŠ›ï¼Œå¯ä»¥éå¸¸è‡ªç„¶çš„åŒç°æœ‰ CI/CD ç³»ç»Ÿæˆ–è€… GitOps å·¥å…·é€šè¿‡æ‰©å±•çš„æ–¹å¼åšé›†æˆï¼Œè€Œä¸éœ€è¦ç”¨æˆ·åœ¨å–èˆé—´ç—›è‹¦ã€‚</p></li></ul><p>æ­£æ˜¯é€šè¿‡ä¸Šè¿°è®¾è®¡ï¼ŒKubeVela å¯ä»¥å¸®åŠ©ä½ ä»â€œé™æ€é…ç½®ã€æ¨¡æ¿ã€èƒ¶æ°´ä»£ç â€çš„åˆçº§é˜¶æ®µï¼Œç›´æ¥å‡çº§è‡³â€œè‡ªåŠ¨åŒ–ã€å£°æ˜å¼ã€ç»Ÿä¸€æ¨¡å‹ã€å¤©ç„¶é¢å‘å¤šç¯å¢ƒâ€çš„ä¸‹ä¸€ä»£ä»¥å·¥ä½œæµä¸ºæ ¸å¿ƒçš„äº¤ä»˜ä½“éªŒå½“ä¸­ã€‚</p><p><img src="https://static.kubevela.net/images/cloud-deploy.jpg" alt="undefined"> </p><p>åŸºäºä¸Šè¿°èƒ½åŠ›ï¼Œç”¨æˆ·ç°åœ¨å¯ä»¥é€šè¿‡ KubeVela éå¸¸è½»æ¾çš„å¤„ç†ä»¥ä¸‹åœºæ™¯ï¼š</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å¤šç¯å¢ƒã€å¤šé›†ç¾¤åº”ç”¨äº¤ä»˜"></a>å¤šç¯å¢ƒã€å¤šé›†ç¾¤åº”ç”¨äº¤ä»˜<a class="hash-link" href="#å¤šç¯å¢ƒã€å¤šé›†ç¾¤åº”ç”¨äº¤ä»˜" title="Direct link to heading">#</a></h3><p>é¢å‘ Kubernetes çš„å¤šç¯å¢ƒã€å¤šé›†ç¾¤äº¤ä»˜å·²æ˜¯ä¸€ä¸ªæ ‡å‡†æ€§éœ€æ±‚ã€‚ä½ æˆ–è®¸æ˜¯éœ€è¦ç¯å¢ƒéš”ç¦»ï¼Œå¼€å‘ã€é¢„å‘å’Œç”Ÿäº§ä¸‰å¥—é›†ç¾¤ï¼›æˆ–è®¸æ˜¯éœ€è¦äº¤ä»˜ä¸åŒçš„å®¢æˆ·ï¼Œæ¯ä¸ªå®¢æˆ·ç‹¬ç«‹ä¸€å¥—é›†ç¾¤ï¼›æˆ–è®¸æ˜¯éœ€è¦äº¤ä»˜åˆ°ä¸åŒåŒºåŸŸï¼Œåœ¨åŒ—äº¬ã€å¹¿å·å¤šå¥—é›†ç¾¤ï¼›åˆæˆ–è®¸ä½ ä¸šåŠ¡è§„æ¨¡å¤§ï¼Œå•ä¸ª Kubernetes é›†ç¾¤æ— æ³•æ»¡è¶³ä½ çš„èµ„æºéœ€æ±‚ã€‚ä» 1.1 ç‰ˆæœ¬å¼€å§‹ï¼ŒKubeVela ä¸ä»…å®ç°äº†å¤šé›†ç¾¤çš„åº”ç”¨äº¤ä»˜ï¼Œå¹¶ä¸”æ—¢å¯ä»¥ç‹¬ç«‹å·¥ä½œç›´æ¥çº³ç®¡å¤šä¸ªé›†ç¾¤ï¼Œä¹Ÿå¯ä»¥é›†æˆ OCMã€Karmada ç­‰å„ç±»å¤šé›†ç¾¤ç®¡ç†å·¥å…·æ¥è¿›è¡Œæ›´å¤æ‚çš„äº¤ä»˜åŠ¨ä½œã€‚</p><p><img src="https://static.kubevela.net/images/deploy_cloud.gif">
<em>å¤šé›†ç¾¤åº”ç”¨å‘å¸ƒDemo(ç»“åˆWorkflow)</em></p><p>åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°±å°†ä¸€ä¸ªåº”ç”¨å·®å¼‚åŒ–çš„äº¤ä»˜äº†åˆ°ä¸åŒçš„é›†ç¾¤ç¯å¢ƒä¸­ã€‚è¿™ç§â€œäº¤ä»˜å·®å¼‚â€åœ¨ KubeVela ä¸­å±äºäº¤ä»˜ç­–ç•¥ï¼ˆPolicyï¼‰çš„ä¸€ç§ï¼Œå®ƒå¯ä»¥æ˜¯ç¯å¢ƒé…ç½®å·®å¼‚ã€ç»„ä»¶æ•°é‡å·®å¼‚ç­‰ç­‰ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒKubeVela æ”¯æŒ Kustomize é£æ ¼çš„ Patch æ¥å®šä¹‰è¿™ç§å·®å¼‚ï¼Œä½†åˆä¸éœ€è¦ç”¨æˆ·å­¦ä¹ ä»»ä½• Kustomize ç›¸å…³çš„çŸ¥è¯†ã€‚åœ¨å¤šé›†ç¾¤äº¤ä»˜ç­–ç•¥çš„åŸºç¡€ä¸Šï¼Œç”¨æˆ·è¿˜å¯ä»¥é€šè¿‡å®šä¹‰ Workflow æ¥æ§åˆ¶äº¤ä»˜åˆ°ä¸åŒé›†ç¾¤çš„é¡ºåºã€æ¡ä»¶ç­‰å·¥ä½œæµæ­¥éª¤ã€‚</p><p>è¿›ä¸€æ­¥å°è¯•å¤šé›†ç¾¤åº”ç”¨äº¤ä»˜ï¼Œè¯·å‚è€ƒ <a href="https://kubevela.io/docs/case-studies/multi-cluster" target="_blank" rel="noopener noreferrer">æœ€ä½³å®è·µæ–‡æ¡£</a></p><p>åç»­ç‰ˆæœ¬ä¸­ï¼ŒKubeVela åœ¨å¤šé›†ç¾¤äº¤ä»˜æ–¹é¢ä¼šæä¾›å…¨å±€æµé‡åˆ†å‘ã€å¤šé›†ç¾¤è‡ªåŠ¨è°ƒåº¦ç­–ç•¥ã€å¤šé›†ç¾¤ç°åº¦å‘å¸ƒç­‰æ›´å¤šé«˜çº§ç‰¹æ€§ç‰¹æ€§ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å®šä¹‰äº¤ä»˜å·¥ä½œæµï¼ˆworkflowï¼‰"></a>å®šä¹‰äº¤ä»˜å·¥ä½œæµï¼ˆWorkflowï¼‰<a class="hash-link" href="#å®šä¹‰äº¤ä»˜å·¥ä½œæµï¼ˆworkflowï¼‰" title="Direct link to heading">#</a></h3><p>Workflow çš„èƒŒæ™¯å‰é¢å·²ç»æåˆ°è¿‡ï¼Œè€Œå®ƒçš„å…·ä½“ä½¿ç”¨åœºæ™¯åˆ™å¾ˆå¤šï¼Œæ¯”å¦‚ï¼šåœ¨å¤šç¯å¢ƒåº”ç”¨äº¤ä»˜åœºæ™¯ä¸­ï¼Œç”¨æˆ·å¯ä»¥å®šä¹‰ä¸åŒçš„ç¯å¢ƒäº¤ä»˜çš„é¡ºåºå’Œå‰ç½®æ¡ä»¶ï¼›å†ä¾‹å¦‚æœ€ç®€å•çš„éœ€æ±‚ï¼Œéƒ¨ç½²å®Œæˆåéœ€è¦é€šçŸ¥å¼€å‘è€…ï¼›å†ä¾‹å¦‚æˆ‘ä»¬éœ€è¦æ§åˆ¶ç°åº¦å‘å¸ƒçš„è¿›ç¨‹ï¼Œæµé‡åˆ‡æ¢çš„æ¯”ä¾‹ï¼Œå†ä¾‹å¦‚æˆ‘ä»¬éœ€è¦åº”ç”¨éƒ¨ç½²å®Œæˆåæ‰§è¡ŒE2Eæµ‹è¯•ç­‰ã€‚KubeVela çš„å·¥ä½œæµæ˜¯é¢å‘æŒç»­äº¤ä»˜ï¼ˆCDï¼‰è¿‡ç¨‹çš„ï¼ŒåŒæ—¶ä¹Ÿæ˜¯å£°æ˜å¼çš„ï¼Œæ‰€ä»¥å®ƒæ—¢å¯ä»¥ä½œä¸º CD ç³»ç»Ÿç›´æ¥åŒ CI ç³»ç»Ÿï¼ˆæ¯”å¦‚ Jenkins ç­‰ï¼‰å¯¹æ¥ï¼Œä¹Ÿå¯ä»¥åµŒå…¥åˆ°ç°æœ‰ CI/CD ä½“ç³»ä¸­ä½œä¸ºå¢å¼ºå’Œè¡¥å……ï¼Œè½åœ°æ–¹å¼éå¸¸çµæ´»ã€‚</p><p>åœ¨æ¨¡å‹ä¸Šï¼ŒWorkflow æ˜¯ç”±ä¸€ç³»åˆ— Step ç»„æˆçš„ï¼Œè€Œåœ¨å®ç°ä¸Šï¼Œæ¯ä¸€ä¸ª Step åˆ™æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„èƒ½åŠ›æ¨¡å—ï¼Œç”±å…¶å…·ä½“çš„ç±»å‹å’Œå‚æ•°æ¥å†³å®šå…¶å…·ä½“æ­¥éª¤çš„èƒ½åŠ›ã€‚åœ¨1.1 ç‰ˆæœ¬ä¸­ï¼ŒKubeVela å†…ç½®çš„ Step å·²ç»æ¯”è¾ƒä¸°å¯Œï¼Œæ¬¢è¿å¤§å®¶è¯•ç”¨ã€åé¦ˆã€‚å¹¶ä¸”ï¼ŒStep éå¸¸å®¹æ˜“æ‰©å±•ï¼Œä¹Ÿèƒ½å¤Ÿè®©å¤§å®¶å»å¯¹æ¥å·²æœ‰çš„å¹³å°èƒ½åŠ›ï¼Œåšåˆ°æ— ç¼è¿ç§»ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="é€šè¿‡-service-mesh-æ¥å®ç°ç°åº¦å‘å¸ƒç­‰é«˜çº§è¿ç»´åŠ¨ä½œ"></a>é€šè¿‡ Service Mesh æ¥å®ç°ç°åº¦å‘å¸ƒç­‰é«˜çº§è¿ç»´åŠ¨ä½œ<a class="hash-link" href="#é€šè¿‡-service-mesh-æ¥å®ç°ç°åº¦å‘å¸ƒç­‰é«˜çº§è¿ç»´åŠ¨ä½œ" title="Direct link to heading">#</a></h3><p>é€šè¿‡ç»Ÿä¸€çš„åº”ç”¨æ¨¡å‹é›†æˆå„ç§ä¸åŒçš„åº•å±‚èƒ½åŠ›ï¼Œä¾ç„¶æ˜¯ KubeVela æœ€å¤§çš„äº®ç‚¹ä¹‹ä¸€ã€‚å…·ä½“æ¥è¯´ï¼ŒKubeVela é€šè¿‡ OAM æ¨¡å‹å¯ä»¥ä½¿å¾—ç”¨æˆ·ä¸éœ€è¦ä»»ä½•â€œè„ä¹±å·®â€çš„èƒ¶æ°´ä»£ç æˆ–è€…è„šæœ¬å°±å¯ä»¥åŒä»»ä½•äº‘åŸç”ŸæŠ€æœ¯æˆ–å·¥å…·ï¼ˆæ¯”å¦‚ Service Meshï¼‰å®ç°é›†æˆï¼Œä»è€Œä¸ºäº¤ä»˜è¿‡ç¨‹å¸¦æ¥æ›´å¤šçš„äº‘åŸç”Ÿåº”ç”¨è¿ç»´èƒ½åŠ›ã€‚åœ¨ 1.1 ç‰ˆæœ¬ä¸­ï¼ŒKubeVela å·²ç»å†…ç½®äº†ä¸ Istio é›†æˆçš„æ¡ˆä¾‹ã€‚ç³»ç»Ÿç®¡ç†å‘˜å¯ä»¥é€šè¿‡ KubeVela çš„æ’ä»¶ç®¡ç†æœºåˆ¶ä¾¿æ·çš„å¯ç”¨ Istio æ’ä»¶ ã€‚KubeVela åˆ™è´Ÿè´£å°† Istio çš„èƒ½åŠ›è¿›è¡Œå°è£…å’ŒæŠ½è±¡åäº¤ä»˜ç»™ç”¨æˆ·ä½¿ç”¨ï¼Œä½¿å¾—ç”¨æˆ·æ— éœ€æˆä¸º Istio ä¸“å®¶å°±å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªé‡‘ä¸é›€å‘å¸ƒçš„åœºæ™¯ï¼ˆKubeVela ä¼šä¸ºç”¨æˆ·æä¾›ä¸€ä¸ªå°è£…å¥½çš„ Rollout è¿ç»´ç‰¹å¾ï¼‰ã€‚è¿™ç§ä½“éªŒå¼€å‘è€…æ¥è¯´æ˜¯ç›¸å½“å‹å¥½çš„ï¼Œä»–æ—¢æ— éœ€èŠ±è´¹å¤§é‡çš„æ—¶é—´å»å­¦ä¹ å’ŒæŒæ¡Istioçš„ä½¿ç”¨å’Œé…ç½®ï¼Œä¹Ÿæ— éœ€å…³æ³¨ Istio ä½“ç³»å’Œå„ç§äº‘ä¸Šæ‰˜ç®¡ç‰ˆ Service Mesh çš„å·®å¼‚ï¼Œå½»åº•è§£è€¦å‚å•†é”å®šã€‚</p><p><img src="https://static.kubevela.net/images/rollout.gif">
<em>åº”ç”¨æ¸è¿›å¼å‘å¸ƒDemo(ç»“åˆWorkflow)</em></p><p>ä½ å¯ä»¥å‚è€ƒ <a href="https://github.com/oam-dev/kubevela/tree/master/docs/examples/workflow/canary-rollout" target="_blank" rel="noopener noreferrer">Rollout Demo</a>å®ç°å›¾ç¤ºæ•ˆæœï¼Œæˆ–å‚è€ƒæœ€ä½³å®è·µ <a href="https://kubevela.io/docs/case-studies/canary-blue-green/" target="_blank" rel="noopener noreferrer">åŸºäº Istio çš„æ¸è¿›å¼å‘å¸ƒ</a>ï¼Œä½“éªŒå®Œæ•´çš„å¾®æœåŠ¡æ¸è¿›å¼å‘å¸ƒå’Œå›æ»šã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ä»¥åº”ç”¨ä¸ºä¸­å¿ƒçš„äº‘èµ„æºäº¤ä»˜"></a>ä»¥åº”ç”¨ä¸ºä¸­å¿ƒçš„äº‘èµ„æºäº¤ä»˜<a class="hash-link" href="#ä»¥åº”ç”¨ä¸ºä¸­å¿ƒçš„äº‘èµ„æºäº¤ä»˜" title="Direct link to heading">#</a></h3><p>äº‘å‚å•†èµ„æºå·²ç»æˆä¸ºå¤§å¤šæ•°åº”ç”¨å¼€å‘è€…ç”Ÿäº§ä¸šåŠ¡ä¼šé‡‡ç”¨çš„è®¡ç®—èµ„æºï¼Œå®ƒåŒ…æ‹¬äº†åŸºç¡€è®¾æ–½ã€SaaSæœåŠ¡ã€ä¸­é—´ä»¶æœåŠ¡ã€æ‰˜ç®¡æœåŠ¡ç­‰ã€‚å¯¹æ­¤ï¼ŒKubeVela çš„è®¾è®¡æ˜¯ä»â€œä»¥åº”ç”¨ä¸ºä¸­å¿ƒâ€çš„è§†è§’å‡ºå‘ï¼Œå¸®åŠ©å¼€å‘è€…ä»¥å®Œå…¨ Serverless çš„æ–¹å¼æ›´å¥½ã€æ›´æ–¹ä¾¿çš„ç®¡ç†äº‘èµ„æºï¼Œè€Œä¸æ˜¯ç–²äºåº”ä»˜å„ç§ä¸åŒçš„äº‘äº§å“å’Œæ§åˆ¶å°ã€‚åœ¨å®ç°ä¸Šï¼ŒKubeVela å†…ç½®é›†æˆäº† Terraform æ¥ä½œä¸ºäº‘èµ„æºçš„ç¼–æ’å·¥å…·ï¼Œå¹¶ä¸”èƒ½å¤Ÿä»¥ç»Ÿä¸€çš„åº”ç”¨æ¨¡å‹æ”¯æŒå„ä¸ªäº‘å‚å•†ä¸Šç™¾ç§ä¸åŒç±»å‹äº‘æœåŠ¡çš„éƒ¨ç½²ã€ç»‘å®šå’Œç®¡ç†ã€‚</p><p>åœ¨ä½¿ç”¨ä¸Šï¼Œæˆ‘ä»¬ç›®å‰å°†äº‘èµ„æºåˆ†ä¸ºä»¥ä¸‹ä¸‰ç±»ï¼š</p><ul><li>ä½œä¸ºç»„ä»¶ï¼šæ¯”å¦‚æ•°æ®åº“ã€ä¸­é—´ä»¶ã€SaaSæœåŠ¡ç­‰ã€‚æ¯”å¦‚ KubeVela ä¸­çš„ Alibaba-RDSæœåŠ¡å°±å±äºè¿™ç§ã€‚</li><li>ä½œä¸ºè¿ç»´ç‰¹å¾ï¼šæ¯”å¦‚æ—¥å¿—åˆ†æã€ç›‘æ§å¯è§†åŒ–ã€ç›‘æ§æŠ¥è­¦ç­‰æœåŠ¡ã€‚</li><li>ä½œä¸ºåº”ç”¨è¿è¡ŒåŸºç¡€è®¾æ–½ï¼šæ¯”å¦‚ Kubernetes æ‰˜ç®¡é›†ç¾¤ã€SLB è´Ÿè½½å‡è¡¡ã€NASæ–‡ä»¶å­˜å‚¨æœåŠ¡ç­‰ã€‚</li></ul><p>åœ¨åç»­çš„ç‰ˆæœ¬ï¼ŒKubeVela ä¼šè¿›ä¸€æ­¥å¢åŠ æ›´åŠ ä¸°å¯Œçš„äº‘æœåŠ¡ä½¿ç”¨åœºæ™¯ï¼Œå¯¹å„ä¸ªäº‘å‚å•†åˆ†æ•£çš„èµ„æºå’Œè®¡ç®—èƒ½åŠ›è¿›è¡Œæœ‰æ•ˆæ•´åˆï¼Œé™ä½å¼€å‘è€…çš„ä½¿ç”¨é—¨æ§›å’ŒæœåŠ¡è§¦è¾¾è·¯å¾„ï¼Œå®ç°èµ„æºçš„å¤ç”¨å’Œæœ‰æ•ˆã€å®‰å…¨çš„å›æ”¶æœºåˆ¶ï¼Œé™ä½ç”¨æˆ·è´¹ç”¨ã€‚KubeVela çš„ Terraform äº‘æœåŠ¡ç®¡ç†æ˜¯ç›®å‰ç¤¾åŒºä¸­éå¸¸ç«çƒ­çš„ä¸€ä¸ªç»„ä»¶ï¼Œæœ‰å¤§é‡æ¥è‡ªåŒ—ç¾ã€æ¬§æ´²çš„è´¡çŒ®è€…å‚ä¸å…¶ä¸­ï¼Œéå¸¸æ¬¢è¿å¤§å®¶è¯•ç”¨ã€è´¡çŒ®å’Œæå‡ºéœ€æ±‚ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ›´å®¹æ˜“è½åœ°çš„-gitops-æŒç»­äº¤ä»˜å®è·µ"></a>æ›´å®¹æ˜“è½åœ°çš„ GitOps æŒç»­äº¤ä»˜å®è·µ<a class="hash-link" href="#æ›´å®¹æ˜“è½åœ°çš„-gitops-æŒç»­äº¤ä»˜å®è·µ" title="Direct link to heading">#</a></h3><p>KubeVela ä½œä¸ºä¸€ä¸ªå£°æ˜å¼çš„åº”ç”¨äº¤ä»˜æ§åˆ¶å¹³é¢ï¼Œå¤©ç„¶å°±å¯ä»¥ä»¥ GitOps çš„æ–¹å¼è¿›è¡Œä½¿ç”¨ï¼ˆå¯å•ç‹¬ä½¿ç”¨ï¼Œä¹Ÿå¯é…åˆ ArgoCD ç­‰å·¥å…·ï¼‰ï¼Œå¹¶ä¸”èƒ½å¤Ÿä¸º GitOps åœºæ™¯æä¾›æ›´å¤šç«¯åˆ°ç«¯çš„èƒ½åŠ›å’Œå¢å¼ºã€å¸®åŠ© GitOps ç†å¿µä»¥æ›´åŠ äº²æ°‘å’Œè§£å†³å®é™…é—®é¢˜çš„æ–¹å¼åœ¨ä¼ä¸šä¸­è½åœ°ã€‚è¿™äº›èƒ½åŠ›åŒ…æ‹¬ï¼š</p><ul><li>å®šä¹‰åº”ç”¨äº¤ä»˜å·¥ä½œæµï¼ˆCD æµæ°´çº¿ï¼‰<ul><li>å³ï¼šKubeVela æ”¯æŒåœ¨ GitOps æ¨¡å¼ä¸­æè¿°è¿‡ç¨‹å¼çš„åº”ç”¨äº¤ä»˜æµç¨‹ï¼Œè€Œä¸åªæ˜¯ç®€å•çš„å£°æ˜ç»ˆæ€ï¼›</li></ul></li><li>å¤„ç†éƒ¨ç½²è¿‡ç¨‹ä¸­çš„å„ç§ä¾èµ–å…³ç³»å’Œæ‹“æ‰‘ç»“æ„ï¼›</li><li>åœ¨ç°æœ‰å„ç§ GitOps å·¥å…·çš„è¯­ä¹‰ä¹‹ä¸Šæä¾›ç»Ÿä¸€çš„ä¸Šå±‚æŠ½è±¡ï¼Œç®€åŒ–åº”ç”¨äº¤ä»˜ä¸ç®¡ç†è¿‡ç¨‹ï¼›</li><li>ç»Ÿä¸€è¿›è¡Œäº‘æœåŠ¡çš„å£°æ˜ã€éƒ¨ç½²å’ŒæœåŠ¡ç»‘å®šï¼›</li><li>æä¾›å¼€ç®±å³ç”¨çš„äº¤ä»˜ç­–ç•¥ï¼ˆé‡‘ä¸é›€ã€è“ç»¿å‘å¸ƒç­‰ï¼‰ï¼›</li><li>æä¾›å¼€ç®±å³ç”¨çš„æ··åˆç¯å¢ƒ/å¤šé›†ç¾¤éƒ¨ç½²ç­–ç•¥ï¼ˆæ”¾ç½®è§„åˆ™ã€é›†ç¾¤è¿‡æ»¤è§„åˆ™ã€è·¨ç¯å¢ƒ Promotion ç­‰ï¼‰ï¼›</li><li>åœ¨å¤šç¯å¢ƒäº¤ä»˜ä¸­æä¾› Kustomize é£æ ¼çš„ Patch æ¥æè¿°éƒ¨ç½²å·®å¼‚ï¼Œè€Œç”¨æˆ·æ— éœ€å­¦ä¹ ä»»ä½• Kustomize æœ¬èº«çš„ç»†èŠ‚ï¼›</li><li>â€¦â€¦ ç­‰ç­‰ã€‚</li></ul><p>ä½¿ç”¨ KubeVela è·µè¡Œ GitOps ç†å¿µï¼Œè¯·å‚è€ƒ <a href="https://kubevela.io/docs/case-studies/gitops/" target="_blank" rel="noopener noreferrer">GitOps æœ€ä½³å®è·µ</a>ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="kubevela-ç¤¾åŒºä¸ç”Ÿæ€"></a>KubeVela ç¤¾åŒºä¸ç”Ÿæ€<a class="hash-link" href="#kubevela-ç¤¾åŒºä¸ç”Ÿæ€" title="Direct link to heading">#</a></h2><p>KubeVela æ˜¯ä¸€ä¸ªä»ç¬¬ä¸€å¤©å°±è¯ç”Ÿåœ¨äº‘åŸç”Ÿç¤¾åŒºçš„å¼€æºé¡¹ç›®ã€‚æˆªæ­¢ç›®å‰ï¼ŒKubeVela ç°å·²è¢« Salesforceã€å­—èŠ‚è·³åŠ¨ã€è…¾è®¯ã€ç½‘æ˜“æ¸¸æˆç­‰ 35+ å®¶ä¸åŒè¡Œä¸šçš„é¢†å…ˆä¼ä¸šåº”ç”¨åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒï¼Œå¸®åŠ©ä»–ä»¬åœ¨ä¸åŒåœºæ™¯ä¸‹å®ç°æ›´é«˜æ•ˆçš„äº‘åŸç”Ÿåº”ç”¨çš„äº¤ä»˜å’Œç®¡ç†ã€‚è€Œ KubeVela åœ¨ç¤¾åŒºç”¨æˆ·ä¸­çš„å¤§è§„æ¨¡å®è·µï¼Œä¹Ÿæ­£åœ¨ä¿ƒè¿› OAM æˆä¸ºæ··åˆäº‘/å¤šäº‘/åˆ†å¸ƒå¼äº‘é¢†åŸŸåº”ç”¨äº¤ä»˜çš„äº‹å®æ ‡å‡†ï¼Œå¹¶åœ¨å¾®è½¯ã€Oracle Cloud ç­‰å¤šå®¶å›½é™…å‚å•†ä¸­è¢«é‡‡ç”¨ã€‚è¿‘æ—¥ï¼Œä»¥ OAM æ¨¡å‹ä¸ºæ ¸å¿ƒçš„ã€Šäº‘è®¡ç®—å¼€æ”¾åº”ç”¨æ¶æ„ã€‹æ ‡å‡†æ–‡ä»¶ä¹Ÿå·²ç»ç”±é˜¿é‡Œäº‘è®¡ç®—æœ‰é™å…¬å¸ã€ä¸­å›½ä¿¡æ¯é€šä¿¡ç ”ç©¶é™¢ç­‰ 10 ä½™å®¶å•ä½è”åˆå‘èµ·å¹¶åœ¨â€œäº‘åŸç”Ÿäº§ä¸šå¤§ä¼šâ€ç°åœºå‘å¸ƒã€‚</p><p>åœ¨æœªæ¥ï¼Œåœ¨äº‘åŸç”Ÿç¤¾åŒºå’Œ CNCF åº”ç”¨äº¤ä»˜é¢†åŸŸå·¥ä½œç»„ï¼ˆTAG App Deliveryï¼‰çš„å…±åŒæ¨åŠ¨ä¸‹ï¼ŒKubeVela å°†ç»§ç»­åœ¨äº¤ä»˜å®šä¹‰æ ‡å‡†åŒ–ã€è¿ç»´èƒ½åŠ›å¤šæ ·åŒ–ã€ç®¡ç†ä½“ç³»ç”Ÿæ€åŒ–ä¸‰ä¸ªæ–¹é¢å‘å±•ï¼ŒçœŸæ­£å®ç°è®©æ··åˆç¯å¢ƒä¸‹çš„åº”ç”¨äº¤ä»˜å°±åƒæˆ‘ä»¬ä»Šå¤©ä½¿ç”¨ App Store ä¸€æ ·ç®€å•ã€‚ æˆ‘ä»¬çœ‹åˆ°å¼€æºç¤¾åŒºæ­£åœ¨å›´ç»• KubeVela çš„äº¤ä»˜æ¨¡å‹æå‡ºæ›´å¤šæ ‡å‡†åŒ–ç»„ä»¶ã€è¿ç»´ç‰¹å¾ã€æ’ä»¶ã€äº¤ä»˜ Step ç­‰èƒ½åŠ›ï¼Œä¹Ÿéå¸¸æ¬¢è¿æ–°è€ç¤¾åŒºç”¨æˆ·å‰å¾€ï¼š<a href="https://github.com/oam-dev/kubevela/issues/1662" target="_blank" rel="noopener noreferrer">https://github.com/oam-dev/kubevela/issues/1662</a> è¿›è¡Œç™»è®°ã€è®©ç¤¾åŒºå¬åˆ°æ¯ä¸€ä½å‚ä¸è€…çš„å£°éŸ³ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="åç»­ç‰ˆæœ¬è§„åˆ’"></a>åç»­ç‰ˆæœ¬è§„åˆ’<a class="hash-link" href="#åç»­ç‰ˆæœ¬è§„åˆ’" title="Direct link to heading">#</a></h2><p>æ‰“é€ å¤©ç„¶é¢å‘æ··åˆç¯å¢ƒçš„ä¼ä¸šåº”ç”¨æ“ä½œç³»ç»Ÿã€è®©å¼€å‘è€…äº«å—äº¤ä»˜åº”ç”¨çš„è¿‡ç¨‹ï¼Œè¿™æ˜¯ Kubevela é¡¹ç›®çš„ç›®æ ‡å’Œæ„¿æ™¯ï¼š</p><ul><li>1.0 ç‰ˆæœ¬ï¼ŒKubeVela å®ç°äº†åŸºç¡€çš„åº”ç”¨äº¤ä»˜æ ¸å¿ƒæ¨¡å‹ï¼Œè§£å†³äº†â€äº¤ä»˜ä¸€åˆ‡â€œçš„å…³é”®èƒ½åŠ›é—®é¢˜ï¼Œæ‰“é€ äº†å¯ç¼–ç¨‹çš„åº”ç”¨äº¤ä»˜å’Œç®¡ç†å¼•æ“ã€‚</li><li>1.1 ç‰ˆæœ¬ï¼ŒKubeVela è¿›ä¸€æ­¥å®Œå–„äº†é¢å‘å¤šç¯å¢ƒåº”ç”¨äº¤ä»˜çš„èƒ½åŠ›é›†å’Œå·¥ä½œæµï¼Œå¹¶ä¸”è®©ç”¨æˆ·å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œè¿›è¡Œå®Œæ•´ä½“éªŒï¼Œå¹¶ä¸”ä¸Šçº¿äº†å®Œæ•´çš„ä¸­æ–‡æ–‡æ¡£ã€‚</li></ul><p>è€Œåœ¨æ¥ä¸‹æ¥çš„ 1.2 ç‰ˆæœ¬ï¼ŒKubeVela å°†å¸¦æ¥ä»¥åº”ç”¨ä¸ºä¸­å¿ƒçš„æ§åˆ¶é¢æ¿UIï¼Œå®ç°ä¾¿æ·çš„ä¼ä¸šåº”ç”¨ç»„è£…ã€åˆ†å‘ã€äº¤ä»˜æµç¨‹ï¼Œæä¾›ç»™å¼€å‘è€…æ›´ç®€å•çš„åº”ç”¨äº¤ä»˜ä½“éªŒï¼ŒåŒæ—¶è¦†ç›–è¾¹ç¼˜åº”ç”¨äº¤ä»˜ç­‰æ›´å¤šçš„ä½¿ç”¨åœºæ™¯ã€‚</p><p><img src="https://intranetproxy.alipay.com/skylark/lark/0/2021/png/162010/1633667433567-6e740efc-a94f-4cdc-bfda-5703a0b704ab.png" alt="what-is"> </p><p>æ›´å¤šé¡¹ç›® Roadmap ä¿¡æ¯ï¼Œè¯¦è§ <a href="https://kubevela.io/docs/roadmap/README" target="_blank" rel="noopener noreferrer">Kubevela RoadMap</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å‚è€ƒä¿¡æ¯"></a>å‚è€ƒä¿¡æ¯<a class="hash-link" href="#å‚è€ƒä¿¡æ¯" title="Direct link to heading">#</a></h2><p>ç«‹å³å®‰è£…ä½¿ç”¨ï¼Œè¯·å‚è€ƒï¼š<a href="https://kubevela.io/docs/install" target="_blank" rel="noopener noreferrer">å®‰è£…æŒ‡å—</a></p><p>ä½ å¯ä»¥é€šè¿‡å¦‚ä¸‹ææ–™äº†è§£æ›´å¤šå…³äº KubeVela ä»¥åŠ OAM é¡¹ç›®çš„ç»†èŠ‚ï¼š</p><ul><li>é¡¹ç›®ä»£ç åº“ï¼š<a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer">https://github.com/oam-dev/kubevela</a> æ¬¢è¿ Star/Watch/Forkï¼</li><li>é¡¹ç›®å®˜æ–¹ä¸»é¡µä¸æ–‡æ¡£ï¼š<a href="https://kubevela.io" target="_blank" rel="noopener noreferrer">https://kubevela.io</a> ï¼Œä»1.1ç‰ˆæœ¬å¼€å§‹ï¼Œå·²æä¾›ä¸­æ–‡ã€è‹±æ–‡æ–‡æ¡£ï¼Œæ›´å¤šè¯­è¨€æ–‡æ¡£æ¬¢è¿å¼€å‘è€…è¿›è¡Œç¿»è¯‘ã€‚</li><li>é¡¹ç›®é’‰é’‰ç¾¤ï¼š23310022ï¼›Slackï¼š<a href="https://cloud-native.slack.com/archives/C01BLQ3HTJA" target="_blank" rel="noopener noreferrer">CNCF #kubevela Channel</a></li><li>åŠ å…¥å¾®ä¿¡ç¾¤ï¼šè¯·å…ˆæ·»åŠ ä»¥ä¸‹ maintainer å¾®ä¿¡å·ï¼Œè¡¨æ˜è¿›å…¥KubeVelaç”¨æˆ·ç¾¤ï¼š<img src="https://static.kubevela.net/images/barnett-wechat.jpg" width="200"></li></ul></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/zh/blog/tags/dev-ops">DevOps</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/zh/blog/2021/09/02/kubevela-jenkins-cicd">ä½¿ç”¨ Jenkins + KubeVela å®Œæˆåº”ç”¨çš„æŒç»­äº¤ä»˜</a></h2><div class="margin-vert--md"><time datetime="2021-09-02T00:00:00.000Z" class="blogPostDate_fNvV">2021å¹´9æœˆ2æ—¥ Â· é˜…è¯»éœ€è¦ 1 åˆ†é’Ÿ</time></div><div class="avatar margin-vert--md"><a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://kubevela.io/img/logo.svg" alt="Da Yin, Yang Song"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer">Da Yin, Yang Song</a></h4><small class="avatar__subtitle">KubeVela å›¢é˜Ÿ</small></div></div></header><div class="markdown"><p>KubeVela æ‰“é€šäº†åº”ç”¨ä¸åŸºç¡€è®¾æ–½ä¹‹é—´çš„äº¤ä»˜ç®¡æ§çš„å£å’ï¼Œç›¸è¾ƒäºåŸç”Ÿçš„ Kubernetes å¯¹è±¡ï¼ŒKubeVela çš„ Application æ›´å¥½åœ°ç®€åŒ–æŠ½è±¡äº†å¼€å‘è€…éœ€è¦å…³å¿ƒçš„é…ç½®ï¼Œå°†å¤æ‚çš„åŸºç¡€è®¾æ–½èƒ½åŠ›åŠç¼–æ’ç»†èŠ‚ç•™ç»™äº†å¹³å°å·¥ç¨‹å¸ˆã€‚è€Œ KubeVela çš„ apiserver åˆ™æ˜¯è¿›ä¸€æ­¥ä¸ºå¼€å‘è€…æä¾›äº†ä½¿ç”¨ HTTP Request ç›´æ¥æ“çºµ Application çš„é€”å¾„ï¼Œä½¿å¾—å¼€å‘è€…å³ä½¿æ²¡æœ‰ Kubernetes çš„ä½¿ç”¨ç»éªŒä¸é›†ç¾¤è®¿é—®æƒé™ä¹Ÿå¯ä»¥è½»æ¾éƒ¨ç½²è‡ªå·±çš„åº”ç”¨ã€‚</p><p>æœ¬æ–‡å°±ä»¥ç»å…¸çš„æŒç»­é›†æˆ (Continuous Integration) å·¥å…· Jenkins ä¸ºåŸºç¡€ï¼Œç®€å•ä»‹ç»å¦‚ä½•æ‰“é€ åŸºäº GitOps çš„åº”ç”¨æŒç»­äº¤ä»˜çš„â€œé«˜é€Ÿå…¬è·¯â€ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æŒç»­äº¤ä»˜é«˜é€Ÿå…¬è·¯"></a>æŒç»­äº¤ä»˜â€œé«˜é€Ÿå…¬è·¯â€<a class="hash-link" href="#æŒç»­äº¤ä»˜é«˜é€Ÿå…¬è·¯" title="Direct link to heading">#</a></h2><p>ä½œä¸ºåº”ç”¨å¼€å‘è€…çš„ä½ ï¼Œæ›´å¤šåœ°å…³å¿ƒè‡ªå·±çš„åº”ç”¨æ˜¯å¦æ­£å¸¸è¿ä½œï¼Œå¼€å‘æµç¨‹æ˜¯å¦ä¾¿æ·é«˜æ•ˆã€‚ä¸ºæ­¤ï¼Œåœ¨è¿™æ¡æŒç»­äº¤ä»˜çš„â€œé«˜é€Ÿå…¬è·¯â€ä¸Šï¼Œå°†ä¼šç”±ä»¥ä¸‹éƒ¨ä»¶ä¸ºä½ ä¿é©¾æŠ¤èˆªã€‚</p><ol><li>ä½ éœ€è¦ä¸€ä¸ª git ä»“åº“æ¥å­˜æ”¾åº”ç”¨ç¨‹åºä»£ç ã€æµ‹è¯•ä»£ç ï¼Œä»¥åŠæè¿° KubeVela Application çš„ YAML æ–‡ä»¶ã€‚</li><li>ä½ éœ€è¦ä¸€ä¸ªæŒç»­é›†æˆ (Continuous Integration) çš„å·¥å…·å¸®ä½ è‡ªåŠ¨åŒ–å®Œæˆç¨‹åºä»£ç çš„æµ‹è¯•ï¼Œå¹¶æ‰“åŒ…æˆé•œåƒä¸Šä¼ åˆ°ä»“åº“ä¸­ã€‚</li><li>ä½ éœ€è¦åœ¨ Kubernetes é›†ç¾¤ä¸Šå®‰è£… KubeVela å¹¶å¯ç”¨ apiserver åŠŸèƒ½ã€‚</li></ol><blockquote><p>ç›®å‰ KubeVela çš„ apiserver åœ¨æƒé™è®¤è¯æ–¹é¢ä»å¾…å®Œå–„ï¼Œåç»­å¯ç”¨ apiserver åå°†ä¼šåŠ å…¥æƒé™é…ç½®ç¯èŠ‚ã€‚</p></blockquote><p>æœ¬æ–‡çš„ä»‹ç»ä¸­é‡‡ç”¨äº† Github ä½œä¸º git ä»“åº“ï¼ŒJenkins ä½œä¸º CI å·¥å…·ï¼ŒDockerHub ä½œä¸ºé•œåƒä»“åº“ã€‚åº”ç”¨ç¨‹åºä»¥ä¸€ä¸ªç®€å•çš„ HTTP Server ä¸ºä¾‹ï¼Œæ•´ä¸ªæŒç»­äº¤ä»˜çš„æµç¨‹å¦‚ä¸‹ã€‚å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿™æ¡æŒç»­äº¤ä»˜çš„â€œé«˜é€Ÿå…¬è·¯â€ä¸Šï¼Œå¼€å‘è€…åªéœ€è¦å…³å¿ƒåº”ç”¨çš„å¼€å‘å¹¶ä½¿ç”¨ Git è¿›è¡Œä»£ç ç‰ˆæœ¬çš„ç»´æŠ¤ï¼Œå³å¯è‡ªåŠ¨èµ°å®Œæµ‹è¯•æµç¨‹å¹¶éƒ¨ç½²åº”ç”¨åˆ° Kubernetes é›†ç¾¤ä¸­ã€‚</p><p><img alt="arch" src="/zh/assets/images/arch-53b2b1a473f0d637d4c7c0b9a81dd2b0.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="éƒ¨ç½²ç¯å¢ƒ"></a>éƒ¨ç½²ç¯å¢ƒ<a class="hash-link" href="#éƒ¨ç½²ç¯å¢ƒ" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="jenkins-ç¯å¢ƒ"></a>Jenkins ç¯å¢ƒ<a class="hash-link" href="#jenkins-ç¯å¢ƒ" title="Direct link to heading">#</a></h3><blockquote><p>æœ¬æ–‡é‡‡ç”¨äº† Jenkins ä½œä¸ºæŒç»­é›†æˆå·¥å…·ï¼Œå¼€å‘è€…ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»– CI å·¥å…·ï¼Œå¦‚ TravisCI æˆ–è€… GitHub Actionã€‚</p></blockquote><p>é¦–å…ˆä½ éœ€è¦å‡†å¤‡ä¸€ä»½ Jenkins ç¯å¢ƒæ¥éƒ¨ç½² CI æµæ°´çº¿ã€‚å®‰è£…ä¸åˆå§‹åŒ– Jenkins æµç¨‹å¯ä»¥å‚è§<a href="https://www.jenkins.io/doc/book/installing/linux/" target="_blank" rel="noopener noreferrer">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºæœ¬æ–‡çš„ CI æµæ°´çº¿æ˜¯åŸºäº Docker åŠ GitHub çš„ï¼Œå› æ­¤åœ¨å®‰è£… Jenkins ä¹‹åè¿˜éœ€è¦å®‰è£…ç›¸å…³æ’ä»¶ (Dashboard &gt; Manage Jenkins &gt; Manage Plugins) ï¼ŒåŒ…æ‹¬ Pipelineã€HTTP Request Pluginã€Docker Pipelineã€Docker Pluginã€‚</p><p>æ­¤å¤–ï¼Œè¿˜éœ€è¦ä¸º Jenkins é…ç½® Docker çš„è¿è¡Œç¯å¢ƒ (Dashboard &gt; Manage Jenkins &gt; Configure System &gt; Docker Builder) ï¼Œå¦‚ Jenkins æ‰€åœ¨ç¯å¢ƒå·²ç»å®‰è£…äº† Dockerï¼Œå¯ä»¥å°† Docker URL é…ç½®ä¸º <code>unix:///var/run/docker.sock</code>ã€‚</p><p>ç”±äºåœ¨ CI æµæ°´çº¿è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œè¿˜éœ€è¦å°†å®¹å™¨é•œåƒæ¨è‡³é•œåƒä»“åº“ï¼Œä¸ºæ­¤éœ€åœ¨ Jenkins çš„ Credential ä¸­å°†é•œåƒä»“åº“çš„è´¦æˆ·é…ç½®å¥½ (Dashboard &gt; Manage Jenkins &gt; Manage Credentials &gt; Add Credentials) ï¼Œæ¯”å¦‚å°† DockerHub çš„ç”¨æˆ·ååŠå¯†ç å­˜å…¥ã€‚</p><p><img alt="jenkins-credential" src="/zh/assets/images/jenkins-credential-52c71b3f3a886ec0596a29a2356ad291.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="github-ä»“åº“ç¯å¢ƒ"></a>GitHub ä»“åº“ç¯å¢ƒ<a class="hash-link" href="#github-ä»“åº“ç¯å¢ƒ" title="Direct link to heading">#</a></h3><blockquote><p>æœ¬æ–‡çš„ä»‹ç»é‡‡ç”¨äº† Github ä½œä¸ºä»£ç ä»“åº“ï¼Œå¼€å‘è€…è¿˜å¯ä»¥æ ¹æ®å„è‡ªçš„éœ€æ±‚ä¸å–œå¥½ï¼Œä½¿ç”¨å…¶ä»–ä»£ç ä»“åº“ï¼Œå¦‚ Gitlabã€‚</p></blockquote><p>ä¸ºä½¿æŒç»­é›†æˆå·¥å…· Jenkins èƒ½å¤Ÿè·å–åˆ° GitHub ä¸­çš„æ›´æ–°ï¼Œå¹¶å°†æµæ°´çº¿çš„è¿è¡ŒçŠ¶æ€åé¦ˆå› GitHubï¼Œéœ€è¦åœ¨ GitHub ä¸­å®Œæˆä»¥ä¸‹ä¸¤æ­¥æ“ä½œã€‚</p><ol><li><a href="https://github.com/settings/tokens/new" target="_blank" rel="noopener noreferrer">é…ç½®</a> Personal Access Tokenã€‚æ³¨æ„å°† <code>repo:status</code> å‹¾é€‰ï¼Œä»¥è·å¾—å‘ GitHub æ¨é€ Commit çŠ¶æ€çš„æƒé™ã€‚</li></ol><p><img alt="github-pat" src="/zh/assets/images/github-pat-a8de5950eaf01a6d416a869d70b189ac.png"></p><p>ç„¶ååœ¨ Jenkins çš„ Credential ä¸­åŠ å…¥ Secret Text ç±»å‹çš„ Credential å¹¶å°†ä¸Šè¿°çš„ GitHub çš„ Personal Access Token å¡«å…¥ã€‚</p><p><img alt="jenkins-secret-text" src="/zh/assets/images/jenkins-secret-text-0de6c324500b26a5bfb81520ff7eab2b.png"></p><p>æœ€åæ¥åˆ° Jenkins çš„ Dashboard &gt; Manage Jenkins &gt; Configure System &gt; GitHub ä¸­ç‚¹å‡» Add GitHub Server å¹¶å°†åˆšæ‰åˆ›å»ºçš„ Credential å¡«å…¥ã€‚å®Œæˆåå¯ä»¥ç‚¹å‡» Test connection æ¥éªŒè¯é…ç½®æ˜¯å¦æ­£ç¡®ã€‚</p><p><img alt="jenkins-github" src="/zh/assets/images/jenkins-github-e99c47fab606f6c9c9f3f6f841840329.png"></p><ol start="2"><li>åœ¨ GitHub çš„ä»£ç ä»“åº“çš„è®¾å®šé‡Œæ·»åŠ  Webhookï¼Œå°† Jenkins çš„åœ°å€å¯¹åº”çš„ Webhook åœ°å€å¡«å…¥ï¼Œæ¯”å¦‚ <a href="http://my-jenkins.example.com/github-webhook/" target="_blank" rel="noopener noreferrer">http://my-jenkins.example.com/github-webhook/</a> ã€‚è¿™æ ·ï¼Œè¯¥ä»£ç ä»“åº“çš„æ‰€æœ‰ Push äº‹ä»¶æ¨é€åˆ° Jenkins ä¸­ã€‚</li></ol><p><img alt="github-webhook" src="/zh/assets/images/github-webhook-5579402b6bc37238d42842fd5d52fd02.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="kubevela-ç¯å¢ƒ"></a>KubeVela ç¯å¢ƒ<a class="hash-link" href="#kubevela-ç¯å¢ƒ" title="Direct link to heading">#</a></h3><p>ä½ éœ€è¦åœ¨ Kubernetes é›†ç¾¤ä¸­å®‰è£… KubeVelaï¼Œå¹¶å¯ç”¨ apiserver åŠŸèƒ½ï¼Œå¯ä»¥å‚è€ƒ<a href="/zh/docs/platform-engineers/advanced-install#install-kubevela-with-apiserver">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ç¼–å†™åº”ç”¨"></a>ç¼–å†™åº”ç”¨<a class="hash-link" href="#ç¼–å†™åº”ç”¨" title="Direct link to heading">#</a></h2><p>æœ¬æ–‡é‡‡ç”¨çš„åº”ç”¨æ˜¯ä¸€ä¸ªåŸºäº Golang è¯­è¨€ç¼–å†™çš„ç®€å•çš„ HTTP Serverã€‚åœ¨ä»£ç ä¸­ï¼Œå£°æ˜äº†ä¸€ä¸ªåå« <code>VERSION</code> çš„å¸¸é‡ï¼Œå¹¶åœ¨è®¿é—®è¯¥æœåŠ¡æ—¶æ‰“å°å‡ºæ¥ã€‚åŒæ—¶è¿˜é™„å¸¦ä¸€ä¸ªç®€å•çš„æµ‹è¯•ï¼Œç”¨æ¥æ ¡éªŒ <code>VERSION</code> çš„æ ¼å¼æ˜¯å¦ç¬¦åˆæ ‡å‡†ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly go"><div tabindex="0" class="prism-code language-go codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">// main.go</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">package</span><span class="token plain"> main</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;fmt&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;net/http&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> VERSION </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0.1.0-v1alpha1&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">main</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">HandleFunc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">w http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">ResponseWriter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> r </span><span class="token operator">*</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token boolean">_</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">_</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> fmt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Fprintf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">w</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Version: %s\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> VERSION</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> err </span><span class="token operator">:=</span><span class="token plain"> http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">ListenAndServe</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;:8088&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">nil</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> err </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token boolean">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token function" style="color:rgb(80, 250, 123)">println</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">err</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Error</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly go"><div tabindex="0" class="prism-code language-go codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">// main_test.go</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">package</span><span class="token plain"> main</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;regexp&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;testing&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> verRegex </span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">`^v?([0-9]+)(\.[0-9]+)?(\.[0-9]+)?`</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">`(-([0-9A-Za-z\-]+(\.[0-9A-Za-z\-]+)*))?`</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">`(\+([0-9A-Za-z\-]+(\.[0-9A-Za-z\-]+)*))?$`</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">TestVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">t </span><span class="token operator">*</span><span class="token plain">testing</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">T</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> ok</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">_</span><span class="token plain"> </span><span class="token operator">:=</span><span class="token plain"> regexp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">MatchString</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">verRegex</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> VERSION</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token operator">!</span><span class="token plain">ok </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        t</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Fatalf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;invalid version: %s&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> VERSION</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>åœ¨åº”ç”¨äº¤ä»˜æ—¶éœ€è¦å°† Golang æœåŠ¡æ‰“åŒ…æˆé•œåƒå¹¶ä»¥ KubeVela Application çš„å½¢å¼å‘å¸ƒåˆ° Kubernetes é›†ç¾¤ä¸­ï¼Œå› æ­¤åœ¨ä»£ç ä»“åº“ä¸­è¿˜åŒ…å« <code>Dockerfile</code> ä»¥åŠ <code>app.yaml</code> æ–‡ä»¶ï¼Œåˆ†åˆ«ç”¨æ¥æè¿°é•œåƒçš„æ‰“åŒ…æ–¹å¼ä»¥åŠ Application çš„ç›¸å…³é…ç½®ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly Dockerfile"><div tabindex="0" class="prism-code language-Dockerfile codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain"># Dockerfile</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">FROM golang:1.13-rc-alpine3.10 as builder</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">WORKDIR /app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">COPY main.go .</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">RUN go build -o kubevela-demo-cicd-app main.go</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">FROM alpine:3.10</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">WORKDIR /app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">COPY --from=builder /app/kubevela-demo-cicd-app /app/kubevela-demo-cicd-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">ENTRYPOINT ./kubevela-demo-cicd-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">EXPOSE 8088</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>åœ¨ app.yaml ä¸­ï¼Œå£°æ˜äº†éƒ¨ç½²çš„åº”ç”¨åŒ…å« 5 ä¸ªä¸åŒå‰¯æœ¬ï¼ŒåŒæ—¶é€šè¿‡ Ingress çš„å½¢å¼å‘å¸ƒç»™é›†ç¾¤å¤–éƒ¨ã€‚è€Œ labels åˆ™æ˜¯ç»™åº”ç”¨ä¸­çš„ Pod æ‰“ä¸Šäº†å½“å‰çš„ git commit ä½œä¸ºæ ‡ç­¾ã€‚å½“ Jenkins çš„éƒ¨ç½²æµæ°´çº¿è¿è¡Œæ—¶ï¼Œä¼šå°† GIT_COMMIT æ³¨å…¥å…¶ä¸­ï¼Œæäº¤åˆ° KubeVela apiserverï¼Œä»è€Œè§¦å‘ Application çš„æ›´æ–°ã€‚åœ¨ç‰ˆæœ¬æ›´æ–°è¿‡ç¨‹ä¸­ï¼ŒæŒ‰ç…§ 2, 3 çš„æ•°é‡åˆ†ä¸¤æ¬¡æ¬¡æ›´æ–°å‰¯æœ¬ï¼ŒåŒæ—¶åœ¨ç¬¬ä¸€æ¬¡æ›´æ–°ååœæ­¢è‡ªåŠ¨æ›´æ–°ï¼Œç­‰å¾…æ‰‹åŠ¨ç¡®è®¤åå†è¿›è¡Œå…¨éƒ¨æ›´æ–°ï¼Œå®ç°é‡‘ä¸é›€å‘å¸ƒçš„è¿‡ç¨‹ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># app.yaml</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> core.oam.dev/v1beta1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Application</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> kubevela</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">components</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> kubevela</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">app</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">web</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> webservice</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> somefive/kubevela</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">cicd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">imagePullPolicy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Always</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">traits</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> rollout</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">rolloutBatches</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">              </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">replicas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">              </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">replicas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">3</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">batchPartition</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">targetSize</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">5</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> labels</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">jenkins-build-commit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> GIT_COMMIT</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ingress</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">domain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> kubevela</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">cicd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">app.cf7c0ed25b151437ebe1ef58efc29bca4.us</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">west</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">1.alicontainer.com</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">              </span><span class="token key atrule">&quot;/&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">8088</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="é…ç½®-ci-æµæ°´çº¿"></a>é…ç½® CI æµæ°´çº¿<a class="hash-link" href="#é…ç½®-ci-æµæ°´çº¿" title="Direct link to heading">#</a></h2><p>åœ¨æœ¬æ–‡çš„æ¡ˆä¾‹ä¸­ï¼ŒåŒ…å«ä¸¤æ¡æµæ°´çº¿ï¼Œä¸€æ¡æ˜¯ç”¨æ¥è¿›è¡Œæµ‹è¯•çš„æµæ°´çº¿ (å¯¹åº”ç”¨ä»£ç è¿è¡Œæµ‹è¯•) ï¼Œä¸€æ¡æ˜¯äº¤ä»˜æµæ°´çº¿ (å°†åº”ç”¨ä»£ç æ‰“åŒ…ä¸Šä¼ é•œåƒä»“åº“ï¼ŒåŒæ—¶æ›´æ–°ç›®æ ‡ç¯å¢ƒä¸­çš„åº”ç”¨ï¼Œå®ç°è‡ªåŠ¨æ›´æ–°) ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æµ‹è¯•æµæ°´çº¿"></a>æµ‹è¯•æµæ°´çº¿<a class="hash-link" href="#æµ‹è¯•æµæ°´çº¿" title="Direct link to heading">#</a></h3><p>åœ¨ Jenkins ä¸­åˆ›å»ºä¸€æ¡æ–°çš„ Pipelineï¼Œå¹¶é…ç½® Build Triggers ä¸º GitHub hook trigger for GITScm pollingã€‚</p><p><img alt="test-pipeline-create" src="/zh/assets/images/test-pipeline-create-34edf7a7b95307cec884803ca545c2e3.png">
<img alt="test-pipeline-config" src="/zh/assets/images/test-pipeline-config-3ae2830ca7d45dbe9579a7814d96abc0.png"></p><p>åœ¨è¿™æ¡æµæ°´çº¿ä¸­ï¼Œé¦–å…ˆæ˜¯é‡‡ç”¨äº† golang çš„é•œåƒä½œä¸ºæ‰§è¡Œç¯å¢ƒï¼Œæ–¹ä¾¿åç»­è¿è¡Œæµ‹è¯•ã€‚ç„¶åå°†åˆ†æ”¯é…ç½®ä¸º GitHub ä»“åº“ä¸­çš„ dev åˆ†æ”¯ï¼Œä»£è¡¨è¯¥æ¡æµæ°´çº¿è¢« Push äº‹ä»¶è§¦å‘åä¼šæ‹‰å– dev åˆ†æ”¯ä¸Šçš„å†…å®¹å¹¶æ‰§è¡Œæµ‹è¯•ã€‚æµ‹è¯•ç»“æŸåå°†æµæ°´çº¿çš„çŠ¶æ€å›å†™è‡³ GitHub ä¸­ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly groovy"><div tabindex="0" class="prism-code language-groovy codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">void setBuildStatus(String message, String state) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  step([</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      $class: &quot;GitHubCommitStatusSetter&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      reposSource: [$class: &quot;ManuallyEnteredRepositorySource&quot;, url: &quot;https://github.com/Somefive/KubeVela-demo-CICD-app&quot;],</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      contextSource: [$class: &quot;ManuallyEnteredCommitContextSource&quot;, context: &quot;ci/jenkins/test-status&quot;],</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      errorHandlers: [[$class: &quot;ChangingBuildStatusErrorHandler&quot;, result: &quot;UNSTABLE&quot;]],</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      statusResultSource: [ $class: &quot;ConditionalStatusResultSource&quot;, results: [[$class: &quot;AnyBuildResult&quot;, message: message, state: state]] ]</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  ]);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">pipeline {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    agent {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        docker { image &#x27;golang:1.13-rc-alpine3.10&#x27; }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    stages {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        stage(&#x27;Prepare&#x27;) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            steps {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                script {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    def checkout = git branch: &#x27;dev&#x27;, url: &#x27;https://github.com/Somefive/KubeVela-demo-CICD-app.git&#x27;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    env.GIT_COMMIT = checkout.GIT_COMMIT</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    env.GIT_BRANCH = checkout.GIT_BRANCH</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    echo &quot;env.GIT_BRANCH=${env.GIT_BRANCH},env.GIT_COMMIT=${env.GIT_COMMIT}&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                setBuildStatus(&quot;Test running&quot;, &quot;PENDING&quot;);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        stage(&#x27;Test&#x27;) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            steps {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                sh &#x27;CGO_ENABLED=0 GOCACHE=$(pwd)/.cache go test *.go&#x27;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    post {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        success {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            setBuildStatus(&quot;Test success&quot;, &quot;SUCCESS&quot;);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        failure {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            setBuildStatus(&quot;Test failed&quot;, &quot;FAILURE&quot;);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="éƒ¨ç½²æµæ°´çº¿"></a>éƒ¨ç½²æµæ°´çº¿<a class="hash-link" href="#éƒ¨ç½²æµæ°´çº¿" title="Direct link to heading">#</a></h3><p>åœ¨éƒ¨ç½²æµæ°´çº¿ä¸­ï¼Œç±»ä¼¼æµ‹è¯•æµæ°´çº¿ï¼Œé¦–å…ˆå°†ä»£ç ä»“åº“ä¸­çš„åˆ†æ”¯æ‹‰å–ä¸‹æ¥ï¼ŒåŒºåˆ«æ˜¯è¿™é‡Œé‡‡ç”¨ prod åˆ†æ”¯ã€‚ç„¶åä½¿ç”¨ Docker è¿›è¡Œé•œåƒæ„å»ºå¹¶æ¨é€è‡³è¿œç«¯é•œåƒä»“åº“ (è¿™é‡Œä¸º DockerHubï¼Œå…¶ä¸­ withRegistry ä¸­å¡«å†™é•œåƒä»“åº“ä½ç½®ä»¥åŠåœ¨å…ˆå‰æ­¥éª¤ä¸­å­˜å…¥çš„ DockerHub çš„è´¦æˆ·å¯¹åº”çš„ Credential çš„ ID) ã€‚æ„å»ºæˆåŠŸåï¼Œå†å°† Application å¯¹åº”çš„ YAML æ–‡ä»¶è½¬æ¢ä¸º JSON æ–‡ä»¶å¹¶æ³¨å…¥ GIT_COMMITï¼Œæœ€åå‘ KubeVela apiserver (æ­¤å¤„ä¸º <a href="http://47.88.24.19/" target="_blank" rel="noopener noreferrer">http://47.88.24.19/</a>) å‘é€è¯·æ±‚è¿›è¡Œåˆ›å»ºæˆ–æ›´æ–°ã€‚</p><blockquote><p>ç›®å‰çš„ KubeVela apiserver æ¥æ”¶ JSON å‚æ•°ï¼Œå› æ­¤åœ¨æµæ°´çº¿ä¸­åšäº†ç›¸åº”çš„è½¬æ¢ã€‚æœªæ¥çš„ KubeVela apiserver å°†ä¼šè¿›ä¸€æ­¥æ”¹è¿›äº¤äº’æ¨¡å¼ï¼Œç®€åŒ–æ­¤å¤„çš„æµç¨‹ï¼ŒåŒæ—¶å†åŠ ä¸Šæ›´ä¸ºä¸¥æ ¼çš„æƒé™è®¤è¯ï¼Œæé«˜å®‰å…¨æ€§ã€‚</p></blockquote><blockquote><p>è¯¥æ¡ˆä¾‹ä¸­ä¼šå‘ kubevela-demo-namespace è¿™ä¸ª Namespace ä¸­åˆ›å»ºåå« cicd-demo-app çš„åº”ç”¨ï¼Œæ³¨æ„è¿™ä¸ª Namespace éœ€è¦é¢„å…ˆåœ¨ Kubernetes ä¸­åˆ›å»ºå‡ºæ¥ã€‚æœªæ¥ KubeVela çš„ apiserver åŒæ ·ä¼šç®€åŒ–è¿™ä¸€æµç¨‹ã€‚</p></blockquote><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly groovy"><div tabindex="0" class="prism-code language-groovy codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">void setBuildStatus(String message, String state) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  step([</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      $class: &quot;GitHubCommitStatusSetter&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      reposSource: [$class: &quot;ManuallyEnteredRepositorySource&quot;, url: &quot;https://github.com/Somefive/KubeVela-demo-CICD-app&quot;],</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      contextSource: [$class: &quot;ManuallyEnteredCommitContextSource&quot;, context: &quot;ci/jenkins/deploy-status&quot;],</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      errorHandlers: [[$class: &quot;ChangingBuildStatusErrorHandler&quot;, result: &quot;UNSTABLE&quot;]],</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      statusResultSource: [ $class: &quot;ConditionalStatusResultSource&quot;, results: [[$class: &quot;AnyBuildResult&quot;, message: message, state: state]] ]</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  ]);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">pipeline {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    agent any</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    stages {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        stage(&#x27;Prepare&#x27;) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            steps {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                script {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    def checkout = git branch: &#x27;prod&#x27;, url: &#x27;https://github.com/Somefive/KubeVela-demo-CICD-app.git&#x27;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    env.GIT_COMMIT = checkout.GIT_COMMIT</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    env.GIT_BRANCH = checkout.GIT_BRANCH</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    echo &quot;env.GIT_BRANCH=${env.GIT_BRANCH},env.GIT_COMMIT=${env.GIT_COMMIT}&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    setBuildStatus(&quot;Deploy running&quot;, &quot;PENDING&quot;);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        stage(&#x27;Build&#x27;) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            steps {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                script {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    docker.withRegistry(&quot;https://registry.hub.docker.com&quot;, &quot;DockerHubCredential&quot;) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                        def customImage = docker.build(&quot;somefive/kubevela-demo-cicd-app&quot;)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                        customImage.push()</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        stage(&#x27;Deploy&#x27;) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            steps {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                sh &#x27;wget -q &quot;https://github.com/mikefarah/yq/releases/download/v4.12.1/yq_linux_amd64&quot;&#x27;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                sh &#x27;chmod +x yq_linux_amd64&#x27;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                script {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    def app = sh (</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                        script: &quot;./yq_linux_amd64 eval -o=json &#x27;.spec&#x27; app.yaml | sed -e &#x27;s/GIT_COMMIT/$GIT_COMMIT/g&#x27;&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                        returnStdout: true</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    )</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    echo &quot;app: ${app}&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    def response = httpRequest acceptType: &#x27;APPLICATION_JSON&#x27;, contentType: &#x27;APPLICATION_JSON&#x27;, httpMode: &#x27;POST&#x27;, requestBody: app, url: &quot;http://47.88.24.19/v1/namespaces/kubevela-demo-namespace/applications/cicd-demo-app&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    println(&#x27;Status: &#x27;+response.status)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    println(&#x27;Response: &#x27;+response.content)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    post {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        success {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            setBuildStatus(&quot;Deploy success&quot;, &quot;SUCCESS&quot;);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        failure {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            setBuildStatus(&quot;Deploy failed&quot;, &quot;FAILURE&quot;);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><blockquote><p>å¤‡æ³¨ï¼šä¸Šè¿°çš„ Deploy é˜¶æ®µæ˜¯åŸºäº KubeVela 1.1 ç‰ˆæœ¬çš„ã€‚åœ¨ KubeVela 1.2 ç‰ˆæœ¬ä¸­ï¼ŒJenkins å¯¹æ¥ KubeVela APIServer çš„æ–¹æ³•å‘ç”Ÿäº†å˜åŒ–ï¼Œéœ€è¦ä½¿ç”¨ VelaUXï¼ˆUI æ§åˆ¶é¢æ¿ï¼‰å’Œ WebHook è§¦å‘å™¨ã€‚å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ KubeVela v1.2.0+ï¼Œä½ éœ€è¦å‚è€ƒå¯¹åº”ç‰ˆæœ¬çš„ç›¸å…³æ–‡æ¡£ã€‚</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å®é™…è¡¨ç°"></a>å®é™…è¡¨ç°<a class="hash-link" href="#å®é™…è¡¨ç°" title="Direct link to heading">#</a></h2><p>åœ¨å®Œæˆä¸Šè¿°çš„é…ç½®æµç¨‹åï¼ŒæŒç»­äº¤ä»˜çš„æµç¨‹ä¾¿å·²ç»æ­å»ºå®Œæˆã€‚æˆ‘ä»¬å¯ä»¥æ¥æ£€éªŒä¸€ä¸‹å®ƒçš„æ•ˆæœã€‚</p><p><img alt="pipeline-overview" src="/zh/assets/images/pipeline-overview-36827d3925d667b9d14612cb59e8fb4e.png"></p><p>æˆ‘ä»¬é¦–å…ˆå°† <code>main.go</code> ä¸­çš„ <code>VERSION</code> å­—æ®µä¿®æ”¹ä¸º <code>Bad Version Number</code>ï¼Œå³</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly go"><div tabindex="0" class="prism-code language-go codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> VERSION </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Bad Version Number&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ç„¶åæäº¤è¯¥ä¿®æ”¹è‡³ dev åˆ†æ”¯ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ° Jenkins ä¸Šçš„æµ‹è¯•æµæ°´çº¿è¢«è§¦å‘è¿è¡Œï¼Œå¤±è´¥åå°†è¯¥çŠ¶æ€å›å†™ç»™ GitHubã€‚</p><p><img alt="test-pipeline-fail" src="/zh/assets/images/test-pipeline-fail-23682b9d0c60a43f26be0a5a98e8a413.png">
<img alt="test-github-fail" src="/zh/assets/images/test-github-fail-5dd21696c58a212cf6ca2ee80e56567e.png"></p><p>æˆ‘ä»¬é‡æ–°å°† <code>VERSION</code> ä¿®æ”¹ä¸º 0.1.1ï¼Œç„¶åå†æ¬¡æäº¤ã€‚å¯ä»¥çœ‹åˆ°è¿™ä¸€æ¬¡æµ‹è¯•æµæ°´çº¿æˆåŠŸå®Œæˆæ‰§è¡Œï¼Œå¹¶åœ¨ GitHub å¯¹åº”çš„ Commit ä¸Šçœ‹åˆ°äº†æˆåŠŸçš„æ ‡å¿—ã€‚</p><p><img alt="test-pipeline-success" src="/zh/assets/images/test-pipeline-success-cd84def7976efb35b5071c9e361d2a77.png">
<img alt="test-github-success" src="/zh/assets/images/test-github-success-1d9c59d67bfd9b24d8b455fa21c6d985.png"></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨ GitHub ä¸Šæäº¤ Pull Request å°è¯•å°† dev åˆ†æ”¯ä¸Šçš„æ›´æ–°åˆå¹¶è‡³ prod åˆ†æ”¯ä¸Šã€‚</p><p><img alt="pull-request" src="/zh/assets/images/pull-request-eca7ff259bb26a6661d79691728b0b31.png"></p><p>å¯ä»¥çœ‹åˆ°åœ¨ Jenkins çš„éƒ¨ç½²æµæ°´çº¿æˆåŠŸè¿è¡Œç»“æŸåï¼ŒGitHub ä¸Š prod åˆ†æ”¯æœ€æ–°çš„ Commit ä¹Ÿæ˜¾ç¤ºäº†æˆåŠŸçš„æ ‡å¿—ã€‚</p><p><img alt="deploy-pipeline-success" src="/zh/assets/images/deploy-pipeline-success-7890c92b41e666ef46f3bd2dc1975ee7.png">
<img alt="deploy-github-success" src="/zh/assets/images/deploy-github-success-07f305b1b587e3fa8acc5df68fd8c297.png"></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ kubectl get app -n kubevela-demo-namespace</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">NAME                     COMPONENT               TYPE         PHASE     HEALTHY   STATUS   AGE</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-cicd-app   kubevela-demo-app-web   webservice   running   </span><span class="token boolean">true</span><span class="token plain">               112s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ kubectl get deployment -n kubevela-demo-namespace</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">NAME                       READY   UP-TO-DATE   AVAILABLE   AGE</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">2</span><span class="token plain">/2     </span><span class="token number">2</span><span class="token plain">            </span><span class="token number">2</span><span class="token plain">           2m1s</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>å¦‚å›¾æ˜¾ç¤ºï¼Œè¦éƒ¨ç½²çš„åº”ç”¨é¡ºåˆ©è¢« KubeVela apiserver æ¥å—å¹¶ç”± KubeVela æ§åˆ¶å™¨åˆ›å»ºäº†ç›¸å…³èµ„æºã€‚å½“å‰ Deployment çš„å‰¯æœ¬æ•°æ˜¯ 2ï¼Œåœ¨åˆ é™¤äº†è¯¥ Application ä¸­ rollout ç‰¹å¾å†…çš„ <code>batchPartition: 0</code> åä»£è¡¨ç¡®è®¤äº†å½“å‰çš„å‘å¸ƒï¼Œç„¶åå¯¹åº”çš„ Deployment å‰¯æœ¬æ•°æ›´æ–°è‡³ 5ã€‚è¿™æ—¶æˆ‘ä»¬å¯ä»¥è®¿é—® Ingress æ‰€é…ç½®çš„åŸŸåï¼ŒæˆåŠŸæ˜¾ç¤ºäº†å½“å‰çš„ç‰ˆæœ¬å·ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ kubectl edit app -n kubevela-demo-namespace</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">application.core.oam.dev/kubevela-demo-cicd-app edited</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ kubectl get deployment -n kubevela-demo-namespace -w</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">NAME                       READY   UP-TO-DATE   AVAILABLE   AGE</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">4</span><span class="token plain">/5     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">4</span><span class="token plain">           3m39s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">5</span><span class="token plain">/5     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">5</span><span class="token plain">           3m39s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">5</span><span class="token plain">/5     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">5</span><span class="token plain">           3m40s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">5</span><span class="token plain">/5     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">5</span><span class="token plain">           3m40s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> http://kubevela-demo-cicd-app.cf7c0ed25b151437ebe1ef58efc29bca4.us-west-1.alicontainer.com/</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Version: </span><span class="token number">0.1</span><span class="token plain">.1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æˆ‘ä»¬é‡å¤ä»¥ä¸Šæ­¥éª¤ï¼Œå°†ç‰ˆæœ¬å‡çº§è‡³ 0.1.2ï¼Œå®Œæˆæµ‹è¯•æµæ°´çº¿åŠéƒ¨ç½²æµæ°´çº¿ã€‚æ¥ç€æˆ‘ä»¬ä¼šå‘ç° Kubernetes çš„é›†ç¾¤å†…å¯¹åº”çš„ Application æ§åˆ¶çš„ Deployment å‘ç”Ÿäº†ç‰ˆæœ¬æ›´æ›¿ï¼Œæ—§ç‰ˆæœ¬çš„ Deployment ä» 5 å‰¯æœ¬ä¸‹é™åˆ° 3 å‰¯æœ¬ï¼Œæ–°ç‰ˆæœ¬çš„ Deployment åˆ™å‡ºç°äº† 2 å‰¯æœ¬ã€‚å¦‚æœæ­¤æ—¶æˆ‘ä»¬å†è®¿é—®åŸæ¥çš„æœåŠ¡åœ°å€ï¼Œä¼šå‘ç°æœ‰æ—¶ä¼šæ˜¾ç¤º 0.1.1 ç‰ˆæœ¬ï¼Œæœ‰æ—¶ä¼šæ˜¾ç¤º 0.1.2 ç‰ˆæœ¬ã€‚è¿™æ˜¯å› ä¸ºåœ¨å½“å‰æ»šåŠ¨æ›´æ–°è¿‡ç¨‹ä¸­ï¼Œæ–°æ—§å‰¯æœ¬åŒæ—¶å­˜åœ¨ï¼Œè®¿é—®çš„æµé‡ä¼šè¢«è´Ÿè½½å‡è¡¡å™¨åˆ†å‘åˆ°ä¸åŒçš„å‰¯æœ¬ä¸Šï¼Œå› æ­¤ä¼šå‡ºç°ä¸¤ç§ç‰ˆæœ¬çš„æœåŠ¡åŒæ—¶å­˜åœ¨çš„ç°è±¡ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ kubectl get deployment -n kubevela-demo-namespace -w</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">NAME                       READY   UP-TO-DATE   AVAILABLE   AGE</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">5</span><span class="token plain">/5     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">5</span><span class="token plain">           11m</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">0</span><span class="token plain">/0     </span><span class="token number">0</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           0s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">0</span><span class="token plain">/0     </span><span class="token number">0</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           0s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">0</span><span class="token plain">/0     </span><span class="token number">0</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           0s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">5</span><span class="token plain">/5     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">5</span><span class="token plain">           12m</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">0</span><span class="token plain">/0     </span><span class="token number">0</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           0s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">0</span><span class="token plain">/0     </span><span class="token number">0</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           0s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">0</span><span class="token plain">/0     </span><span class="token number">0</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           0s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">0</span><span class="token plain">/0     </span><span class="token number">0</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           0s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">0</span><span class="token plain">/2     </span><span class="token number">0</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           0s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">0</span><span class="token plain">/2     </span><span class="token number">0</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           0s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">0</span><span class="token plain">/2     </span><span class="token number">0</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           0s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">0</span><span class="token plain">/2     </span><span class="token number">2</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           0s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">5</span><span class="token plain">/5     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">5</span><span class="token plain">           12m</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">1</span><span class="token plain">/2     </span><span class="token number">2</span><span class="token plain">            </span><span class="token number">1</span><span class="token plain">           2s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">2</span><span class="token plain">/2     </span><span class="token number">2</span><span class="token plain">            </span><span class="token number">2</span><span class="token plain">           2s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">5</span><span class="token plain">/3     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">5</span><span class="token plain">           13m</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">5</span><span class="token plain">/3     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">5</span><span class="token plain">           13m</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">3</span><span class="token plain">/3     </span><span class="token number">3</span><span class="token plain">            </span><span class="token number">3</span><span class="token plain">           13m</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> http://kubevela-demo-cicd-app.cf7c0ed25b151437ebe1ef58efc29bca4.us-west-1.alicontainer.com/</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Version: </span><span class="token number">0.1</span><span class="token plain">.1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> http://kubevela-demo-cicd-app.cf7c0ed25b151437ebe1ef58efc29bca4.us-west-1.alicontainer.com/</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Version: </span><span class="token number">0.1</span><span class="token plain">.1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> http://kubevela-demo-cicd-app.cf7c0ed25b151437ebe1ef58efc29bca4.us-west-1.alicontainer.com/</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Version: </span><span class="token number">0.1</span><span class="token plain">.1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> http://kubevela-demo-cicd-app.cf7c0ed25b151437ebe1ef58efc29bca4.us-west-1.alicontainer.com/</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Version: </span><span class="token number">0.1</span><span class="token plain">.1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> http://kubevela-demo-cicd-app.cf7c0ed25b151437ebe1ef58efc29bca4.us-west-1.alicontainer.com/</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Version: </span><span class="token number">0.1</span><span class="token plain">.2</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> http://kubevela-demo-cicd-app.cf7c0ed25b151437ebe1ef58efc29bca4.us-west-1.alicontainer.com/</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Version: </span><span class="token number">0.1</span><span class="token plain">.2</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> http://kubevela-demo-cicd-app.cf7c0ed25b151437ebe1ef58efc29bca4.us-west-1.alicontainer.com/</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Version: </span><span class="token number">0.1</span><span class="token plain">.2</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> http://kubevela-demo-cicd-app.cf7c0ed25b151437ebe1ef58efc29bca4.us-west-1.alicontainer.com/</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Version: </span><span class="token number">0.1</span><span class="token plain">.2</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> http://kubevela-demo-cicd-app.cf7c0ed25b151437ebe1ef58efc29bca4.us-west-1.alicontainer.com/</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Version: </span><span class="token number">0.1</span><span class="token plain">.1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>å½“æˆ‘ä»¬ç¡®è®¤æ–°ç‰ˆæœ¬çš„æœåŠ¡æ­£å¸¸è¿ä½œåï¼Œå¯ä»¥ç±»ä¼¼ä¸Šè¿°æ­¥éª¤ï¼Œå°† Application ä¸­ rollout ç‰¹æ€§å†…çš„ <code>batchPartition: 0</code> åˆ å»ï¼Œå®Œæˆæ•´ä¸ªé‡‘ä¸é›€å‘å¸ƒæµç¨‹ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ kubectl get deployment -n kubevela-demo-namespace -w</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">NAME                       READY   UP-TO-DATE   AVAILABLE   AGE</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">3</span><span class="token plain">/3     </span><span class="token number">3</span><span class="token plain">            </span><span class="token number">3</span><span class="token plain">           18m</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">2</span><span class="token plain">/2     </span><span class="token number">2</span><span class="token plain">            </span><span class="token number">2</span><span class="token plain">           5m24s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">2</span><span class="token plain">/5     </span><span class="token number">2</span><span class="token plain">            </span><span class="token number">2</span><span class="token plain">           5m36s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">2</span><span class="token plain">/5     </span><span class="token number">2</span><span class="token plain">            </span><span class="token number">2</span><span class="token plain">           5m37s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">2</span><span class="token plain">/5     </span><span class="token number">2</span><span class="token plain">            </span><span class="token number">2</span><span class="token plain">           5m37s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">2</span><span class="token plain">/5     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">2</span><span class="token plain">           5m37s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">3</span><span class="token plain">/5     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">3</span><span class="token plain">           5m38s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">4</span><span class="token plain">/5     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">4</span><span class="token plain">           5m38s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">5</span><span class="token plain">/5     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">5</span><span class="token plain">           5m39s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">3</span><span class="token plain">/0     </span><span class="token number">3</span><span class="token plain">            </span><span class="token number">3</span><span class="token plain">           18m</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">3</span><span class="token plain">/0     </span><span class="token number">3</span><span class="token plain">            </span><span class="token number">3</span><span class="token plain">           18m</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">0</span><span class="token plain">/0     </span><span class="token number">0</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           18m</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">0</span><span class="token plain">/0     </span><span class="token number">0</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           18m</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">5</span><span class="token plain">/5     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">5</span><span class="token plain">           5m41s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">5</span><span class="token plain">/5     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">5</span><span class="token plain">           5m41s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">0</span><span class="token plain">/0     </span><span class="token number">0</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           18m</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å°ç»“"></a>å°ç»“<a class="hash-link" href="#å°ç»“" title="Direct link to heading">#</a></h2><p>è‡³æ­¤ï¼Œæˆ‘ä»¬ä¾¿å·²ç»æˆåŠŸå®ç°äº†ä¸€æ•´å¥—æŒç»­äº¤ä»˜æµç¨‹ã€‚åœ¨è¿™ä¸ªæµç¨‹ä¸­ï¼Œåº”ç”¨çš„å¼€å‘è€…å€ŸåŠ© KubeVela + Jenkins çš„èƒ½åŠ›ï¼Œå¯ä»¥è½»æ¾å®Œæˆåº”ç”¨çš„è¿­ä»£æ›´æ–°ã€é›†æˆæµ‹è¯•ã€è‡ªåŠ¨å‘å¸ƒä¸æ»šåŠ¨å‡çº§ï¼Œè€Œæ•´ä¸ªæµç¨‹åœ¨å„ä¸ªç¯èŠ‚ä¹Ÿå¯ä»¥æŒ‰ç…§å¼€å‘è€…çš„å–œå¥½å’Œæ¡ä»¶é€‰æ‹©ä¸åŒçš„å·¥å…·ï¼Œæ¯”å¦‚ä½¿ç”¨ Gitlab æ›¿ä»£ GitHubï¼Œæˆ–æ˜¯ä½¿ç”¨ TravisCI æ›¿ä»£ Jenkinsã€‚</p><p>åœ¨ä¸Šè¿°è¿‡ç¨‹ä¸­ï¼Œç»†å¿ƒçš„è¯»è€…å¯èƒ½è¿˜ä¼šå‘ç°ï¼Œè¿™å¥—æµç¨‹ä¸ä»…èƒ½å¤Ÿå®ç°åº”ç”¨æœåŠ¡çš„å‡çº§ï¼Œè€Œä¸”è¿˜å¯ä»¥é€šè¿‡ä¿®æ”¹ app.yaml è‡ªåŠ¨å®Œæˆéƒ¨ç½²æ–¹æ¡ˆçš„å‡çº§ï¼Œæ¯”å¦‚å°† 5 å‰¯æœ¬åº”ç”¨æ‰©å®¹åˆ° 10 å‰¯æœ¬ï¼Œæˆ–æ˜¯ä¸ºå®¹å™¨æ·»åŠ  sidecarï¼Œä»è€Œå®ç°éƒ¨åˆ† GitOps èƒ½åŠ›ã€‚å…³äºä½¿ç”¨ KubeVela å®è·µ GitOps çš„æ›´å¤šå†…å®¹ï¼Œæ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥ç»§ç»­é˜…è¯»ç›¸å…³æ¡ˆä¾‹ã€‚</p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/zh/blog/tags/kube-vela">KubeVela</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/zh/blog/2021/08/30/kubevela-performance-test">KubeVela Performance Test - Managing Massive Applications</a></h2><div class="margin-vert--md"><time datetime="2021-08-30T00:00:00.000Z" class="blogPostDate_fNvV">2021å¹´8æœˆ30æ—¥ Â· é˜…è¯»éœ€è¦ 1 åˆ†é’Ÿ</time></div><div class="avatar margin-vert--md"><a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://kubevela.io/img/logo.svg" alt="Da Yin, Yang Song, Zhengxi Zhou and Jianbo Sun"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer">Da Yin, Yang Song, Zhengxi Zhou and Jianbo Sun</a></h4><small class="avatar__subtitle">KubeVela Team</small></div></div></header><div class="markdown"><p>As an application management and integration platform, KubeVela needs to handle thousands of applications in production scenario. To evaluate the performance of KubeVela, develop team has conducted performance tests based on simultated environments and demonstrated the capability of managing a large number of applications concurrently.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="setup"></a>Setup<a class="hash-link" href="#setup" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="cluster-environment"></a>Cluster Environment<a class="hash-link" href="#cluster-environment" title="Direct link to heading">#</a></h3><p>Working with large clusters requires lots of resources, such as Machines, Network Bandwidth, Storages and many other devices. Therefore, KubeVela team adopts kubemark, an official tool provided by kubernetes, to simulate large clusters by mocking hundreds of kubelets. Each kubelet works like a real node except that they do not run real containers inside pods. The aim of KubeVela performance test mainly focus on whether KubeVela controller can manage thousands of applications effectively, instead of pulling images or executing commands inside pods. As a result, we only need to get resources hosting these fake nodes, also named as hollow-nodes.</p><p>We set up the Kubernetes clusters on Alibaba Cloud which includes 5 master nodes and 15 worker nodes. The master nodes wil host Kubernetes core components such as kube-apiserver and kube-controller-manager. The worker nodes need to run other pressure-test related componets, including monitoring tools, KubeVela controller and kubemark pods. Since the major target is to test the performance of KubeVela controller, we do not expect other components to be the bottleneck of the pressure test. To this end, both master nodes and worker nodes are equiped with 32 cores and 128 Gi memory. We use the combination of Prometheus, Loki and Grafana as the monitoring suites and grant them enough resources in avoid of crash caused by Out-of-Memory.</p><p>Notice that KubeVela controller and monitoring tools need to be placed on real nodes to function while all pods created during performance tests should be assigned to hollow-nodes correctly. To achieve that, we give different taints to hollow-nodes and real nodes, and add corresponding tolerations to different pods.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="application"></a>Application<a class="hash-link" href="#application" title="Direct link to heading">#</a></h3><p>To simulate real applications in production, we design an application template with 2 components and 5 functional traits, including</p><ul><li>1 webservice component<ul><li>a scaler trait setting its replica to 3</li><li>a sidecar trait attaching another container to each pod</li><li>an ingress trait generating one ingress instance and one service instance</li></ul></li><li>1 worker component<ul><li>a scaler trait also setting its replica to 3</li><li>a configmap trait generating a new configmap and attaching it to worker pods</li></ul></li></ul><p>In the following experiment, we test the performance of KubeVela controller managing 3,000 Applications (12,000 Pods in total) on 200 nodes. Applications are created in parallel at first, then kept running for a while, and finally deleted from the cluster. Each application will be reconciled multiple times with latencies and consumed resources recorded by monitoring tools.</p><blockquote><p>In practice, we also have another trait used for adding tolerations as described above.</p></blockquote><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="kubevela-controller"></a>KubeVela Controller<a class="hash-link" href="#kubevela-controller" title="Direct link to heading">#</a></h3><p>The KubeVela controller is set up with a group of recommendation configurations as follows</p><ul><li>Kubernetes Resource<ul><li>0.5 core CPU</li><li>1 Gi Memory</li><li>1 replica</li></ul></li><li>Program <ul><li>concurrent-reconciles=2 (The number of reconcile threads)</li><li>kube-api-qps=300 (The qps of kubernetes client used in controller)</li><li>kube-api-burst=500 (The burst of kubernetes client used in controller)</li><li>informer-re-sync-interval=20m (The interval of routine reconciles.)
We will analyze these settings in the below sections.</li></ul></li></ul><blockquote><p>To evaluate the performance of KubeVela Controller itself, we disabled the Ingress MutatingWebhook and Application ValidatingWebhook which is beyond the focus of this test but will affect the performance of KubeVela Controller by increasing the latency of creating/patching resources.</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="experiments"></a>Experiments<a class="hash-link" href="#experiments" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="creation"></a>Creation<a class="hash-link" href="#creation" title="Direct link to heading">#</a></h3><p>The creation of all 3,000 applications lasted 25min. Getting all pods running takes a bit longer time, which is out of the scope of KubeVela controller. </p><p>For each application creation, it will trigger three turns of reconciling. The usage of CPU will reach 100% in the late period of creation. The memory usage will increase as the number of applications rises. It reaches around 67% at the end of creation.</p><p><img alt="create-cpu" src="/zh/assets/images/create-cpu-50a2f951ca18219c47f86fc87861387a.png">
<img alt="create-memory" src="/zh/assets/images/create-memory-1d5a108aa88dca5b5233df07b975869f.png"></p><p>The average time of the first turn reconciling is relatively short since it only needs patch finalizer. The second and third turn reconciling contain full reconcile cycles and need more time to process. The following charts record the time consumptions of different period during reconciling applications. The average time is generally below 200ms while 99% of reconciles uses less than 800ms.</p><p><img alt="create-avg-time" src="/zh/assets/images/create-avg-time-c9096f848bacebb15879e354db90ad79.png">
<img alt="create-p99-time" src="/zh/assets/images/create-p99-time-6834848739195ef1a6836e8830a60940.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="regular-reconciles"></a>Regular Reconciles<a class="hash-link" href="#regular-reconciles" title="Direct link to heading">#</a></h3><p>After creation, applications are reconciled by controller every 20min. the monitoring of 8-hour reconcile process are displayed as below. The CPU usage will come up to 90% once reconcile happens routinely. The memory usage generally keeps a stable pattern, up to 75% memory usage.</p><p><img alt="med-cpu" src="/zh/assets/images/med-cpu-1ee6beebe2ddac70499b2fe0f1200346.png">
<img alt="med-memory" src="/zh/assets/images/med-memory-84ee70599fdfe10c539d31a8ffd011f3.png"></p><p>The average reconcile time is under 200ms while 99% are about 800ms~900ms. Each regular reconcile for all applications generally takes around 10min.</p><p><img alt="med-avg" src="/zh/assets/images/med-avg-71e81f42a57ba18fe977c1cb8f041e6f.png">
<img alt="med-p99" src="/zh/assets/images/med-p99-660473173a37679faf8f5c54a4668b7c.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="deletion"></a>Deletion<a class="hash-link" href="#deletion" title="Direct link to heading">#</a></h3><p>The application deletion process is fast and low-resource consumptive. It takes less than 3min to delete all applications. However, notice that the deletion of resources managed by application usually takes longer time. This is because the cleanup of these resources (such as deployments or pods) are not directly controlled by the KubeVela controller. KubeVela controller takes charge of deleting their owner and cleanup them by triggering cascading deletion. In addition, each deletion is associated with two turns of reconcile where the second turn returns immediately when it fails to retrieve target applciation (since it is deleted).</p><p><img alt="del-cpu" src="/zh/assets/images/del-cpu-e20c033c8d55123b17d4daf25af8b0e1.png">
<img alt="del-memory" src="/zh/assets/images/del-memory-7185fe1f634f7bfede12924608db96f2.png">
<img alt="del-avg" src="/zh/assets/images/del-avg-b8c9b19de6d6472f5ad751ee5b13cd22.png">
<img alt="del-p99" src="/zh/assets/images/del-p99-c2efbbd508a210d006bbb511944ec547.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="analysis"></a>Analysis<a class="hash-link" href="#analysis" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="number-of-applications"></a>Number of Applications<a class="hash-link" href="#number-of-applications" title="Direct link to heading">#</a></h3><p>The experiment displayed above demonstrates a classical scenario for KubeVela. Although 3,000 applications are successfully managed by the KubeVela controller in this case, it is strongly recommended to adopt a smaller number (such as 2,000) of applications with the above configuration for the following reasons:
The time and resource consumption is closely associated with the spec of applications. If a lot of users apply larger applications with more pods and more other resources, 3,000 applications might break the resource limit more easily.
The memory and CPU usage shown above is approching resource limits. If memory drains, the KubeVela controller will crash and restart. If high CPU usage maintains for a long time, it might cause a long waiting queue in KubeVela controller which further lead to longer response time for application changes.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="configurations"></a>Configurations<a class="hash-link" href="#configurations" title="Direct link to heading">#</a></h3><p>There are several parameters users could config to adapt into their own scenario.
Using more replica for KubeVela controller do not scale up the ability of KubeVela controller. The leader election mechanism ensures that only one replica will work while others will wait. The aim of multi-replica is to support fast recovery when the working one crash. However, if the crash is caused by OOM, the recovery usually will not be able to fix that.
The number of qps and burst in the program configuration should be increased accordingly while scaling up KubeVela controller. These two parameters limit the capability for controller to send requests to apiserver.
Generally, in order to scale up KubeVela controller, scale up the resource limits and all the program parameters mentioned above (except the reconcile interval). If you have more applications to manage, add more memory. If you have higher operation frequency, add more CPU and threads, then increase qps and burst accordingly.
Longer reconcile interval allows more applications to handle, at the cost of longer time to fix potential underlying resource problems. For example, if one deployment managed by one application disappears, the routine reconciling can discover this problem and fix it.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="scaling-up"></a>Scaling Up<a class="hash-link" href="#scaling-up" title="Direct link to heading">#</a></h3><p>In addition to the experiment described above, we conducted another two experiment to test how well KubeVela controller can scale to larger clusters and more applications.</p><p>In a 500-node cluster, we tried to create 5,000 applications with the same spec described above, at the speed of 4 per second and lasted for around 21min. 1 core and 2 Gi memory are granted to KubeVela controller with the use of 4 concurrent reconcile threads. The kube-api-qps and kube-api-burst are raised to 500/800 correspondingly. All 30,000 pods successfully turn into Running phase. The time costs for each reconcile is similar to the previous experiment and CPU/Memory cost is not very high compared to the given resources. The regular reconciles for 5,000 applications takes 7~8 minutes, and no significant resource cost is observed. During this scaling, we found that the throughput of kube-apiserver starts to block the creation of application, as too many resources need to be created while applying applications.</p><p><img alt="std-cpu" src="/zh/assets/images/std-cpu-ffd81b9aa9f3f19744fe28d7f9817e73.png">
<img alt="std-memory" src="/zh/assets/images/std-memory-d0fb9771e7ab4d9588ef193424a76073.png"></p><p>Scaling up to 12,000 applications on 1,000 nodes is much harder than previous attempts. With the same creation speed, the apiserver will be flooded by lots of pod scheduling requests and finally start to drop application creation request. To overcome this difficulty, we divide the creation process of applications into several stage. Each stage only create 1,000~3,000 applications and the next stage will not begin until all pods are ready. With this strategy, we successfully create 12,000 applications, 24,000 deployments, 12,000 services, 12,000 ingress, 12,000 configmaps and 72,000 pods. The whole process takes about 30 hours. To hold this number of applications, KubeVela controller consumes 1.7 cores and 2.45 Gi memory. It takes about 12min to finish a full turn of regular reconciles for all 12,000 applications.</p><p><img alt="large-cpu" src="/zh/assets/images/large-cpu-d83276edbb15f8a396f27ea144625469.png">
<img alt="large-memory" src="/zh/assets/images/large-memory-360f435a8446f13a86246c19fad2f729.png">
<img alt="large-all" src="/zh/assets/images/large-all-8b83d8c79d4faf56ba67aa9594ce5eee.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="future"></a>Future<a class="hash-link" href="#future" title="Direct link to heading">#</a></h3><p>The performance test of KubeVela demonstrates its ability of managing thousands of applications with limited resource consumption. It can also scale up to over 10,000 applications on large clusters with 1,000 nodes. In addition, KubeVela team also conducted similar pressure test for non-deployment based applications such as CloneSet in OpenKruise (which is not enclosed in this report) and reach same conclusions. In the future, we will add more performance tests for more complex scenario like Workflow or MultiCluster.</p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/zh/blog/tags/kube-vela">KubeVela</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/zh/blog/2020/12/07/kubevela-the-extensible-app-platform-based-on-open-application-model-and-kubernetes">KubeVela æ­£å¼å¼€æºï¼šä¸€ä¸ªé«˜å¯æ‰©å±•çš„äº‘åŸç”Ÿåº”ç”¨å¹³å°ä¸æ ¸å¿ƒå¼•æ“</a></h2><div class="margin-vert--md"><time datetime="2020-12-07T00:00:00.000Z" class="blogPostDate_fNvV">2020å¹´12æœˆ7æ—¥ Â· é˜…è¯»éœ€è¦ 1 åˆ†é’Ÿ</time></div><div class="avatar margin-vert--md"><a href="https://github.com/resouer" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://avatars.githubusercontent.com/u/1701782?s=200&amp;v=4" alt="Lei Zhang and Fei Guo"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/resouer" target="_blank" rel="noopener noreferrer">Lei Zhang and Fei Guo</a></h4><small class="avatar__subtitle">CNCF TOC Member/Kubernetes</small></div></div></header><div class="markdown"><blockquote><p>2020å¹´12æœˆ7æ—¥ 12:33, by Lei Zhang and Fei Guo</p></blockquote><p><img src="https://tva1.sinaimg.cn/large/ad5fbf65gy1glgj5q8inej208g049aa6.jpg" alt="image"></p><p>ç¾å›½è¥¿éƒ¨æ—¶é—´ 2020 å¹´ 11 æœˆ 18 æ—¥ï¼Œåœ¨äº‘åŸç”ŸæŠ€æœ¯â€œæœ€é«˜ç››å®´â€çš„ KubeCon åŒ—ç¾å³°ä¼š 2020 ä¸Šï¼ŒCNCF åº”ç”¨äº¤ä»˜é¢†åŸŸå°ç»„ï¼ˆCNCF SIG App Delivery) ä¸ Open Application Model (OAM) ç¤¾åŒºï¼Œä»¥åŠæ¥è‡ªé˜¿é‡Œäº‘ã€å¾®è½¯äº‘çš„ OAM é¡¹ç›®ç»´æŠ¤è€…ä»¬åœ¨æ¼”è®²ä¸­å…±åŒå®£å¸ƒäº† KubeVela å¼€æºé¡¹ç›®çš„æ­£å¼å‘å¸ƒã€‚</p><p>ä» 11 æœˆ 18 å·åˆ° 20 å·ï¼Œåœ¨ä¸ºæœŸä¸‰å¤©çš„ KubeCon åŒ—ç¾å³°ä¼šä¸Šæœ‰è¿ç»­ 3 åœºæŠ€æœ¯æ¼”è®²ï¼Œä¼šä»ä¸åŒç»´åº¦ä»‹ç»å…³äº KubeVela é¡¹ç›®çš„å…·ä½“ç»†èŠ‚ï¼Œå…¶ä¸­è¿˜åŒ…æ‹¬ä¸€ä¸ªé•¿è¾¾ 1 ä¸ªåŠå°æ—¶çš„ KubeVela äº’åŠ¨æ•™å­¦ç¯èŠ‚ã€‚å¤šä¸ªé‡é‡çº§ç»„ç»‡ä»¥å¦‚æ­¤è§„æ¨¡å’Œå¯†åº¦åœ¨ KubeCon åŒ—ç¾å³°ä¼šæ¼”è®²ä¸­ä»‹ç»ä¸€ä¸ªé¦–æ¬¡å‘å¸ƒçš„ç¤¾åŒºå¼€æºé¡¹ç›®ï¼Œåœ¨ KubeCon è¯ç”Ÿä»¥æ¥å¹¶ä¸å¤šè§ã€‚</p><p>KubeVela Github åœ°å€ï¼š<a href="https://github.com/oam-dev/kubevela/" target="_blank" rel="noopener noreferrer">https://github.com/oam-dev/kubevela/</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ä»€ä¹ˆæ˜¯-kubevela-ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ KubeVela ï¼Ÿ<a class="hash-link" href="#ä»€ä¹ˆæ˜¯-kubevela-ï¼Ÿ" title="Direct link to heading">#</a></h2><p>ä¸€è¨€ä»¥è”½ä¹‹ï¼Œ<strong>KubeVela æ˜¯ä¸€ä¸ªç®€å•æ˜“ç”¨ä¸”é«˜åº¦å¯æ‰©å±•çš„åº”ç”¨ç®¡ç†å¹³å°ä¸æ ¸å¿ƒå¼•æ“</strong>ã€‚KubeVela æ˜¯åŸºäº Kubernetes ä¸ OAM æŠ€æœ¯æ„å»ºçš„ã€‚</p><p>è¯¦ç»†çš„è¯´ï¼Œå¯¹äºåº”ç”¨å¼€å‘äººå‘˜æ¥è®²ï¼ŒKubeVela æ˜¯ä¸€ä¸ªéå¸¸ä½å¿ƒæ™ºè´Ÿæ‹…çš„äº‘åŸç”Ÿåº”ç”¨ç®¡ç†å¹³å°ï¼Œæ ¸å¿ƒåŠŸèƒ½æ˜¯è®©å¼€å‘äººå‘˜æ–¹ä¾¿å¿«æ·åœ°åœ¨ Kubernetes ä¸Šå®šä¹‰ä¸äº¤ä»˜ç°ä»£å¾®æœåŠ¡åº”ç”¨ï¼Œæ— éœ€äº†è§£ä»»ä½• Kubernetes æœ¬èº«ç›¸å…³çš„ç»†èŠ‚ã€‚åœ¨è¿™ä¸€ç‚¹ä¸Šï¼ŒKubeVela å¯ä»¥è¢«è®¤ä¸ºæ˜¯<strong>äº‘åŸç”Ÿç¤¾åŒºçš„ Heroku</strong>ã€‚</p><p>å¦ä¸€æ–¹é¢ï¼Œå¯¹äºå¹³å°å›¢é˜Ÿæ¥è®²ï¼ŒKubeVela æ˜¯ä¸€ä¸ªå¼ºå¤§å¹¶ä¸”é«˜å¯æ‰©å±•çš„äº‘åŸç”Ÿåº”ç”¨å¹³å°æ ¸å¿ƒå¼•æ“ã€‚åŸºäºè¿™æ ·ä¸€ä¸ªå¼•æ“ï¼Œå¹³å°å›¢é˜Ÿå¯ä»¥å¿«é€Ÿã€é«˜æ•ˆåœ°ä»¥ Kubernetes åŸç”Ÿçš„æ–¹å¼åœ¨ KubeVela ä¸­æ¤å…¥ä»»ä½•æ¥è‡ªäº‘åŸç”Ÿç¤¾åŒºçš„åº”ç”¨ç®¡ç†èƒ½åŠ›ï¼Œä»è€ŒåŸºäº KubeVela æ‰“é€ å‡ºè‡ªå·±éœ€è¦çš„äº‘åŸç”Ÿå¹³å°ï¼Œæ¯”å¦‚ï¼šäº‘åŸç”Ÿæ•°æ®åº“ PaaSã€äº‘åŸç”Ÿ AI å¹³å°ã€ç”šè‡³ Serverless æœåŠ¡ã€‚åœ¨è¿™ä¸€ç‚¹ä¸Šï¼ŒKubeVela å¯ä»¥è¢«è®¤ä¸ºæ˜¯<strong>ä¸€ä¸ªâ€œä»¥åº”ç”¨ä¸ºä¸­å¿ƒâ€çš„ Kubernetes å‘è¡Œç‰ˆ</strong>ï¼Œä»¥ OAM ä¸ºæ ¸å¿ƒï¼Œè®©å¹³å°å›¢é˜Ÿå¯ä»¥åŸºäº KubeVela å¿«é€Ÿæ‰“é€ å‡ºå±äºè‡ªå·±çš„ PaaSã€Serverless ä¹ƒè‡³ä»»ä½•é¢å‘ç”¨æˆ·çš„äº‘åŸç”Ÿå¹³å°é¡¹ç›®ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="kubevela-è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ"></a>KubeVela è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ<a class="hash-link" href="#kubevela-è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ" title="Direct link to heading">#</a></h2><p>ç°å¦‚ä»Šï¼Œäº‘åŸç”ŸæŠ€æœ¯çš„è¿…çŒ›å‘å±•å¯èƒ½è®©å¾ˆå¤šäººéƒ½æ„Ÿè§‰åˆ°çœ¼èŠ±ç¼­ä¹±ï¼Œä½†å®é™…ä¸Šï¼Œè¿™ä¸ªç”Ÿæ€çš„æ€»ä½“å‘å±•è¶‹åŠ¿å’Œä¸»æ—‹å¾‹ï¼Œæ˜¯é€šè¿‡ Kubernetes æ­å»ºäº†ä¸€ä¸ªç»Ÿä¸€çš„åŸºç¡€è®¾æ–½æŠ½è±¡å±‚ï¼Œä¸ºå¹³å°å›¢é˜Ÿå±è”½æ‰äº†â€œè®¡ç®—â€ã€â€œç½‘ç»œâ€ã€â€œå­˜å‚¨â€ç­‰è¿‡å»æˆ‘ä»¬ä¸å¾—ä¸å…³æ³¨çš„åŸºç¡€è®¾æ–½æ¦‚å¿µï¼Œä½¿å¾—æˆ‘ä»¬èƒ½å¤ŸåŸºäº Kubernetes æ–¹ä¾¿åœ°æ„å»ºå‡ºä»»ä½•æˆ‘ä»¬æƒ³è¦çš„å‚ç›´ä¸šåŠ¡ç³»ç»Ÿè€Œæ— éœ€å…³å¿ƒä»»ä½•åŸºç¡€è®¾æ–½å±‚çš„ç»†èŠ‚ã€‚è¿™æ­£æ˜¯ Kubernetes è¢«ç§°ä¸ºäº‘è®¡ç®—ç•Œçš„ Linux ä»¥åŠ â€œPlatform for Platformsâ€ çš„æ ¹æœ¬åŸå› ã€‚</p><p>ä½†æ˜¯ï¼Œå½“æˆ‘ä»¬æŠŠè§†è§’ä»å¹³å°å›¢é˜Ÿæå‡åˆ°å‚ç›´ä¸šåŠ¡ç³»ç»Ÿçš„æœ€ç»ˆç”¨æˆ·ï¼ˆå¦‚ï¼šåº”ç”¨å¼€å‘äººå‘˜ï¼‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šå‘ç° Kubernetes è¿™æ ·çš„å®šä½å’Œè®¾è®¡åœ¨è§£å†³äº†å¹³å°å›¢é˜Ÿçš„å¤§é—®é¢˜ä¹‹åï¼Œå´ä¹Ÿä¸ºç”¨æˆ·ä»¬å¸¦æ¥äº†æŒ‘æˆ˜å’Œå›°æ‰°ã€‚æ¯”å¦‚ï¼Œå¤ªå¤šçš„ç”¨æˆ·éƒ½åœ¨æŠ±æ€¨ Kubernetes â€œå¤ªå¤æ‚äº†â€ã€‚ç©¶å…¶åŸå› ï¼Œå…¶å®åœ¨äº Kubernetes ä¸­çš„æ ¸å¿ƒæ¦‚å¿µä¸ä½“ç³»ï¼Œå¦‚ï¼šPodã€sidecarã€Serviceã€èµ„æºç®¡ç†ã€è°ƒåº¦ç®—æ³•å’Œ CRD ç­‰ç­‰ï¼Œä¸»è¦æ˜¯é¢å‘å¹³å°å›¢é˜Ÿè€Œéæœ€ç»ˆç”¨æˆ·è®¾è®¡çš„ã€‚ç¼ºä¹é¢å‘ç”¨æˆ·çš„è®¾è®¡ä¸ä»…å¸¦æ¥äº†é™¡å³­çš„å­¦ä¹ æ›²çº¿ï¼Œå½±å“äº†ç”¨æˆ·çš„ä½¿ç”¨ä½“éªŒï¼Œæ‹–æ…¢äº†ç ”å‘æ•ˆèƒ½ï¼Œç”šè‡³åœ¨å¾ˆå¤šæƒ…å†µä¸‹è¿˜ä¼šå¼•å‘é”™è¯¯æ“ä½œä¹ƒè‡³ç”Ÿäº§æ•…éšœï¼ˆæ¯•ç«Ÿä¸å¯èƒ½æ¯ä¸ªä¸šåŠ¡å¼€å‘äººå‘˜éƒ½æ˜¯ Kubernetes ä¸“å®¶ï¼‰ã€‚</p><p>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨äº‘åŸç”Ÿç”Ÿæ€ä¸­ï¼Œå‡ ä¹æ¯ä¸€ä¸ªå¹³å°å›¢é˜Ÿéƒ½ä¼šåŸºäº Kubernetes æ„å»ºä¸€ä¸ªä¸Šå±‚å¹³å°ç»™ç”¨æˆ·ä½¿ç”¨ã€‚æœ€ç®€å•çš„ä¹Ÿä¼šç»™ Kubernetes åšä¸€ä¸ªå›¾å½¢ç•Œé¢ï¼Œç¨å¾®æ­£å¼ä¸€äº›çš„åˆ™å¾€å¾€ä¼šåŸºäº Kubernetes å¼€å‘ä¸€ä¸ªç±» PaaS å¹³å°æ¥æ»¡è¶³è‡ªå·±çš„éœ€æ±‚ã€‚ç†è®ºä¸Šè®²ï¼Œåœ¨ Kubernetes ç”Ÿæ€ä¸­å„ç§èƒ½åŠ›å·²ç»éå¸¸ä¸°å¯Œçš„ä»Šå¤©ï¼Œå¼€å‘ä¸€ä¸ªç±» PaaS å¹³å°åº”è¯¥æ˜¯æ¯”è¾ƒå®¹æ˜“çš„ã€‚</p><p>ç„¶è€Œç°å®å´å¾€å¾€ä¸å°½å¦‚äººæ„ã€‚åœ¨å¤§é‡çš„ç¤¾åŒºè®¿è°ˆå½“ä¸­ï¼Œæˆ‘ä»¬å‘ç°åœ¨äº‘åŸç”ŸæŠ€æœ¯æå¤§æ™®åŠçš„ä»Šå¤©ï¼ŒåŸºäº Kubernetes æ„å»ºä¸€ä¸ªåŠŸèƒ½å®Œå–„ã€ç”¨æˆ·å‹å¥½çš„ä¸Šå±‚åº”ç”¨å¹³å°ï¼Œä¾ç„¶æ˜¯ä¸­å¤§å‹å…¬å¸ä»¬çš„â€œä¸“åˆ©â€ã€‚è¿™é‡Œçš„åŸå› åœ¨äºï¼š</p><blockquote><p>Kubernetes ç”Ÿæ€æœ¬èº«çš„èƒ½åŠ›æ± å›ºç„¶ä¸°å¯Œï¼Œä½†æ˜¯ç¤¾åŒºé‡Œå´å¹¶æ²¡æœ‰ä¸€ä¸ªå¯æ‰©å±•çš„ã€æ–¹ä¾¿å¿«æ·çš„æ–¹å¼ï¼Œèƒ½å¤Ÿå¸®åŠ©å¹³å°å›¢é˜ŸæŠŠè¿™äº›èƒ½åŠ›å¿«é€Ÿâ€œç»„è£…â€æˆé¢å‘æœ€ç»ˆç”¨æˆ·çš„åŠŸèƒ½ï¼ˆFeatureï¼‰ã€‚</p></blockquote><p>è¿™ç§å›°å¢ƒå¸¦æ¥çš„ç»“æœï¼Œå°±æ˜¯å°½ç®¡å¤§å®¶ä»Šå¤©éƒ½åœ¨åŸºäº Kubernetes åœ¨æ„å»ºä¸Šå±‚åº”ç”¨å¹³å°ï¼Œä½†è¿™äº›å¹³å°æœ¬è´¨ä¸Šå´å¹¶ä¸èƒ½å¤Ÿä¸ Kubernetes ç”Ÿæ€å®Œå…¨æ‰“é€šï¼Œè€Œéƒ½å˜æˆä¸€ä¸ªåˆä¸€ä¸ªçš„å‚ç›´â€œçƒŸå›±â€ã€‚</p><p>åœ¨å¼€æºç¤¾åŒºä¸­ï¼Œè¿™ä¸ªé—®é¢˜ä¼šæ›´åŠ æ˜æ˜¾ã€‚åœ¨ä»Šå¤©çš„ Kubernetes ç¤¾åŒºä¸­ï¼Œä¸ä¹å„ç§â€œé¢å‘ç”¨æˆ·â€ã€â€œé¢å‘åº”ç”¨â€çš„ Kubernetes ä¸Šå±‚ç³»ç»Ÿã€‚ä½†æ­£å¦‚å‰æ–‡æ‰€è¿°ï¼Œè¿™äº›å¹³å°éƒ½æ— ä¸€ä¾‹å¤–çš„å¼•å…¥äº†è‡ªå·±çš„ä¸“å±ä¸Šå±‚æŠ½è±¡ã€ç”¨æˆ·ç•Œé¢å’Œæ’ä»¶æœºåˆ¶ã€‚è¿™é‡Œæœ€å…¸å‹çš„ä¾‹å­åŒ…æ‹¬ç»å…¸ PaaS é¡¹ç›®æ¯”å¦‚ Cloud Foundryï¼Œä¹ŸåŒ…æ‹¬å„ç§ Serverless å¹³å°ã€‚ä½œä¸ºä¸€ä¸ªå…¬å¸çš„å¹³å°å›¢é˜Ÿï¼Œæˆ‘ä»¬å®é™…ä¸Šåªæœ‰ä¸¤ä¸ªé€‰æ‹©ï¼šè¦ä¹ˆæŠŠè‡ªå·±å±€é™åœ¨æŸç§å‚ç›´çš„åœºæ™¯ä¸­æ¥é€‚é…å’Œé‡‡çº³æŸä¸ªå¼€æºä¸Šå±‚å¹³å°é¡¹ç›®ï¼›è¦ä¹ˆå°±åªèƒ½è‡ªç ”ä¸€ä¸ªç¬¦åˆè‡ªå·±è¯‰æ±‚çš„ä¸Šå±‚å¹³å°å¹¶ä¸”é€ æ— æ•°ä¸ªç¤¾åŒºä¸­å·²ç»å­˜åœ¨çš„â€œè½®å­â€ã€‚</p><p>é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰â€ç¬¬ä¸‰ç§é€‰æ‹©â€èƒ½å¤Ÿè®©å¹³å°å›¢é˜Ÿåœ¨ä¸é€ è½®å­ã€å®Œå…¨æ‰“é€š Kubernetes ç”Ÿæ€çš„å‰æä¸‹ï¼Œè½»æ¾çš„æ„å»ºé¢å‘ç”¨æˆ·çš„ä¸Šå±‚å¹³å°å‘¢ï¼Ÿ</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="kubevela-å¦‚ä½•è§£å†³ä¸Šè¿°é—®é¢˜ï¼Ÿ"></a>KubeVela å¦‚ä½•è§£å†³ä¸Šè¿°é—®é¢˜ï¼Ÿ<a class="hash-link" href="#kubevela-å¦‚ä½•è§£å†³ä¸Šè¿°é—®é¢˜ï¼Ÿ" title="Direct link to heading">#</a></h2><p>KubeVela é¡¹ç›®çš„åˆ›ç«‹åˆè¡·ï¼Œå°±æ˜¯ä»¥ä¸€ä¸ªç»Ÿä¸€çš„æ–¹å¼åŒæ—¶è§£å†³ä¸Šè¿°æœ€ç»ˆç”¨æˆ·ä¸å¹³å°å›¢é˜Ÿæ‰€é¢ä¸´çš„å›°å¢ƒã€‚è¿™ä¹Ÿæ˜¯ä¸ºä½•åœ¨è®¾è®¡ä¸­ï¼ŒKubeVela å¯¹æœ€ç»ˆç”¨æˆ·å’Œå¹³å°å›¢é˜Ÿè¿™ä¸¤ç§ç¾¤ä½“è¿›è¡Œäº†å•ç‹¬çš„ç”»åƒï¼Œä»¥æ»¡è¶³ä»–ä»¬ä¸åŒçš„è¯‰æ±‚ã€‚</p><p>ç”±äº KubeVela é»˜è®¤çš„åŠŸèƒ½é›†ä¸â€œHerokuâ€ç±»ä¼¼ï¼ˆå³ï¼šä¸»è¦é¢å‘åº”ç”¨å¼€å‘äººå‘˜ï¼‰ï¼Œæ‰€ä»¥åœ¨ä¸‹æ–‡ä¸­ï¼Œæˆ‘ä»¬ä¼šä»¥åº”ç”¨å¼€å‘äººå‘˜æˆ–è€…å¼€å‘è€…æ¥ä»£æ›¿æœ€ç»ˆç”¨æˆ·ã€‚ä½†æˆ‘ä»¬å¾ˆå¿«ä¹Ÿä¼šè®²åˆ°ï¼ŒKubeVela é‡Œçš„æ¯ä¸€ä¸ªåŠŸèƒ½ï¼Œéƒ½æ˜¯ä¸€ä¸ªæ’ä»¶ï¼Œä½œä¸ºå¹³å°å›¢é˜Ÿï¼Œä½ å¯ä»¥è½»æ¾åœ°â€œå¸è½½â€å®ƒçš„æ‰€æœ‰å†…ç½®èƒ½åŠ›ã€ç„¶åâ€œå®‰è£…â€è‡ªå·±éœ€è¦çš„ä»»ä½•ç¤¾åŒºèƒ½åŠ›ï¼Œè®© KubeVela å˜æˆä¸€ä¸ªå®Œå…¨ä¸ä¸€æ ·çš„ç³»ç»Ÿã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="1-ç”¨æˆ·çœ¼ä¸­çš„-kubevela"></a>1. ç”¨æˆ·çœ¼ä¸­çš„ KubeVela<a class="hash-link" href="#1-ç”¨æˆ·çœ¼ä¸­çš„-kubevela" title="Direct link to heading">#</a></h3><p>å‰é¢å·²ç»æåˆ°ï¼Œå¯¹äºå¼€å‘è€…æ¥è¯´ï¼ŒKubeVela æ˜¯ä¸€ä¸ªç®€å•ã€æ˜“ç”¨ã€åˆé«˜å¯æ‰©å±•çš„äº‘åŸç”Ÿåº”ç”¨ç®¡ç†å·¥å…·ï¼Œå®ƒå¯ä»¥è®©å¼€å‘è€…ä»¥æä½çš„å¿ƒæ™ºè´Ÿæ‹…å’Œä¸Šæ‰‹æˆæœ¬åœ¨ Kubernetes ä¸Šå®šä¹‰ä¸éƒ¨ç½²åº”ç”¨ã€‚è€Œå…³äºæ•´ä¸ªç³»ç»Ÿçš„ä½¿ç”¨ï¼Œå¼€å‘è€…åªéœ€è¦ç¼–å†™ä¸€ä¸ª docker-compose é£æ ¼åº”ç”¨æè¿°æ–‡ä»¶ Appfile å³å¯ï¼Œä¸éœ€è¦æ¥è§¦å’Œå­¦ä¹ ä»»ä½• Kubernetes å±‚çš„ç›¸å…³ç»†èŠ‚ã€‚</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="1ï¼‰ä¸€ä¸ª-appfile-ç¤ºä¾‹"></a>1ï¼‰ä¸€ä¸ª Appfile ç¤ºä¾‹<a class="hash-link" href="#1ï¼‰ä¸€ä¸ª-appfile-ç¤ºä¾‹" title="Direct link to heading">#</a></h4><p>åœ¨ä¸‹è¿°ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¼šå°†ä¸€ä¸ªå«åš vela.yaml çš„ Appfile æ”¾åœ¨ä½ çš„åº”ç”¨ä»£ç ç›®å½•ä¸­ï¼ˆæ¯”å¦‚åº”ç”¨çš„ GitHub Repoï¼‰ã€‚è¿™ä¸ª Appfile å®šä¹‰äº†å¦‚ä½•å°†è¿™ä¸ªåº”ç”¨ç¼–è¯‘æˆ Docker é•œåƒï¼Œå¦‚ä½•å°†é•œåƒéƒ¨ç½²åˆ° Kubernetesï¼Œå¦‚ä½•é…ç½®å¤–ç•Œè®¿é—®åº”ç”¨çš„è·¯ç”±å’ŒåŸŸåï¼Œåˆå¦‚ä½•è®© Kubernetes è‡ªåŠ¨æ ¹æ® CPU ä½¿ç”¨é‡æ¥æ°´å¹³æ‰©å±•è¿™ä¸ªåº”ç”¨ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> testapp</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">services</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">express-server</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> oamdev/testapp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">v1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">build</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">docker</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">file</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Dockerfile</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">contrxt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> .</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">cmd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;node&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;server.js&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">cpu</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0.01&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">route</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">domain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> example.com</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">rules</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> /testapp</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">rewriteTarget</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> /</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">autoscale</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">min</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">max</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">cpuPercent</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">5</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>åªè¦æœ‰äº†è¿™ä¸ª 20 è¡Œçš„é…ç½®æ–‡ä»¶ï¼Œä½ æ¥ä¸‹æ¥å”¯ä¸€éœ€è¦çš„äº‹æƒ…å°±æ˜¯ $ vela upï¼Œè¿™ä¸ªåº”ç”¨å°±ä¼šè¢«éƒ¨ç½²åˆ° Kubernetes ä¸­ç„¶åè¢«å¤–ç•Œä»¥ <a href="https://example.com/testapp" target="_blank" rel="noopener noreferrer">https://example.com/testapp</a> çš„æ–¹å¼è®¿é—®åˆ°ã€‚</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="2ï¼‰appfile-æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ"></a>2ï¼‰Appfile æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ<a class="hash-link" href="#2ï¼‰appfile-æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ" title="Direct link to heading">#</a></h4><p>åœ¨ KubeVela çš„ Appfile èƒŒåï¼Œæœ‰ç€éå¸¸ç²¾å¦™çš„è®¾è®¡ã€‚é¦–å…ˆéœ€è¦æŒ‡å‡ºçš„å°±æ˜¯ï¼Œ<strong>è¿™ä¸ª Appfile æ˜¯æ²¡æœ‰å›ºå®šçš„ Schema çš„</strong>ã€‚</p><p>ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿè¿™ä¸ª Appfile é‡Œé¢ä½ èƒ½å¤Ÿå¡«å†™çš„æ¯ä¸€ä¸ªå­—æ®µï¼Œéƒ½æ˜¯ç›´æ¥å–å†³äºå½“å‰å¹³å°ä¸­æœ‰å“ªäº›å·¥ä½œè´Ÿè½½ç±»å‹ï¼ˆWorkload Typesï¼‰å’Œåº”ç”¨ç‰¹å¾ï¼ˆTraitsï¼‰æ˜¯å¯ç”¨çš„ã€‚è€Œç†Ÿæ‚‰ OAM çš„åŒå­¦éƒ½çŸ¥é“ï¼Œè¿™ä¸¤ä¸ªæ¦‚å¿µï¼Œæ­£æ˜¯ OAM è§„èŒƒçš„æ ¸å¿ƒå†…å®¹ï¼Œå…¶ä¸­ï¼š</p><ul><li><p><a href="https://kubevela.io/#/en/concepts?id=workload-type-amp-trait" target="_blank" rel="noopener noreferrer">å·¥ä½œè´Ÿè½½ç±»å‹ï¼ˆWorkload Typeï¼‰</a>ï¼Œå®šä¹‰çš„æ˜¯åº•å±‚åŸºç¡€è®¾æ–½å¦‚ä½•è¿è¡Œè¿™ä¸ªåº”ç”¨ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å£°æ˜ï¼šåå« testapp çš„åº”ç”¨ä¼šå¯åŠ¨ä¸€ä¸ªç±»å‹ä¸ºâ€œåœ¨çº¿ Web æœåŠ¡ï¼ˆWeb Serviceï¼‰â€ çš„å·¥ä½œè´Ÿè½½ï¼Œå…¶å®ä¾‹çš„åå­—æ˜¯ express-serverã€‚</p></li><li><p><a href="https://kubevela.io/#/en/concepts?id=workload-type-amp-trait" target="_blank" rel="noopener noreferrer">åº”ç”¨ç‰¹å¾ï¼ˆTraitsï¼‰</a>ï¼Œåˆ™ä¸ºå·¥ä½œè´Ÿè½½å®ä¾‹åŠ ä¸Šäº†è¿ç»´æ—¶é…ç½®ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª Route Trait æ¥æè¿°åº”ç”¨å¦‚ä½•è¢«ä»å¤–ç•Œè®¿é—®ï¼Œä»¥åŠä¸€ä¸ª Autoscale Trait æ¥æè¿°åº”ç”¨å¦‚ä½•æ ¹æ® CPU ä½¿ç”¨é‡è¿›è¡Œè‡ªåŠ¨çš„æ°´å¹³æ‰©å®¹ã€‚</p></li></ul><p>è€Œæ­£æ˜¯åŸºäºè¿™ç§æ¨¡å—åŒ–çš„è®¾è®¡ï¼Œè¿™ä¸ª Appfile æœ¬èº«æ˜¯é«˜åº¦å¯æ‰©å±•çš„ã€‚å½“ä»»ä½•ä¸€ä¸ªæ–°çš„ Workload Type æˆ–è€… Trait è¢«å®‰è£…åˆ°å¹³å°åï¼Œç”¨æˆ·å°±å¯ä»¥ç«‹åˆ»åœ¨ Appfile é‡Œå£°æ˜ä½¿ç”¨è¿™ä¸ªæ–°å¢çš„èƒ½åŠ›ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚åé¢å¹³å°å›¢é˜Ÿæ–°å¼€å‘äº†ä¸€ä¸ªç”¨æ¥é…ç½®åº”ç”¨ç›‘æ§å±æ€§çš„è¿ç»´ä¾§èƒ½åŠ›ï¼Œå«åš Metricsã€‚é‚£ä¹ˆåªéœ€è¦ä¸¾æ‰‹ä¹‹æï¼Œç”¨æˆ·å°±å¯ä»¥ç«‹åˆ»ä½¿ç”¨ $ vela show metrics å‘½ä»¤æŸ¥çœ‹è¿™ä¸ªæ–°å¢èƒ½åŠ›çš„è¯¦æƒ…ï¼Œå¹¶ä¸”åœ¨ Appfile ä¸­ä½¿ç”¨å®ƒï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> testapp</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">services</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">express-server</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> webservice</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> oamdev/testapp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">v1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">build</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">docker</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">file</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Dockerfile</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">contrxt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> .</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">cmd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;node&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;server.js&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">cpu</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0.01&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">route</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">domain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> example.com</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">rules</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> /testapp</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">rewriteTarget</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> /</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">autoscale</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">min</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">max</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">cpuPercent</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">5</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">metrices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/metrics&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">scheme</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;http&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">enabled</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean important">true</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>è¿™ç§ç®€å•å‹å¥½ã€åˆé«˜åº¦æ•æ·çš„ä½¿ç”¨ä½“éªŒï¼Œæ­£æ˜¯ KubeVela åœ¨æœ€ç»ˆç”¨æˆ·ä¾§æä¾›çš„ä¸»è¦ä½“æ„Ÿã€‚</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="3ï¼‰vela-up-å‘½ä»¤"></a>3ï¼‰Vela Up å‘½ä»¤<a class="hash-link" href="#3ï¼‰vela-up-å‘½ä»¤" title="Direct link to heading">#</a></h4><p>å‰é¢æåˆ°ï¼Œä¸€æ—¦ Appfile å‡†å¤‡å¥½ï¼Œå¼€å‘è€…åªéœ€è¦ä¸€å¥ vela up å‘½ä»¤å°±å¯ä»¥æŠŠæ•´ä¸ªåº”ç”¨è¿åŒå®ƒçš„è¿ç»´ç‰¹å¾éƒ¨ç½²åˆ° Kubernetes ä¸­ã€‚éƒ¨ç½²æˆåŠŸåï¼Œä½ å¯ä»¥ä½¿ç”¨ vela status æ¥æŸ¥çœ‹æ•´ä¸ªåº”ç”¨çš„è¯¦æƒ…ï¼ŒåŒ…æ‹¬å¦‚ä½•è®¿é—®è¿™ä¸ªåº”ç”¨ã€‚</p><p><img src="https://tvax2.sinaimg.cn/large/ad5fbf65gy1glf9pyhr42j20la0kiafn.jpg"></p><p>é€šè¿‡ KubeVela éƒ¨ç½²çš„åº”ç”¨ä¼šè¢«è‡ªåŠ¨è®¾ç½®å¥½è®¿é—® URLï¼ˆä»¥åŠä¸åŒç‰ˆæœ¬å¯¹åº”çš„ä¸åŒ URLï¼‰ï¼Œå¹¶ä¸”ä¼šç”± cert-manager ç”Ÿæˆå¥½è¯ä¹¦ã€‚ä¸æ­¤åŒæ—¶ï¼ŒKubeVela è¿˜æä¾›äº†ä¸€ç³»åˆ—è¾…åŠ©å‘½ä»¤ï¼ˆæ¯”å¦‚ï¼švela logs å’Œ vela execï¼‰æ¥å¸®åŠ©ä½ åœ¨æ— éœ€æˆä¸º Kubernetes ä¸“å®¶çš„æƒ…å†µä¸‹æ›´å¥½åœ°ç®¡ç†å’Œè°ƒè¯•ä½ çš„åº”ç”¨ã€‚å¦‚æœä½ å¯¹ä¸Šè¿°ç”± KubeVela å¸¦æ¥çš„å¼€å‘è€…ä½“éªŒæ„Ÿå…´è¶£çš„è¯ï¼Œæ¬¢è¿å‰å¾€ KubeVela é¡¹ç›®çš„ç”¨æˆ·ä½¿ç”¨æ–‡æ¡£æ¥äº†è§£æ›´å¤šã€‚</p><p>è€Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦åˆ‡æ¢ä¸€ä¸‹è§†è§’ï¼Œæ„Ÿå—ä¸€ä¸‹å¹³å°å›¢é˜Ÿçœ¼ä¸­çš„ KubeVela åˆæ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="2-å¹³å°å·¥ç¨‹å¸ˆçœ¼ä¸­çš„-kubevela"></a>2. å¹³å°å·¥ç¨‹å¸ˆçœ¼ä¸­çš„ KubeVela<a class="hash-link" href="#2-å¹³å°å·¥ç¨‹å¸ˆçœ¼ä¸­çš„-kubevela" title="Direct link to heading">#</a></h3><p>å®é™…ä¸Šï¼Œå‰é¢ä»‹ç»åˆ°çš„æ‰€æœ‰å¼€å‘è€…ä¾§ä½“éªŒï¼Œéƒ½ç¦»ä¸å¼€ KubeVela åœ¨å¹³å°ä¾§è¿›è¡Œçš„å„ç§åˆ›æ–°æ€§è®¾è®¡ä¸å®ç°ã€‚ä¹Ÿæ­£æ˜¯è¿™äº›è®¾è®¡çš„å­˜åœ¨ï¼Œæ‰ä½¿å¾— KubeVela ä¸æ˜¯ä¸€ä¸ªç®€å•çš„ PaaS æˆ–è€… Serverlessï¼Œ<strong>è€Œæ˜¯ä¸€ä¸ªå¯ä»¥ç”±å¹³å°å·¥ç¨‹å¸ˆæ‰©å±•æˆä»»æ„å‚ç›´ç³»ç»Ÿçš„äº‘åŸç”Ÿå¹³å°å†…æ ¸</strong>ã€‚</p><p>å…·ä½“æ¥è¯´ï¼ŒKubeVela ä¸ºå¹³å°å·¥ç¨‹å¸ˆæä¾›äº†ä¸‰å¤§æ ¸å¿ƒèƒ½åŠ›ï¼Œä½¿å¾—åŸºäº Kubernetes æ„å»ºä¸Šè¿°é¢å‘ç”¨æˆ·çš„äº‘åŸç”Ÿå¹³å°ä»â€œé˜³æ˜¥ç™½é›ªâ€å˜æˆäº†â€œå°èœä¸€ç¢Ÿâ€ï¼š</p><p><strong>ç¬¬ä¸€ï¼šä»¥åº”ç”¨ä¸ºä¸­å¿ƒ</strong>ã€‚åœ¨ Appfile èƒŒåï¼Œå…¶å®å°±æ˜¯â€œåº”ç”¨â€è¿™ä¸ªæ¦‚å¿µï¼Œå®ƒæ˜¯åŸºäº OAM æ¨¡å‹å®ç°çš„ã€‚é€šè¿‡è¿™æ ·çš„æ–¹å¼ï¼ŒKubeVela è®©â€œåº”ç”¨â€è¿™ä¸ªæ¦‚å¿µæˆä¸ºäº†æ•´ä¸ªå¹³å°å¯¹ç”¨æˆ·æš´éœ²çš„æ ¸å¿ƒ APIã€‚KubeVela ä¸­çš„æ‰€æœ‰èƒ½åŠ›ï¼Œéƒ½æ˜¯å›´ç»•ç€â€œåº”ç”¨â€å±•å¼€çš„ã€‚è¿™æ­£æ˜¯ä¸ºä½•åŸºäº KubeVela æ‰©å±•å’Œæ„å»ºå‡ºæ¥çš„å¹³å°ï¼Œå¤©ç„¶æ˜¯ç”¨æˆ·å‹å¥½çš„ï¼šå¯¹äºä¸€ä¸ªå¼€å‘è€…æ¥è¯´ï¼Œä»–åªå…³å¿ƒâ€œåº”ç”¨â€ï¼Œè€Œä¸æ˜¯å®¹å™¨æˆ–è€… Kubernetesï¼›è€Œ KubeVela ä¼šç¡®ä¿æ„å»ºæ•´ä¸ªå¹³å°çš„è¿‡ç¨‹ï¼Œä¹Ÿåªä¸åº”ç”¨å±‚çš„éœ€æ±‚æœ‰å…³ã€‚</p><p><strong>ç¬¬äºŒï¼šKubernetes åŸç”Ÿçš„é«˜å¯æ‰©å±•æ€§</strong>ã€‚åœ¨å‰é¢æˆ‘ä»¬å·²ç»æåˆ°è¿‡ï¼ŒAppfile æ˜¯ä¸€ä¸ªç”± Workload Type å’Œ Trait ç»„æˆçš„ã€å®Œå…¨æ¨¡å—åŒ–çš„å¯¹è±¡ã€‚è€Œ OAM æ¨¡å‹çš„ä¸€ä¸ªç‰¹ç‚¹ï¼Œå°±æ˜¯ä»»æ„ä¸€ä¸ª Kubernetes API èµ„æºï¼Œéƒ½å¯ä»¥ç›´æ¥åŸºäº Kubernetes çš„ CRD å‘ç°æœºåˆ¶æ³¨å†Œä¸ºä¸€ä¸ª Workload Type æˆ–è€… Traitã€‚è¿™ç§å¯æ‰©å±•æ€§ï¼Œä½¿å¾— KubeVela å¹¶ä¸éœ€è¦è®¾è®¡ä»»ä½•â€œæ’ä»¶ç³»ç»Ÿâ€ï¼š<strong>KubeVela é‡Œçš„æ¯ä¸€ä¸ªèƒ½åŠ›ï¼Œéƒ½æ˜¯æ’ä»¶ï¼Œè€Œæ•´ä¸ª Kubernetes ç¤¾åŒºï¼Œå°±æ˜¯ KubeVela åŸç”Ÿçš„æ’ä»¶ä¸­å¿ƒ</strong>ã€‚</p><p><strong>ç¬¬ä¸‰ï¼šç®€å•å‹å¥½ä½†é«˜åº¦å¯æ‰©å±•çš„ç”¨æˆ·ä¾§æŠ½è±¡ä½“ç³»</strong>ã€‚åœ¨äº†è§£äº† Appfile ä¹‹åï¼Œä½ å¯èƒ½å·²ç»å¯¹è¿™ä¸ªå¯¹è±¡çš„å®ç°æ–¹å¼äº§ç”Ÿäº†å¥½å¥‡ã€‚å®é™…ä¸Šï¼ŒKubeVela ä¸­å¹¶ä¸æ˜¯ç®€å•çš„å®ç°äº†ä¸€ä¸ª Appfileã€‚åœ¨å¹³å°å±‚ï¼ŒKubeVela åœ¨ OAM æ¨¡å‹å±‚å®ç°ä¸­é›†æˆäº†CUELang è¿™ç§ç®€æ´å¼ºå¤§çš„æ¨¡æ¿è¯­è¨€ï¼Œä»è€Œä¸ºå¹³å°å·¥ç¨‹å¸ˆåŸºäº Kubernetes API å¯¹è±¡å®šä¹‰ç”¨æˆ·ä¾§æŠ½è±¡ï¼ˆå³ï¼šâ€œæœ€åä¸€å…¬é‡Œâ€æŠ½è±¡ï¼‰æä¾›äº†ä¸€ä¸ªæ ‡å‡†ã€é€šç”¨çš„é…ç½®å·¥å…·ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œå¹³å°å·¥ç¨‹å¸ˆæˆ–è€…ç³»ç»Ÿç®¡ç†å‘˜ï¼Œå¯ä»¥éšæ—¶éšåœ°çš„æ¯ä¸ªèƒ½åŠ›å¯¹åº”çš„ CUE æ¨¡æ¿è¿›è¡Œä¿®æ”¹ï¼Œè¿™äº›ä¿®æ”¹ä¸€æ—¦æäº¤åˆ° Kubernetesï¼Œç”¨æˆ·åœ¨ Appfile é‡Œå°±å¯ä»¥ç«‹åˆ»ä½¿ç”¨åˆ°æ–°çš„æŠ½è±¡ï¼Œä¸éœ€è¦é‡æ–°éƒ¨ç½²æˆ–è€…å®‰è£… KubeVelaã€‚</p><p>åœ¨å…·ä½“å®ç°å±‚ï¼ŒKubeVela æ˜¯åŸºäº OAM Kubernetes Runtime æ„å»ºçš„ï¼ŒåŒæ—¶é‡‡ç”¨ KEDA ï¼ŒFlaggerï¼ŒPrometheus ç­‰ç”Ÿæ€é¡¹ç›®ä½œä¸º Trait çš„èƒŒåçš„ä¾èµ–ã€‚å½“ç„¶ï¼Œè¿™äº›ä¾èµ–åªæ˜¯ KubeVela çš„é€‰å‹ï¼Œä½ å¯ä»¥éšæ—¶ä¸º KubeVela å®šåˆ¶å’Œå®‰è£…ä½ å–œæ¬¢çš„ä»»ä½•èƒ½åŠ›ä½œä¸º Workload Type æˆ–è€… Traitã€‚ç»¼åˆä»¥ä¸Šè®²è§£ï¼ŒKubeVela é¡¹ç›®çš„æ•´ä½“æ¶æ„ç”±<strong>ç”¨æˆ·ç•Œé¢å±‚ï¼Œæ¨¡å‹å±‚ï¼Œå’Œèƒ½åŠ›ç®¡ç†å±‚</strong>ä¸‰éƒ¨åˆ†ç»„æˆï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://tva2.sinaimg.cn/large/ad5fbf65gy1glf9sktkdxj20q00dsacl.jpg"></p><p>æœ‰äº† KubeVelaï¼Œå¹³å°å·¥ç¨‹å¸ˆç»ˆäºæ‹¥æœ‰äº†ä¸€ä¸ªå¯ä»¥æ–¹ä¾¿å¿«æ·åœ°å°†ä»»ä½•ä¸€ä¸ª Kubernetes ç¤¾åŒºèƒ½åŠ›å°è£…æŠ½è±¡æˆä¸€ä¸ªé¢å‘ç”¨æˆ·çš„ä¸Šå±‚å¹³å°ç‰¹æ€§çš„å¼ºå¤§å·¥å…·ã€‚è€Œä½œä¸ºè¿™ä¸ªå¹³å°çš„æœ€ç»ˆç”¨æˆ·ï¼Œç”¨æˆ·ä»¬åªéœ€è¦å­¦ä¹ è¿™äº›ä¸Šå±‚æŠ½è±¡ï¼Œåœ¨ä¸€ä¸ªé…ç½®æ–‡ä»¶ä¸­æè¿°åº”ç”¨ï¼Œå°±å¯ä»¥ä¸€é”®äº¤ä»˜å‡ºå»ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="3-kubevela-vs-ç»å…¸-paas"></a>3. KubeVela VS ç»å…¸ PaaS<a class="hash-link" href="#3-kubevela-vs-ç»å…¸-paas" title="Direct link to heading">#</a></h3><p>å¾ˆå¤šäººå¯èƒ½ä¼šé—®ï¼ŒKubeVela è·Ÿç»å…¸ PaaS çš„ä¸»è¦åŒºåˆ«å’Œè”ç³»æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>äº‹å®ä¸Šï¼Œå¤§å¤šæ•°ç»å…¸ PaaS éƒ½èƒ½æä¾›å®Œæ•´çš„åº”ç”¨ç”Ÿå‘½å‘¨æœŸç®¡ç†åŠŸèƒ½ï¼ŒåŒæ—¶ä¹Ÿéå¸¸å…³æ³¨æä¾›ç®€å•å‹å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œæå‡ç ”å‘æ•ˆèƒ½ã€‚åœ¨è¿™äº›ç‚¹ä¸Šï¼ŒKubeVela è·Ÿç»å…¸ PaaS çš„ç›®æ ‡ï¼Œæ˜¯éå¸¸ä¸€è‡´çš„ã€‚</p><p>ä½†å¦ä¸€æ–¹é¢ï¼Œç»å…¸ PaaS å¾€å¾€æ˜¯ä¸å¯æ‰©å±•çš„ï¼ˆæ¯”å¦‚ Rancher çš„ Rio é¡¹ç›®ï¼‰ï¼Œæˆ–è€…ä¼šå¼•å…¥å±äºè‡ªå·±çš„æ’ä»¶ç”Ÿæ€ï¼ˆå“ªæ€•è¿™ä¸ª PaaS æ˜¯å®Œå…¨åŸºäº Kubernetes æ„å»ºçš„ï¼‰ï¼Œä»¥æ­¤æ¥ç¡®ä¿å¹³å°æœ¬èº«çš„ç”¨æˆ·ä½“éªŒå’Œèƒ½åŠ›çš„å¯æ§åˆ¶æ€§ï¼ˆæ¯”å¦‚ Cloud Foundry æˆ–è€… Heroku çš„<a href="https://elements.heroku.com/addons" target="_blank" rel="noopener noreferrer">æ’ä»¶ä¸­å¿ƒ</a>ï¼‰ã€‚</p><p>ç›¸æ¯”ä¹‹ä¸‹ï¼ŒKubeVela çš„è®¾è®¡æ˜¯å®Œå…¨ä¸åŒçš„ã€‚KubeVela çš„ç›®æ ‡ï¼Œä»ä¸€å¼€å§‹å°±æ˜¯åˆ©ç”¨æ•´ä¸ª Kubernetes ç¤¾åŒºä½œä¸ºè‡ªå·±çš„â€œæ’ä»¶ä¸­å¿ƒâ€ï¼Œå¹¶ä¸”â€œæ•…æ„â€æŠŠå®ƒçš„æ¯ä¸€ä¸ªå†…ç½®èƒ½åŠ›éƒ½è®¾è®¡æˆæ˜¯ç‹¬ç«‹çš„ã€å¯æ’æ‹”çš„æ’ä»¶ã€‚è¿™ç§é«˜åº¦å¯æ‰©å±•çš„æ¨¡å‹ï¼ŒèƒŒåå…¶å®æœ‰ç€ç²¾å¯†çš„è®¾è®¡ä¸å®ç°ã€‚æ¯”å¦‚ï¼ŒKubeVela å¦‚ä½•ç¡®ä¿æŸä¸ªå®Œå…¨ç‹¬ç«‹çš„ Trait ä¸€å®šèƒ½å¤Ÿç»‘å®šäºæŸç§ Workload Typeï¼Ÿå¦‚ä½•æ£€æŸ¥è¿™äº›ç›¸äº’ç‹¬ç«‹çš„ Trait æ˜¯å¦å†²çªï¼Ÿè¿™äº›æŒ‘æˆ˜ï¼Œæ­£æ˜¯ Open Application Modelï¼ˆOAMï¼‰ä½œä¸º KubeVela æ¨¡å‹å±‚çš„èµ·åˆ°çš„å…³é”®ä½œç”¨ï¼Œä¸€è¨€ä»¥è”½ä¹‹ï¼šOAM æ˜¯ä¸€ä¸ªé«˜åº¦å¯æ‰©å±•çš„åº”ç”¨å®šä¹‰ä¸èƒ½åŠ›ç®¡ç†æ¨¡å‹ã€‚</p><p>KubeVela å’Œ OAM ç¤¾åŒºæ¬¢è¿å¤§å®¶è®¾è®¡å’Œåˆ¶ä½œä»»ä½• Workload Type å’Œ Trait çš„å®šä¹‰æ–‡ä»¶ã€‚åªè¦æŠŠå®ƒä»¬å­˜æ”¾åœ¨ GitHub ä¸Šï¼Œå…¨ä¸–ç•Œä»»ä½•ä¸€ä¸ª KubeVela ç”¨æˆ·å°±éƒ½å¯ä»¥åœ¨è‡ªå·±çš„ Appfile é‡Œä½¿ç”¨ä½ æ‰€è®¾è®¡çš„èƒ½åŠ›ã€‚å…·ä½“çš„æ–¹å¼ï¼Œè¯·å‚è€ƒ <code>$ vela cap</code> ï¼ˆå³ï¼šæ’ä»¶èƒ½åŠ›ç®¡ç†å‘½ä»¤ï¼‰çš„<a href="https://kubevela.io/#/en/developers/cap-center" target="_blank" rel="noopener noreferrer">ä½¿ç”¨æ–‡æ¡£</a>ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="äº†è§£æ›´å¤š"></a>äº†è§£æ›´å¤š<a class="hash-link" href="#äº†è§£æ›´å¤š" title="Direct link to heading">#</a></h2><p>KubeVela é¡¹ç›®æ˜¯ OAM ç¤¾åŒºçš„å®˜æ–¹é¡¹ç›®ï¼Œæ—¨åœ¨å–ä»£åŸå…ˆçš„ Rudr é¡¹ç›®ã€‚ä¸è¿‡ï¼Œä¸ <a href="https://github.com/oam-dev/rudr" target="_blank" rel="noopener noreferrer">Rudr</a> ä¸»è¦ä½œä¸ºâ€œå‚è€ƒå®ç°â€çš„å®šä½ä¸åŒï¼ŒKubeVela æ—¢æ˜¯ä¸€ä¸ªç«¯åˆ°ç«¯ã€é¢å‘å…¨é‡åœºæ™¯çš„ OAM Kubernetes å®Œæ•´å®ç°ï¼ŒåŒæ—¶ä¹Ÿæ˜¯é˜¿é‡Œäº‘ EDAS æœåŠ¡å’Œå†…éƒ¨å¤šä¸ªæ ¸å¿ƒ PaaS/Serverless ç”Ÿäº§ç³»ç»Ÿåº•å±‚çš„æ ¸å¿ƒç»„ä»¶ã€‚ æ­¤å¤–ï¼ŒKubeVela ä¸­ Apppfile çš„è®¾è®¡ï¼Œä¹Ÿæ˜¯ OAM ç¤¾åŒºåœ¨ OAM è§„èŒƒä¸­å³å°†å¼•å…¥çš„â€œé¢å‘ç”¨æˆ·ä¾§å¯¹è±¡â€çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚</p><p>å¦‚æœä½ æƒ³è¦æ›´å¥½çš„äº†è§£ KubeVela é¡¹ç›®ï¼Œæ¬¢è¿å‰å¾€å…¶å®˜æ–¹ç½‘ç«™ä¸Š<a href="https://kubevela.io/" target="_blank" rel="noopener noreferrer">å­¦ä¹ å…·ä½“çš„ç¤ºä¾‹å’Œæ‰‹å†Œ</a>ã€‚ä»¥ä¸‹ä¹Ÿæ˜¯ä¸€äº›éå¸¸å¥½çš„å­¦ä¹ å†…å®¹å’Œæ–¹å¼ï¼š</p><ul><li>å‰å¾€å­¦ä¹  <a href="https://kubevela.io/#/en/quick-start" target="_blank" rel="noopener noreferrer">KubeVela Quick Startï¼ˆæ–°æ‰‹æ•™ç¨‹ï¼‰</a>ï¼Œä¸€æ­¥æ­¥äº†è§£ KubeVela çš„ä½¿ç”¨æ–¹æ³•ã€‚</li><li>å‰å¾€ OAM ç¤¾åŒºæ·±å…¥äº¤æµå’Œåé¦ˆã€‚ä¸­æ–‡ï¼šé’‰é’‰ç¾¤ 23310022ï¼Œè‹±æ–‡ï¼š<a href="https://gitter.im/oam-dev/community" target="_blank" rel="noopener noreferrer">Gitter</a> å’Œ <a href="https://cloud-native.slack.com/archives/C01BLQ3HTJA" target="_blank" rel="noopener noreferrer">CNCF Slack</a>ã€‚</li><li>å°è¯•ä¸º <a href="https://kubevela.io/#/en/platform-engineers/trait" target="_blank" rel="noopener noreferrer">KubeVela æ·»åŠ æ¥è‡ªå¼€æºç¤¾åŒºçš„æ’ä»¶èƒ½åŠ›</a>ã€‚æ­¤å¤–ï¼Œå¦‚æœä½ æœ‰ä»»ä½•å…³äºæ‰©å±• KubeVela çš„å¥‡å¦™æƒ³æ³•ï¼Œæ¯”å¦‚ï¼ŒåŸºäº KubeVela å¼€å‘ä¸€ä¸ªè‡ªå·±çš„äº‘åŸç”Ÿæ•°æ®åº“ PaaS æˆ–è€… AI PaaSï¼Œæ¬¢è¿å‰å¾€ OAM ç¤¾åŒºé€šè¿‡ Issue æ¥è¿›è¡Œè®¨è®ºã€‚</li><li>ä¸º KubeVela è´¡çŒ®ä»£ç . KubeVela é¡¹ç›®æ˜¯ä¸€ä¸ªè¯ç”Ÿè‡ªäº‘åŸç”Ÿç¤¾åŒºçš„å¼€æºé¡¹ç›®ï¼ˆæ„Ÿè°¢æ¥è‡ª 8 å®¶ä¸åŒå…¬å¸çš„<a href="https://github.com/oam-dev/kubevela/blob/bbb2c527d96d3e1a0694e2f49b3d1d1168e72c53/OWNERS_ALIASES#L35" target="_blank" rel="noopener noreferrer">åˆå§‹è´¡çŒ®è€…</a>ï¼Œå¹¶ç‰¹åˆ«é¸£è°¢ KubeVela ç½‘ç«™çš„å‘èµ·è€… <a href="https://github.com/sunny0826" target="_blank" rel="noopener noreferrer">guoxudong</a>ï¼‰ã€‚ </li></ul><p><strong>KubeVela é¡¹ç›®çš„ç»´æŠ¤è€…ä¼šåœ¨é¡¹ç›®ç¨³å®šåï¼Œå³å°†æ•´ä¸ªé¡¹ç›®æ‰€æœ‰æƒæèµ ç»™ä¸­ç«‹å¼€æºåŸºé‡‘ä¼šã€‚</strong></p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/zh/blog/tags/kube-vela">KubeVela</a></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></main></div></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">æ–‡æ¡£</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/zh/docs/end-user/quick-start-cli">å¿«é€Ÿå¼€å§‹</a></li><li class="footer__item"><a class="footer__link-item" href="/zh/docs/tutorials/webservice">å®è·µæ•™ç¨‹</a></li><li class="footer__item"><a class="footer__link-item" href="/zh/docs/platform-engineers/oam/oam-model">è‡ªå®šä¹‰æ‰©å±•</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">ç¤¾åŒº</h4><ul class="footer__items"><li class="footer__item"><a href="https://slack.cncf.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">CNCF Slack ( #kubevela channel )</a></li><li class="footer__item"><a href="https://gitter.im/oam-dev/community" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gitter</a></li><li class="footer__item"><a class="footer__link-item" href="/zh/">é’‰é’‰ (23310022)</a></li><li class="footer__item"><div class="wechat"> <a class="wechat-label">Wechat Group(Scan code to request joining)</a> <a class="wechat-img" rel="noreferrer noopener" aria-label="Wechat Group"><img src="https://static.kubevela.net/images/barnett-wechat.jpg" alt="Broker wechat to add you into the user group."></a></div></li></ul></div><div class="col footer__col"><h4 class="footer__title">æ›´å¤š</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a class="footer__link-item" href="/zh/blog">åšå®¢</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">
        <br>
        <strong>Â© KubeVela Authors 2021 | Documentation Distributed under <a herf="https://creativecommons.org/licenses/by/4.0">CC-BY-4.0</a> </strong> <strong>| Powered by <a href="https://www.netlify.com">Netlify</a></strong>
        <br>
      </div></div></div></footer></div>
<script src="/zh/assets/js/runtime~main.312f92b6.js"></script>
<script src="/zh/assets/js/main.aa5d7873.js"></script>
</body>
</html>